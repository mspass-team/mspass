<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>mspasspy.util &mdash; MsPASS 0.0.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="C++ API" href="../cxx_api/index.html" />
    <link rel="prev" title="mspasspy.reduce" href="mspasspy.reduce.html" />  

  <style>
    .wy-nav-content { max-width: 1600px; }
  </style>

  
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> MsPASS
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/run_mspass_with_docker.html">Run MsPASS with Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/deploy_mspass_with_docker_compose.html">Deploy MsPASS with Docker Compose</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/deploy_mspass_on_HPC.html">Deploy MsPASS on HPC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/getting_started_overview.html">MsPASS Setup In-Depth Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_manual/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_manual/data_object_design_concepts.html">Data Object Design Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_manual/time_standard_constraints.html">Time Standard Constraints</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_manual/obspy_interface.html">Using ObsPy with MsPASS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_manual/database_concepts.html">Database Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_manual/CRUD_operations.html">CRUD Operations in MsPASS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_manual/importing_data.html">Importing Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_manual/handling_errors.html">Handling Errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_manual/data_editing.html">Data Editing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_manual/header_math.html">Header (Metadata) Math</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_manual/graphics.html">Graphics in MsPASS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_manual/processing_history_concepts.html">Processing History Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_manual/parallel_processing.html">Parallel Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_manual/normalization.html">Normalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_manual/adapting_algorithms.html">Adapting an Existing Algorithm to MsPASS</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference Manual</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Python API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="mspasspy.algorithms.html">mspasspy.algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="mspasspy.ccore.html">mspasspy.ccore</a></li>
<li class="toctree-l2"><a class="reference internal" href="mspasspy.client.html">mspasspy.client</a></li>
<li class="toctree-l2"><a class="reference internal" href="mspasspy.db.html">mspasspy.db</a></li>
<li class="toctree-l2"><a class="reference internal" href="mspasspy.global_history.html">mspasspy.global_history</a></li>
<li class="toctree-l2"><a class="reference internal" href="mspasspy.graphics.html">mspasspy.graphics</a></li>
<li class="toctree-l2"><a class="reference internal" href="mspasspy.history.html">mspasspy.history</a></li>
<li class="toctree-l2"><a class="reference internal" href="mspasspy.reduce.html">mspasspy.reduce</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">mspasspy.util</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-mspasspy.util.converter">converter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.converter.AntelopePf2dict"><code class="docutils literal notranslate"><span class="pre">AntelopePf2dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.converter.Metadata2dict"><code class="docutils literal notranslate"><span class="pre">Metadata2dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.converter.Pf2AttributeNameTbl"><code class="docutils literal notranslate"><span class="pre">Pf2AttributeNameTbl()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.converter.Seismogram2Stream"><code class="docutils literal notranslate"><span class="pre">Seismogram2Stream()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.converter.SeismogramEnsemble2Stream"><code class="docutils literal notranslate"><span class="pre">SeismogramEnsemble2Stream()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.converter.Stream2Seismogram"><code class="docutils literal notranslate"><span class="pre">Stream2Seismogram()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.converter.Stream2SeismogramEnsemble"><code class="docutils literal notranslate"><span class="pre">Stream2SeismogramEnsemble()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.converter.Stream2TimeSeriesEnsemble"><code class="docutils literal notranslate"><span class="pre">Stream2TimeSeriesEnsemble()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.converter.Textfile2Dataframe"><code class="docutils literal notranslate"><span class="pre">Textfile2Dataframe()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.converter.TimeSeries2Trace"><code class="docutils literal notranslate"><span class="pre">TimeSeries2Trace()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.converter.TimeSeriesEnsemble2Stream"><code class="docutils literal notranslate"><span class="pre">TimeSeriesEnsemble2Stream()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.converter.Trace2TimeSeries"><code class="docutils literal notranslate"><span class="pre">Trace2TimeSeries()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.converter.dict2Metadata"><code class="docutils literal notranslate"><span class="pre">dict2Metadata()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.converter.list2Ensemble"><code class="docutils literal notranslate"><span class="pre">list2Ensemble()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.converter.post_ensemble_metadata"><code class="docutils literal notranslate"><span class="pre">post_ensemble_metadata()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mspasspy.util.decorators">decorators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.decorators.is_input_dead"><code class="docutils literal notranslate"><span class="pre">is_input_dead()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.decorators.mspass_func_wrapper"><code class="docutils literal notranslate"><span class="pre">mspass_func_wrapper()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.decorators.mspass_func_wrapper_multi"><code class="docutils literal notranslate"><span class="pre">mspass_func_wrapper_multi()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.decorators.mspass_method_wrapper"><code class="docutils literal notranslate"><span class="pre">mspass_method_wrapper()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.decorators.mspass_reduce_func_wrapper"><code class="docutils literal notranslate"><span class="pre">mspass_reduce_func_wrapper()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.decorators.seismogram_as_stream"><code class="docutils literal notranslate"><span class="pre">seismogram_as_stream()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.decorators.seismogram_copy_helper"><code class="docutils literal notranslate"><span class="pre">seismogram_copy_helper()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.decorators.seismogram_ensemble_as_stream"><code class="docutils literal notranslate"><span class="pre">seismogram_ensemble_as_stream()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.decorators.seismogram_ensemble_copy_helper"><code class="docutils literal notranslate"><span class="pre">seismogram_ensemble_copy_helper()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.decorators.timeseries_as_trace"><code class="docutils literal notranslate"><span class="pre">timeseries_as_trace()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.decorators.timeseries_copy_helper"><code class="docutils literal notranslate"><span class="pre">timeseries_copy_helper()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.decorators.timeseries_ensemble_as_stream"><code class="docutils literal notranslate"><span class="pre">timeseries_ensemble_as_stream()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.decorators.timeseries_ensemble_copy_helper"><code class="docutils literal notranslate"><span class="pre">timeseries_ensemble_copy_helper()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mspasspy.util.logging_helper">logging_helper</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.logging_helper.ensemble_error"><code class="docutils literal notranslate"><span class="pre">ensemble_error()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.logging_helper.info"><code class="docutils literal notranslate"><span class="pre">info()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.logging_helper.reduce"><code class="docutils literal notranslate"><span class="pre">reduce()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mspasspy.util.seispp">seispp</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.seispp.index_data"><code class="docutils literal notranslate"><span class="pre">index_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mspasspy.util.Undertaker">Undertaker</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mspasspy.util.Undertaker.Undertaker"><code class="docutils literal notranslate"><span class="pre">Undertaker</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cxx_api/index.html">C++ API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mspass_schema/mspass_schema.html">MsPASS Schema</a></li>
</ul>

    <a href= "../genindex.html">Index</a>
  
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MsPASS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Python API</a></li>
      <li class="breadcrumb-item active">mspasspy.util</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/mspass-team/mspass/blob/master/docs/source/python_api/mspasspy.util.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="mspasspy-util">
<h1>mspasspy.util<a class="headerlink" href="#mspasspy-util" title="Permalink to this heading"></a></h1>
<section id="module-mspasspy.util.converter">
<span id="converter"></span><h2>converter<a class="headerlink" href="#module-mspasspy.util.converter" title="Permalink to this heading"></a></h2>
<p>Functions for converting to and from MsPASS data types.</p>
<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.converter.AntelopePf2dict">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.converter.</span></span><span class="sig-name descname"><span class="pre">AntelopePf2dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/converter.html#AntelopePf2dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.converter.AntelopePf2dict" title="Permalink to this definition"></a></dt>
<dd><p>Converts a AntelopePf object to a Python dict.
This converts a AntelopePf object to a Python dict by recursively
decoding the tbls.
:param pf: AntelopePf object to convert.
:type md: <code class="xref py py-class docutils literal notranslate"><span class="pre">AntelopePf</span></code>
:return: Python dict equivalent to md.
:rtype: dict</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.converter.Metadata2dict">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.converter.</span></span><span class="sig-name descname"><span class="pre">Metadata2dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">md</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/converter.html#Metadata2dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.converter.Metadata2dict" title="Permalink to this definition"></a></dt>
<dd><p>Converts a Metadata object to a Python dict.</p>
<p>This is the inverse of dict2Metadata.  It converts a Metadata object to
a Python dict. Note that Metadata behavies like dict, so this conversion
is usually not necessay.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>md</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Metadata</span></code>) – Metadata object to convert.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Python dict equivalent to md.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.converter.Pf2AttributeNameTbl">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.converter.</span></span><span class="sig-name descname"><span class="pre">Pf2AttributeNameTbl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'attributes'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/converter.html#Pf2AttributeNameTbl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.converter.Pf2AttributeNameTbl" title="Permalink to this definition"></a></dt>
<dd><p>This function will parse a pf file to extract a tbl with a specific
key and return a data structure that defines the names and types of
each column in the input file.</p>
<dl class="simple">
<dt>The structure returned is a tuple with three components:</dt><dd><dl class="simple">
<dt>1 (index 0) python array of attribute names in the original tbl order</dt><dd><p>This is used to parse the text file so the order matters a lot.</p>
</dd>
<dt>2 (index 1) parallel array of type names for each attribute.</dt><dd><p>These are actual python type objects that can be used as the
second arg of isinstance.</p>
</dd>
<dt>3 (index 2) python dictionary keyed by name field that defines</dt><dd><p>what a null value is for this attribute.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pf</strong> – AntelopePf object to be parsed</p></li>
<li><p><strong>tag</strong> – &amp;Tbl tag for section of pf to be parsed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.converter.Seismogram2Stream">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.converter.</span></span><span class="sig-name descname"><span class="pre">Seismogram2Stream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chanmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['E',</span> <span class="pre">'N',</span> <span class="pre">'Z']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hang</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[90.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vang</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[90.0,</span> <span class="pre">90.0,</span> <span class="pre">0.0]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/converter.html#Seismogram2Stream"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.converter.Seismogram2Stream" title="Permalink to this definition"></a></dt>
<dd><p>Convert a mspass::Seismogram object to an obspy::Stream with 3 components split apart.</p>
<p>mspass and obspy have completely incompatible approaches to handling three
component data.  obspy uses a Stream object that is a wrapper around and
a list of Trace objects.  mspass stores 3C data bundled into a matrix
container.   This function takes the matrix container apart and produces
the three Trace objects obspy want to define 3C data.   The caller is
responsible for how they handle bundling the output.</p>
<p>A very dark side of this function is any error log entries in the part
mspass Seismogram object will be lost in this conversion as obspy
does not implement that concept.  If you need to save the error log
you will need to save the input of this function to MongoDB to preserve
the errorlog it may contain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sg</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Seismogram</span></code>) – is the Seismogram object to be converted</p></li>
<li><p><strong>chanmap</strong> (<em>list</em>) – 3 element list of channel names to be assigned components</p></li>
<li><p><strong>hang</strong> (<em>list</em>) – 3 element list of horizontal angle attributes (azimuth in degrees)
to be set in Stats array of output for each component.  (default is
for cardinal directions)</p></li>
<li><p><strong>vang</strong> (<em>list</em>) – 3 element list of vertical angle (theta of spherical coordinates)
to be set in Stats array of output for each component.  (default is
for cardinal directions)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>obspy Stream object containing a list of 3 Trace objects in
mspass component order. Presently the data are ALWAYS returned to
cardinal directions (see above). It will be empty if sg was marked dead</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.obspy.org/packages/autogen/obspy.core.stream.Stream.html#obspy.core.stream.Stream" title="(in ObsPy v1.3.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">obspy.core.stream.Stream</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.converter.SeismogramEnsemble2Stream">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.converter.</span></span><span class="sig-name descname"><span class="pre">SeismogramEnsemble2Stream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sge</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/converter.html#SeismogramEnsemble2Stream"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.converter.SeismogramEnsemble2Stream" title="Permalink to this definition"></a></dt>
<dd><p>Convert a seismogram ensemble to stream
:param sge: seismogram ensemble input
:return: stream</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.converter.Stream2Seismogram">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.converter.</span></span><span class="sig-name descname"><span class="pre">Stream2Seismogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">st</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">master</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cardinal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">azimuth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'azimuth'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dip'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/converter.html#Stream2Seismogram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.converter.Stream2Seismogram" title="Permalink to this definition"></a></dt>
<dd><p>Convert obspy Stream to a Seismogram.</p>
<p>Convert an obspy Stream object with 3 components to a mspass::Seismogram
(three-component data) object.  This implementation actually converts
each component first to a TimeSeries and then calls a C++ function to
assemble the complete Seismogram.   This has some inefficiencies, but
the assumption is this function is called early on in a processing chain
to build a raw data set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>st</strong> – input obspy Stream object.  The object MUST have exactly 3 components
or the function will throw a AssertionError exception.  The program is
less dogmatic about start times and number of samples as these are
handled by the C++ function this python script calls.  Be warned,
however, that the C++ function can throw a MsPASSrror exception that
should be handled separately.</p></li>
<li><p><strong>master</strong> – a Seismogram is an assembly of three channels composed created from
three TimeSeries/Trace objects.   Each component may have different
metadata (e.g. orientation data) and common metadata (e.g. station
coordinates).   To assemble a Seismogram a decision has to be made on
which component has the definitive common metadata.   We use a simple
algorithm and clone the data from one component defined by this index.
Must be 0,1, or 2 or the function wil throw a RuntimeError.  Default is 0.</p></li>
<li><p><strong>cardinal</strong> – boolean used to define one of two algorithms used to assemble the
bundle.  When true the three input components are assumed to be in
cardinal directions (x1=positive east, x2=positive north, and x3=positive up)
AND in a fixed order of E,N,Z. Otherwise the Metadata fetched with
the azimuth and dip keys are used for orientation.</p></li>
<li><p><strong>azimuth</strong> – defines the Metadata key used to fetch the azimuth angle
used to define the orientation of each component Trace object.
Default is ‘azimuth’ used by obspy.   Note azimuth=hang in css3.0.
Cannot be aliased - must be present in obspy Stats unless cardinal is true</p></li>
<li><p><strong>dip</strong> – defines the Metadata key used to fetch the vertical angle orientation
of each data component.  Vertical angle (vang in css3.0) is exactly
the same as theta in spherical coordinates.  Default is obspy ‘dip’
key. Cannot be aliased - must be defined in obspy Stats unless
cardinal is true</p></li>
</ul>
</dd>
<dt class="field-even">Raise</dt>
<dd class="field-even"><p>Can throw either an AssertionError or MsPASSrror(currently defaulted to</p>
</dd>
</dl>
<p>pybind11’s default RuntimeError.  Error message can be obtained by
calling the what method of RuntimeError).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.converter.Stream2SeismogramEnsemble">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.converter.</span></span><span class="sig-name descname"><span class="pre">Stream2SeismogramEnsemble</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stream</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/converter.html#Stream2SeismogramEnsemble"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.converter.Stream2SeismogramEnsemble" title="Permalink to this definition"></a></dt>
<dd><p>Convert a stream to seismogram ensemble.
:param stream: stream input
:return: converted seismogram ensemble</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.converter.Stream2TimeSeriesEnsemble">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.converter.</span></span><span class="sig-name descname"><span class="pre">Stream2TimeSeriesEnsemble</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stream</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/converter.html#Stream2TimeSeriesEnsemble"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.converter.Stream2TimeSeriesEnsemble" title="Permalink to this definition"></a></dt>
<dd><p>Convert a stream to timeseries ensemble.
:param stream: stream input
:return: converted timeseries ensemble</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.converter.Textfile2Dataframe">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.converter.</span></span><span class="sig-name descname"><span class="pre">Textfile2Dataframe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\\s+'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header_line</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attribute_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rename_attributes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attributes_to_use</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one_to_one</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">insert_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/converter.html#Textfile2Dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.converter.Textfile2Dataframe" title="Permalink to this definition"></a></dt>
<dd><p>Import a text file representation of a table and store its
representation as a pandas dataframe.
Note that even in the parallel environment, a dask dataframe will be
transfered back to a pandas dataframe for the consistency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – path to text file that is to be read to create the
table object that is to be processed (internally we use pandas or
dask dataframes)</p></li>
<li><p><strong>separator</strong> – <p>The delimiter used for seperating fields,
the default is “s+”, which is the regular expression of “one or more
spaces”.</p>
<blockquote>
<div><p>For csv file, its value should be set to ‘,’.
This parameter will be passed into pandas.read_csv or dask.dataframe.read_csv.
To learn more details about the usage, check the following links:
<a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.read_csv.html">https://pandas.pydata.org/docs/reference/api/pandas.read_csv.html</a>
<a class="reference external" href="https://docs.dask.org/en/latest/generated/dask.dataframe.read_csv.html">https://docs.dask.org/en/latest/generated/dask.dataframe.read_csv.html</a></p>
</div></blockquote>
</p></li>
<li><p><strong>type_dict</strong> – pairs of each attribute and its type, usedd to validate
the type of each input item</p></li>
<li><p><strong>header_line</strong> – defines the line to be used as the attribute names for
columns, if is &lt; 0, an attribute_names is required. Please note that if an
attribute_names is provided, the attributes defined in header_line will
always be override.</p></li>
<li><p><strong>attribute_names</strong> – This argument must be either a list of (unique)
string names to define the attribute name tags for each column of the
input table.   The length of the array must match the number of
columns in the input table or this function will throw a MsPASSError
exception.   This argument is None by default which means the
function will assume the line specified by the “header_line” argument as
column headers defining the attribute name.  If header_line is less
than 0 this argument will be required.  When header_line is &gt;= 0
and this argument (attribute_names) is defined all the names in
this list will override those stored in the file at the specified
line number.</p></li>
<li><p><strong>rename_attributes</strong> – This is expected to be a python dict
keyed by names matching those defined in the file or attribute_names
array (i.e. the panda/dataframe column index names) and values defining
strings to use to override the original names.   That usage, of course,
is most common to override names in a file.  If you want to change all
the name use a custom attributes_name array as noted above.  This
argument is mostly to rename a small number of anomalous names.</p></li>
<li><p><strong>attributes_to_use</strong> – If used this argument must define a list of
attribute names that define the subset of the dataframe dataframe
attributes that are to be saved.  For relational db users this is
effectively a “select” list of attribute names.  The default is
None which is taken to mean no selection is to be done.</p></li>
<li><p><strong>one_to_one</strong> – is an important boolean use to control if the
output is or is not filtered by rows.  The default is True
which means every tuple in the input file will create a single row in
dataframe. (Useful, for example, to construct an wf_miniseed
collection css3.0 attributes.)  If False the (normally reduced) set
of attributes defined by attributes_to_use will be filtered with the
panda/dask dataframe drop_duplicates method.  That approach
is important, for example, to filter things like Antelope “site” or
“sitechan” attributes created by a join to something like wfdisc and
saved as a text file to be processed by this function.</p></li>
<li><p><strong>parallel</strong> – When true we use the dask dataframe operation.
The default is false meaning the simpler, identical api panda
operators are used.</p></li>
<li><p><strong>insert_column</strong> – a dictionary of new columns to add, and their value(s).</p></li>
</ul>
</dd>
</dl>
<p>If the content is a single value, it can be passedto define a constant value
for the entire column of data. The content can also be a list, in that case,
the list should contain values that are to be set, and it must be the same
length as the number of tuples in the table.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.converter.TimeSeries2Trace">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.converter.</span></span><span class="sig-name descname"><span class="pre">TimeSeries2Trace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/converter.html#TimeSeries2Trace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.converter.TimeSeries2Trace" title="Permalink to this definition"></a></dt>
<dd><p>Converts a TimeSeries object to an obspy Trace object.</p>
<p>MsPASS can handle scalar data either as an obspy Trace object or
as with the mspass TimeSeries object.  The capture nearly the same
concepts.  The main difference is that TimeSeries support the
error logging and history features of mspass while obspy, which is
a separate package, does not.  Obspy has a number of useful
algorithms that operate on scalar data, however, so it is frequently
useful to switch between Trace and TimeSeries formats.  The user is
warned, however, that converting a TimeSeries to a Trace object
with this function will result in the loss of any error log information.
For production runs unless the data set is huge, we recommend saving
the intermediate result AFTER calling this function if there is any
possibility there are errors posted on any data.  We say after because
some warning errors from this function may be posted in elog.  Since
python uses call by reference d may thus be altered.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code>) – is the TimeSeries object to be converted</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an obspy Trace object from conversion of d.  An empty Trace
object will be returned if d was marked dead</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>:class:<a href="#id1"><span class="problematic" id="id2">`</span></a>~obspy.core.trace.Trace`b</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.converter.TimeSeriesEnsemble2Stream">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.converter.</span></span><span class="sig-name descname"><span class="pre">TimeSeriesEnsemble2Stream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tse</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/converter.html#TimeSeriesEnsemble2Stream"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.converter.TimeSeriesEnsemble2Stream" title="Permalink to this definition"></a></dt>
<dd><p>Convert a timeseries ensemble to stream.  Always copies
all ensemble Metadata to tse members before conversion.   That is
necessary to avoid loss of data in the case where the only copy is
stored in the ensemble’s metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tse</strong> – timeseries ensemble</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>converted stream</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.converter.Trace2TimeSeries">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.converter.</span></span><span class="sig-name descname"><span class="pre">Trace2TimeSeries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">history</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/converter.html#Trace2TimeSeries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.converter.Trace2TimeSeries" title="Permalink to this definition"></a></dt>
<dd><p>Convert an obspy Trace object to a TimeSeries object.</p>
<p>An obspy Trace object mostly maps directly into the mspass TimeSeries
object with the stats of Trace mapping (almost) directly to the TimeSeries
Metadata object that is a base class to TimeSeries.  A deep copy of the
data vector in the original Trace is made to the result. That copy is
done in C++ for speed (we found a 100+ fold speedup using that mechanism
instead of a simple python loop)  There is one important type collision
in copying obspy starttime and endtime stats fields.  obspy uses their
UTCDateTime object to hold time but TimeSeries only supports an epoch
time (UTCDateTime.timestamp) so the code here has to convert from the
UTCDateTime to epoch time in the TimeSeries.  Note in a TimeSeries
starttime is the t0 attribute.</p>
<p>The biggest mismatch in Trace and TimeSeries is that Trace has no concept
of object level history as used in mspass.   That history must be maintained
outside obspy.  To maintain full history the user must pass the
history maintained externally through the optional history parameter.
The contents of history will be loaded directly into the result with
no sanity checks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trace</strong> (<a class="reference external" href="https://docs.obspy.org/packages/autogen/obspy.core.trace.Trace.html#obspy.core.trace.Trace" title="(in ObsPy v1.3.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trace</span></code></a>) – obspy trace object to convert</p></li>
<li><p><strong>history</strong> – mspass ProcessingHistory object to post to result.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>TimeSeries object derived from obpsy input Trace object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.converter.dict2Metadata">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.converter.</span></span><span class="sig-name descname"><span class="pre">dict2Metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dic</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/converter.html#dict2Metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.converter.dict2Metadata" title="Permalink to this definition"></a></dt>
<dd><p>Function to convert Python dict data to Metadata.</p>
<p>pymongo returns a Python dict container from find queries to any collection.
Simple type in returned documents can be converted to Metadata
that are used as headers in the C++ components of mspass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dict</strong> (<em>dict</em>) – Python dict to convert</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Metadata object translated from d</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Metadata</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.converter.list2Ensemble">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.converter.</span></span><span class="sig-name descname"><span class="pre">list2Ensemble</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/converter.html#list2Ensemble"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.converter.list2Ensemble" title="Permalink to this definition"></a></dt>
<dd><p>Convert a list of TimeSeries or Seismograms to a corresponding type of Ensemble.
This function will make copies of all the data, to create a new Ensemble.
Note that the Ensemble’s Metadata will always be copied from the first member.
If the keys argument is specifid, it will only copy the keys specified.
If a key does not exist in the first member, it will be skipped and leave a complaint in the error log of the ensemble.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l</strong> – a list of TimeSeries or Seismograms</p></li>
<li><p><strong>keys</strong> – a list of keys to be copied from the first object to the Ensemble’s Metadata</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>converted TimeSeriesEnsemble or SeismogramEnsemble</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.converter.post_ensemble_metadata">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.converter.</span></span><span class="sig-name descname"><span class="pre">post_ensemble_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_all_members</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean_members</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/converter.html#post_ensemble_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.converter.post_ensemble_metadata" title="Permalink to this definition"></a></dt>
<dd><p>It may be necessary to call this function after conversion from
an obspy Stream to one of the mspass Ensemble classes.  This function
is necessary because a mspass Ensemble has a concept not part of the
obspy Stream object.  That is, mspass ensembles have a global
Metadata container.  That container is expected to contain Metadata
common to all members of the ensemble.  For example, for data from
a single earthquake it would be sensible to post the source location
information in the ensemble metadata container rather than
having duplicates in each member.</p>
<p>Two different approaches can be used to do this copy.  The faster,
but least reliable method is to simply copy the values from the first
member of the ensemble.  That approach is enabled by default.
It is completely reliable when used after a conversion from an obspy
Stream but ONLY if the data began life as a mspass ensemble with
exactly the same keys set as global.   The type example of that
is after an obspy algorithm is applied to a mspass ensemble
via the mspass decorators.</p>
<p>A more cautious algorithm can be enabled by setting check_all_members
True. In that mode the list of keys received is tested with a
not equal test for against each member.  Note we do not do anything
fancy with floating point data to allow for finite precision.
The reason is Metadata float values are normally expected to be
constant data.  In that case an != test will yield false when the
comparison is between two copies.  The not equal test may fail, however,
if used with computed floating point numbers.   An example where
that is possible would be spatial gathers like PP data assembled by
midpoint coordinates.  If you need to build gathers in such a context
we recommend you use an integer image point tied to a specialized
document collection in MongoDB that defines the geometry of that
point.  There may be other examples, but the point is don’t trust
computed floating point values to work.  It will also not work if
the values of a key-value pair don’t support an != comparison.
That could be common if the value request for copy was a python object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ens</strong> – ensemble data to be processed.  The function will throw
a MsPASSError exception of ens is not either a TimeSeriesEnsemble or a
SeismogramEnsemble.</p></li>
<li><p><strong>keys</strong> – is expected to be a list of metadata keys (required to be
strings) that are to be copied from member metadata to ensemble
metadata.</p></li>
<li><p><strong>check_all_members</strong> – switch controlling method used to extract
metadata that is to be copied (see above for details). Default is False</p></li>
<li><p><strong>clean_members</strong> – when true data copied to ensemble metadata
will be removed from all members.  This option is only allowed
if check_all_members is set True.  It will be silently ignored if
check_all_members is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-mspasspy.util.decorators">
<span id="decorators"></span><h2>decorators<a class="headerlink" href="#module-mspasspy.util.decorators" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.decorators.is_input_dead">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.decorators.</span></span><span class="sig-name descname"><span class="pre">is_input_dead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/decorators.html#is_input_dead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.decorators.is_input_dead" title="Permalink to this definition"></a></dt>
<dd><p>A helper method to see if any mspass objects in the input parameters are dead. If one is dead,
we should keep silent, i.e. no longer perform any further operations on this dead mspass object.
Note for an ensemble object, only if all the objects of it are dead, we mark them as dead,
otherwise they are still alive.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – any parameters.</p></li>
<li><p><strong>kwargs</strong> – any key-word parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if there is a dead mspass object in the parameters, False if no mspass objects in the input parameters
or all of them are still alive.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.decorators.mspass_func_wrapper">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.decorators.</span></span><span class="sig-name descname"><span class="pre">mspass_func_wrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">object_history</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alg_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alg_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dryrun</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace_return</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_return_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/decorators.html#mspass_func_wrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.decorators.mspass_func_wrapper" title="Permalink to this definition"></a></dt>
<dd><p>Decorator wrapper to adapt a simple function to the mspass parallel processing framework.</p>
<p>This function serves as a decorator wrapper, which is widely used in mspasspy library. It executes the target
function on input data. Data are restricted to be mspasspy objects. It also preserves the processing history and
error logs into the mspasspy objects. By wrapping your function using this decorator, you can save some workload.
Runtime error won’t be raised in order to be efficient in map-reduce operations. MspassError with a severity Fatal
will be raised, others won’t be raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> – target function</p></li>
<li><p><strong>data</strong> – input data, only mspasspy data objects are accepted, i.e. TimeSeries, Seismogram, Ensemble.</p></li>
<li><p><strong>args</strong> – extra arguments</p></li>
<li><p><strong>object_history</strong> – True to preserve this processing history in the data object, False not to. object_history
and alg_id are intimately related and control how object level history is handled.
Object level history is disabled by default for efficiency.  If object_history is set True and the string passed
as alg_id is defined (not None which is the default) each Seismogram or TimeSeries object will attempt to
save the history through a new_map operation.   If the history chain is empty this will silently generate
an error posted to error log on each object.</p></li>
<li><p><strong>alg_id</strong> (<a class="reference external" href="https://pymongo.readthedocs.io/en/stable/api/bson/objectid.html#bson.objectid.ObjectId" title="(in PyMongo v4.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bson.objectid.ObjectId</span></code></a>) – alg_id is a unique id to record the usage of func while preserving the history.</p></li>
<li><p><strong>alg_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – alg_name is the name the func we are gonna save while preserving the history.</p></li>
<li><p><strong>dryrun</strong> – True for dry-run, the algorithm is not run, but the arguments used in this wrapper will be checked.
This is useful for pre-run checks of a large job to validate a workflow. Errors generate exceptions
but the function returns before attempting any calculations.</p></li>
<li><p><strong>inplace_return</strong> – when func is an in-place function that doesn’t return anything, but you want to
return the origin data (for example, in map-reduce), set inplace_return as true.</p></li>
<li><p><strong>function_return_key</strong> – Some functions one might want to wrap with this decorator
return something that is appropriate to save as Metadata.  If so, use this argument to
define the key used to set that field in the data that is returned.
This feature should normally be considered as a way to wrap an existing
algorithm that you do not wish to alter, but which returns something useful.
In principle that return can be almost anything, but we recommend this feature
be limited to only simple types (i.e. int, float, etc.).  The decorator makes
no type checks so the caller is responsible for assuring what is posted will not cause
downstream problems.  The default for this parameter is None, which
is taken to mean any return of the wrapped function will be ignored.  Note
that when function_return_key is anything but None, it is assumed the
returned object is the (usually modified) data object.</p></li>
<li><p><strong>kwargs</strong> – extra kv arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>origin data or the output of func</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.decorators.mspass_func_wrapper_multi">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.decorators.</span></span><span class="sig-name descname"><span class="pre">mspass_func_wrapper_multi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">object_history</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alg_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alg_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dryrun</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/decorators.html#mspass_func_wrapper_multi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.decorators.mspass_func_wrapper_multi" title="Permalink to this definition"></a></dt>
<dd><p>This wrapper serves the same functionality as mspass_func_wrapper, but there are a few differences. The first is
this wrapper accepts two mspasspy data objects as input data. The second is that inplace_return is not implemented
here. The same processing history and error logs will be duplicated and stored in both of the input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> – target function</p></li>
<li><p><strong>data1</strong> – input data, only mspasspy data objects are accepted, i.e. TimeSeries, Seismogram, Ensemble.</p></li>
<li><p><strong>data2</strong> – input data, only mspasspy data objects are accepted, i.e. TimeSeries, Seismogram, Ensemble.</p></li>
<li><p><strong>args</strong> – extra arguments</p></li>
<li><p><strong>object_history</strong> – True to preserve this processing history in the data object, False not to. object_history
and alg_id are intimately related and control how object level history is handled.
Object level history is disabled by default for efficiency.  If object_history is set True and the string passed
as alg_id is defined (not None which is the default) each Seismogram or TimeSeries object will attempt to
save the history through a new_map operation.   If the history chain is empty this will silently generate
an error posted to error log on each object.</p></li>
<li><p><strong>alg_id</strong> (<a class="reference external" href="https://pymongo.readthedocs.io/en/stable/api/bson/objectid.html#bson.objectid.ObjectId" title="(in PyMongo v4.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bson.objectid.ObjectId</span></code></a>) – alg_id is a unique id to record the usage of func while preserving the history.</p></li>
<li><p><strong>alg_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – alg_name is the name the func we are gonna save while preserving the history.</p></li>
<li><p><strong>dryrun</strong> – True for dry-run, the algorithm is not run, but the arguments used in this wrapper will be checked.
This is useful for pre-run checks of a large job to validate a workflow. Errors generate exceptions
but the function returns before attempting any calculations.</p></li>
<li><p><strong>kwargs</strong> – extra kv arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the output of func</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.decorators.mspass_method_wrapper">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.decorators.</span></span><span class="sig-name descname"><span class="pre">mspass_method_wrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selfarg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">object_history</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alg_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alg_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dryrun</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace_return</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_return_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/decorators.html#mspass_method_wrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.decorators.mspass_method_wrapper" title="Permalink to this definition"></a></dt>
<dd><p>Decorator wrapper to adapt a class method function to the mspass parallel processing framework.</p>
<p>This function serves as a decorator wrapper, which is widely used in the mspasspy library.
It is used to wrap class methods which implement a method that does something
to a mspass data object that is assumed to be passed as arg0 of the method.
This decorator executes the target method on the input data.  It is used
mainly to reduce duplicate code to perserve history and error logs
with mspass object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> – target function</p></li>
<li><p><strong>selfarg</strong> – the self pointer for the class with which this method is associated</p></li>
<li><p><strong>data</strong> – input data, only mspasspy data objects are accepted, i.e. TimeSeries, Seismogram, Ensemble.</p></li>
<li><p><strong>args</strong> – extra arguments</p></li>
<li><p><strong>object_history</strong> – True to preserve this processing history in the data object, False not to. object_history
and alg_id are intimately related and control how object level history is handled.
Object level history is disabled by default for efficiency.  If object_history is set True and the string passed
as alg_id is defined (not None which is the default) each Seismogram or TimeSeries object will attempt to
save the history through a new_map operation.   If the history chain is empty this will silently generate
an error posted to error log on each object.</p></li>
<li><p><strong>alg_id</strong> (<a class="reference external" href="https://pymongo.readthedocs.io/en/stable/api/bson/objectid.html#bson.objectid.ObjectId" title="(in PyMongo v4.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bson.objectid.ObjectId</span></code></a>) – alg_id is a unique id to record the usage of func while preserving the history.</p></li>
<li><p><strong>alg_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – alg_name is the name the func we are gonna save while preserving the history.</p></li>
<li><p><strong>dryrun</strong> – True for dry-run, the algorithm is not run, but the arguments used in this wrapper will be checked.
This is useful for pre-run checks of a large job to validate a workflow. Errors generate exceptions
but the function returns before attempting any calculations.</p></li>
<li><p><strong>inplace_return</strong> – when func is an in-place function that doesn’t return anything, but you want to
return the origin data (for example, in map-reduce), set inplace_return as true.</p></li>
<li><p><strong>function_return_key</strong> – Some functions one might want to wrap with this decorator
return something that is appropriate to save as Metadata.  If so, use this argument to
define the key used to set that field in the data that is returned.
This feature should normally be considered as a way to wrap an existing
algorithm that you do not wish to alter, but which returns something useful.
In principle that return can be almost anything, but we recommend this feature
be limited to only simple types (i.e. int, float, etc.).  The decorator makes
no type checks so the caller is responsible for assuring what is posted will not cause
downstream problems.  The default for this parameter is None, which
is taken to mean any return of the wrapped function will be ignored.  Note
that when function_return_key is anything but None, it is assumed the
returned object is the (usually modified) data object.</p></li>
<li><p><strong>kwargs</strong> – extra kv arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>origin data or the output of func</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.decorators.mspass_reduce_func_wrapper">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.decorators.</span></span><span class="sig-name descname"><span class="pre">mspass_reduce_func_wrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">object_history</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alg_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alg_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dryrun</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/decorators.html#mspass_reduce_func_wrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.decorators.mspass_reduce_func_wrapper" title="Permalink to this definition"></a></dt>
<dd><p>This decorator is designed to wrap functions so that they can be used as reduce operator. It takes two inputs, data1
and data2, both of them are mspasspy objects. The processing history and error logs will recorded in both data1
and data2. Other functionalities are the same as mspass_func_wrapper.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> – target function</p></li>
<li><p><strong>data1</strong> – input data, only mspasspy data objects are accepted, i.e. TimeSeries, Seismogram, Ensemble.</p></li>
<li><p><strong>data2</strong> – input data, only mspasspy data objects are accepted, i.e. TimeSeries, Seismogram, Ensemble.</p></li>
<li><p><strong>args</strong> – extra arguments</p></li>
<li><p><strong>object_history</strong> – True to preserve this processing history in the data object, False not to. object_history
and alg_id are intimately related and control how object level history is handled.
Object level history is disabled by default for efficiency.  If object_history is set True and the string passed
as alg_id is defined (not None which is the default) each Seismogram or TimeSeries object will attempt to
save the history through a new_reduce operation. If the history chain is empty this will silently generate
an error posted to error log on each object.</p></li>
<li><p><strong>alg_id</strong> (<a class="reference external" href="https://pymongo.readthedocs.io/en/stable/api/bson/objectid.html#bson.objectid.ObjectId" title="(in PyMongo v4.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bson.objectid.ObjectId</span></code></a>) – alg_id is a unique id to record the usage of func while preserving the history.</p></li>
<li><p><strong>alg_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – alg_name is the name the func we are gonna save while preserving the history.</p></li>
<li><p><strong>dryrun</strong> – True for dry-run, the algorithm is not run, but the arguments used in this wrapper will be checked.
This is useful for pre-run checks of a large job to validate a workflow. Errors generate exceptions
but the function returns before attempting any calculations.</p></li>
<li><p><strong>kwargs</strong> – extra kv arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the output of func</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.decorators.seismogram_as_stream">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.decorators.</span></span><span class="sig-name descname"><span class="pre">seismogram_as_stream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/decorators.html#seismogram_as_stream"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.decorators.seismogram_as_stream" title="Permalink to this definition"></a></dt>
<dd><p>This decorator converts all the mspasspy Seismogram objects in user inputs (<a href="#id3"><span class="problematic" id="id4">*</span></a>args and <a href="#id5"><span class="problematic" id="id6">**</span></a>kargs)
to stream objects (defined in Obspy), and execute the func with the converted user inputs. After the execution,
the stream objects will be converted back by overriding the data and metadata of the origin mspasspy objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> – target func</p></li>
<li><p><strong>args</strong> – extra arguments</p></li>
<li><p><strong>kwargs</strong> – extra kv arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the output of func</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.decorators.seismogram_copy_helper">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.decorators.</span></span><span class="sig-name descname"><span class="pre">seismogram_copy_helper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seis1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seis2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/decorators.html#seismogram_copy_helper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.decorators.seismogram_copy_helper" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.decorators.seismogram_ensemble_as_stream">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.decorators.</span></span><span class="sig-name descname"><span class="pre">seismogram_ensemble_as_stream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/decorators.html#seismogram_ensemble_as_stream"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.decorators.seismogram_ensemble_as_stream" title="Permalink to this definition"></a></dt>
<dd><p>This decorator converts all the mspasspy Seismogram ensemble objects in user inputs (<a href="#id7"><span class="problematic" id="id8">*</span></a>args and <a href="#id9"><span class="problematic" id="id10">**</span></a>kargs)
to stream objects (defined in Obspy), and execute the func with the converted user inputs. After the execution,
the stream objects will be converted back by overriding the data and metadata of each member in the ensemble.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> – target func</p></li>
<li><p><strong>args</strong> – extra arguments</p></li>
<li><p><strong>kwargs</strong> – extra kv arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the output of func</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.decorators.seismogram_ensemble_copy_helper">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.decorators.</span></span><span class="sig-name descname"><span class="pre">seismogram_ensemble_copy_helper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">es1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">es2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/decorators.html#seismogram_ensemble_copy_helper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.decorators.seismogram_ensemble_copy_helper" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.decorators.timeseries_as_trace">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.decorators.</span></span><span class="sig-name descname"><span class="pre">timeseries_as_trace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/decorators.html#timeseries_as_trace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.decorators.timeseries_as_trace" title="Permalink to this definition"></a></dt>
<dd><p>This decorator converts all the mspasspy TimeSeries objects in user inputs (<a href="#id11"><span class="problematic" id="id12">*</span></a>args and <a href="#id13"><span class="problematic" id="id14">**</span></a>kargs)
to trace objects (defined in Obspy), and execute the func with the converted user inputs. After the execution,
the trace objects will be converted back by overriding the data and metadata of the origin mspasspy objects. This
wrapper makes it easy to process mspasspy objects using Obspy methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> – target func</p></li>
<li><p><strong>args</strong> – extra arguments</p></li>
<li><p><strong>kwargs</strong> – extra kv arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the output of func</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.decorators.timeseries_copy_helper">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.decorators.</span></span><span class="sig-name descname"><span class="pre">timeseries_copy_helper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/decorators.html#timeseries_copy_helper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.decorators.timeseries_copy_helper" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.decorators.timeseries_ensemble_as_stream">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.decorators.</span></span><span class="sig-name descname"><span class="pre">timeseries_ensemble_as_stream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/decorators.html#timeseries_ensemble_as_stream"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.decorators.timeseries_ensemble_as_stream" title="Permalink to this definition"></a></dt>
<dd><p>This decorator converts all the mspasspy TimeSeries ensemble objects in user inputs (<a href="#id15"><span class="problematic" id="id16">*</span></a>args and <a href="#id17"><span class="problematic" id="id18">**</span></a>kargs)
to stream objects (defined in Obspy), and execute the func with the converted user inputs. After the execution,
the stream objects will be converted back by overriding the data and metadata of each member in the ensemble.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> – target func</p></li>
<li><p><strong>args</strong> – extra arguments</p></li>
<li><p><strong>kwargs</strong> – extra kv arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the output of func</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.decorators.timeseries_ensemble_copy_helper">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.decorators.</span></span><span class="sig-name descname"><span class="pre">timeseries_ensemble_copy_helper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">es1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">es2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/decorators.html#timeseries_ensemble_copy_helper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.decorators.timeseries_ensemble_copy_helper" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-mspasspy.util.logging_helper">
<span id="logging-helper"></span><h2>logging_helper<a class="headerlink" href="#module-mspasspy.util.logging_helper" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.logging_helper.ensemble_error">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.logging_helper.</span></span><span class="sig-name descname"><span class="pre">ensemble_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">message</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_severity=&lt;ErrorSeverity.Invalid:</span> <span class="pre">1&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/logging_helper.html#ensemble_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.logging_helper.ensemble_error" title="Permalink to this definition"></a></dt>
<dd><p>This is a small helper function useful for error handlers in except
blocks for ensemble objects.  If a function is called on an ensemble
object that throws an exception this function will post the message
posted to all ensemble members.  It silently does nothing if the
ensemble is empty.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>err_severity</strong> – severity of the error, default as ErrorSeverity.Invalid.</p></li>
<li><p><strong>d</strong> – is the ensemble data to be handled. It print and error message
and returns doing nothing if d is not one of the known ensemble
objects.</p></li>
<li><p><strong>alg</strong> – is the algorithm name posted to elog on each member</p></li>
<li><p><strong>message</strong> – is the string posted to all members</p></li>
</ul>
</dd>
</dl>
<p>(Note due to a current flaw in the api we don’t have access to the
severity attribute.  For now this always set it Invalid)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.logging_helper.info">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.logging_helper.</span></span><span class="sig-name descname"><span class="pre">info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alg_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alg_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/logging_helper.html#info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.logging_helper.info" title="Permalink to this definition"></a></dt>
<dd><p>This helper function is used to log operations in processing history of mspass object.
Per best practice, every operations happen on the mspass object should be logged.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – the mspass data object</p></li>
<li><p><strong>alg_id</strong> – an id designator to uniquely define an instance of algorithm.</p></li>
<li><p><strong>alg_name</strong> – the name of the algorithm that used on the mspass object.</p></li>
<li><p><strong>target</strong> – if the mspass data object is an ensemble type, you may use target as index to
log on one specific object in the ensemble. If target is not specified, all the objects in the ensemble
will be logged using the same information.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.logging_helper.reduce">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.logging_helper.</span></span><span class="sig-name descname"><span class="pre">reduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alg_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alg_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/logging_helper.html#reduce"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.logging_helper.reduce" title="Permalink to this definition"></a></dt>
<dd><p>This function replicates the processing history of data2 onto data1, which is a common use case
in reduce stage. If data1 is dead, it will keep silent, i.e. no history will be replicated. If data2 is dead,
the processing history will still be replicated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data1</strong> – Mspass object</p></li>
<li><p><strong>data2</strong> – Mspass object</p></li>
<li><p><strong>alg_id</strong> – The unique id of that user gives to the algorithm.</p></li>
<li><p><strong>alg_name</strong> – The name of the reduce algorithm that uses this helper function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-mspasspy.util.seispp">
<span id="seispp"></span><h2>seispp<a class="headerlink" href="#module-mspasspy.util.seispp" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="mspasspy.util.seispp.index_data">
<span class="sig-prename descclassname"><span class="pre">mspasspy.util.seispp.</span></span><span class="sig-name descname"><span class="pre">index_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filebase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'d3C'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/seispp.html#index_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.seispp.index_data" title="Permalink to this definition"></a></dt>
<dd><p>Import function for data from antelope export_to_mspass.</p>
<p>This function is an import function for Seismogram objects created
by the antelope program export_to_mspass.  That program writes
header data as a yaml file and the sample data as a raw binary
fwrite of the data matrix (stored in fortran order but written
as a contiguous block of 3*npts (number of samples) double values.
This function parses the yaml file and adds three critical metadata
entries:  dfile, dir, and foff. To get foff values the function
reads the binary data file and gets foff values by calls to tell.
It then writes these entries into MongoDB in the wf collection
of a database.   Readers that want to read this raw data will
need to use dir, dfile, and foff to find the right file and read point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filebase</strong> – is the base name of the dataset to be read and indexed.
The function will look for filebase.yaml for the header data and
filebase.ext (Arg 3 defaulting to d3C).</p></li>
<li><p><strong>db</strong> – is the MongoDB database handler</p></li>
<li><p><strong>ext</strong> – is the file extension for the sample data (default is ‘d3C’).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-mspasspy.util.Undertaker">
<span id="undertaker"></span><h2>Undertaker<a class="headerlink" href="#module-mspasspy.util.Undertaker" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mspasspy.util.Undertaker.Undertaker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mspasspy.util.Undertaker.</span></span><span class="sig-name descname"><span class="pre">Undertaker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dbin</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/Undertaker.html#Undertaker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.Undertaker.Undertaker" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="mspasspy.db.html#mspasspy.db.database.Database" title="mspasspy.db.database.Database"><code class="xref py py-class docutils literal notranslate"><span class="pre">Database</span></code></a></p>
<p>Class to handle dead data.  Many for ensembles, but has methods to
save elog entries for Seismogram or TimeSeries objects marked dead.
A concept of this class is any thing received that is live is not
changed.   It only handles the dead.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mspasspy.util.Undertaker.Undertaker.bring_out_your_dead">
<span class="sig-name descname"><span class="pre">bring_out_your_dead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bury</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/Undertaker.html#Undertaker.bring_out_your_dead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.Undertaker.Undertaker.bring_out_your_dead" title="Permalink to this definition"></a></dt>
<dd><p>Seperate an ensemble into live and dead members.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> – must be either a TimeSeriesEnsemble or SeismogramEnsemble of
data to be processed.</p></li>
<li><p><strong>bury</strong> – if true the bury_the_dead method will be called on the
ensemble of dead data before returning</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>python list with two elements. 0 is ensemble with live data
and 1 is ensemble with dead data.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>python list with two components</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mspasspy.util.Undertaker.Undertaker.bury_the_dead">
<span class="sig-name descname"><span class="pre">bury_the_dead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_history</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/Undertaker.html#Undertaker.bury_the_dead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.Undertaker.Undertaker.bury_the_dead" title="Permalink to this definition"></a></dt>
<dd><p>Clear the contents of an ensemble and optionally save the history and
error log of the dead.  Return the cleaned ensmble.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mspasspy.util.Undertaker.Undertaker.cremate">
<span class="sig-name descname"><span class="pre">cremate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/util/Undertaker.html#Undertaker.cremate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mspasspy.util.Undertaker.Undertaker.cremate" title="Permalink to this definition"></a></dt>
<dd><p>Like bury_the_dead but nothing is preserved of the dead.   Functionally equivalent to
bury_the_dead with save_history False, but with a more memorable name.</p>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="mspasspy.reduce.html" class="btn btn-neutral float-left" title="mspasspy.reduce" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../cxx_api/index.html" class="btn btn-neutral float-right" title="C++ API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020-2021, Ian Wang.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>