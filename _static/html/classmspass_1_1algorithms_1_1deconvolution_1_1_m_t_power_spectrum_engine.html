<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MsPASS C++ API: mspass::algorithms::deconvolution::MTPowerSpectrumEngine Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script src="striped_bg.js"></script>
<link href="that_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> version
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
   <div id="projectbrief">Defines the C++ API for MsPASS</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>mspass</b></li><li class="navelem"><b>algorithms</b></li><li class="navelem"><b>deconvolution</b></li><li class="navelem"><a class="el" href="classmspass_1_1algorithms_1_1deconvolution_1_1_m_t_power_spectrum_engine.html">MTPowerSpectrumEngine</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classmspass_1_1algorithms_1_1deconvolution_1_1_m_t_power_spectrum_engine-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">mspass::algorithms::deconvolution::MTPowerSpectrumEngine Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Multittaper power spectral estimator.  
 <a href="classmspass_1_1algorithms_1_1deconvolution_1_1_m_t_power_spectrum_engine.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_m_t_power_spectrum_engine_8h_source.html">MTPowerSpectrumEngine.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a509f3db8c91ae8e97b241bd5da67cd61"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1deconvolution_1_1_m_t_power_spectrum_engine.html#a509f3db8c91ae8e97b241bd5da67cd61">MTPowerSpectrumEngine</a> ()</td></tr>
<tr class="separator:a509f3db8c91ae8e97b241bd5da67cd61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f082a7cca3a74d96b16df852f3ef040"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1deconvolution_1_1_m_t_power_spectrum_engine.html#a7f082a7cca3a74d96b16df852f3ef040">MTPowerSpectrumEngine</a> (const int winsize, const double tbp, const int ntapers)</td></tr>
<tr class="memdesc:a7f082a7cca3a74d96b16df852f3ef040"><td class="mdescLeft">&#160;</td><td class="mdescRight">construct with full definition.  <a href="classmspass_1_1algorithms_1_1deconvolution_1_1_m_t_power_spectrum_engine.html#a7f082a7cca3a74d96b16df852f3ef040">More...</a><br /></td></tr>
<tr class="separator:a7f082a7cca3a74d96b16df852f3ef040"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a678a1167722867cfb20acc0c56932882"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1deconvolution_1_1_m_t_power_spectrum_engine.html#a678a1167722867cfb20acc0c56932882">MTPowerSpectrumEngine</a> (const <a class="el" href="classmspass_1_1algorithms_1_1deconvolution_1_1_m_t_power_spectrum_engine.html">MTPowerSpectrumEngine</a> &amp;parent)</td></tr>
<tr class="separator:a678a1167722867cfb20acc0c56932882"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8232d61152acbe74c6a890a662f89c63"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1deconvolution_1_1_m_t_power_spectrum_engine.html#a8232d61152acbe74c6a890a662f89c63">~MTPowerSpectrumEngine</a> ()</td></tr>
<tr class="separator:a8232d61152acbe74c6a890a662f89c63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51379e47b45995eb44c519c2672de77b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmspass_1_1algorithms_1_1deconvolution_1_1_m_t_power_spectrum_engine.html">MTPowerSpectrumEngine</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1deconvolution_1_1_m_t_power_spectrum_engine.html#a51379e47b45995eb44c519c2672de77b">operator=</a> (const <a class="el" href="classmspass_1_1algorithms_1_1deconvolution_1_1_m_t_power_spectrum_engine.html">MTPowerSpectrumEngine</a> &amp;parent)</td></tr>
<tr class="separator:a51379e47b45995eb44c519c2672de77b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3c10c25ea2c6b82cf8bbe2991f16bfe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmspass_1_1seismic_1_1_power_spectrum.html">mspass::seismic::PowerSpectrum</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1deconvolution_1_1_m_t_power_spectrum_engine.html#aa3c10c25ea2c6b82cf8bbe2991f16bfe">apply</a> (const <a class="el" href="classmspass_1_1seismic_1_1_time_series.html">mspass::seismic::TimeSeries</a> &amp;d)</td></tr>
<tr class="separator:aa3c10c25ea2c6b82cf8bbe2991f16bfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b7b9b8e20cd59a00ed0f4fbeab7829b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1deconvolution_1_1_m_t_power_spectrum_engine.html#a3b7b9b8e20cd59a00ed0f4fbeab7829b">apply</a> (const std::vector&lt; double &gt; &amp;d)</td></tr>
<tr class="memdesc:a3b7b9b8e20cd59a00ed0f4fbeab7829b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Low level processing of vector of data.  <a href="classmspass_1_1algorithms_1_1deconvolution_1_1_m_t_power_spectrum_engine.html#a3b7b9b8e20cd59a00ed0f4fbeab7829b">More...</a><br /></td></tr>
<tr class="separator:a3b7b9b8e20cd59a00ed0f4fbeab7829b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada36c092fdc3aa128be8eb25d00349d6"><td class="memItemLeft" align="right" valign="top"><a id="ada36c092fdc3aa128be8eb25d00349d6"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>df</b> () const</td></tr>
<tr class="separator:ada36c092fdc3aa128be8eb25d00349d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a626438cc21ade06cfa7053c324ae58b4"><td class="memItemLeft" align="right" valign="top"><a id="a626438cc21ade06cfa7053c324ae58b4"></a>
std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>frequencies</b> ()</td></tr>
<tr class="separator:a626438cc21ade06cfa7053c324ae58b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a114db709279ea8ab275ba69fbdcbec13"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1deconvolution_1_1_m_t_power_spectrum_engine.html#a114db709279ea8ab275ba69fbdcbec13">taper_length</a> () const</td></tr>
<tr class="separator:a114db709279ea8ab275ba69fbdcbec13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accf94d6d1dff859884d9c0aa1719994a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1deconvolution_1_1_m_t_power_spectrum_engine.html#accf94d6d1dff859884d9c0aa1719994a">time_bandwidth_product</a> () const</td></tr>
<tr class="separator:accf94d6d1dff859884d9c0aa1719994a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10d4b650fdedd815652c1e4e86a0e715"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1deconvolution_1_1_m_t_power_spectrum_engine.html#a10d4b650fdedd815652c1e4e86a0e715">number_tapers</a> () const</td></tr>
<tr class="separator:a10d4b650fdedd815652c1e4e86a0e715"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dadcf9ec587fa2d48d04066ba1d55b4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1deconvolution_1_1_m_t_power_spectrum_engine.html#a1dadcf9ec587fa2d48d04066ba1d55b4">set_df</a> (double dt)</td></tr>
<tr class="memdesc:a1dadcf9ec587fa2d48d04066ba1d55b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">PUtter equivalent of df.  <a href="classmspass_1_1algorithms_1_1deconvolution_1_1_m_t_power_spectrum_engine.html#a1dadcf9ec587fa2d48d04066ba1d55b4">More...</a><br /></td></tr>
<tr class="separator:a1dadcf9ec587fa2d48d04066ba1d55b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Multittaper power spectral estimator. </p>
<p>The multitaper method uses averages of spectra windowed by Slepian functions. This class can be used to compute power spectra. For efficiency the design has constructors that build the Slepian functions and cache them in a private area. We use this model because computing spectra on a large data set in parallel will usually be done with a fixed time window. The expected use is that normally the engine is created once and passed as an argument to functions using it in a map operator.</p>
<p>This class uses the apply model for processing. It accepts raw vector or TimeSeries data. The former assumes the sample interval is 1 while the second scales the spectrum to have units of 1/Hz. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a509f3db8c91ae8e97b241bd5da67cd61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a509f3db8c91ae8e97b241bd5da67cd61">&#9670;&nbsp;</a></span>MTPowerSpectrumEngine() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mspass::algorithms::deconvolution::MTPowerSpectrumEngine::MTPowerSpectrumEngine </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Default constructor. Do not use as it produces a null object that is no functional. </p>
<div class="fragment"><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;{</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  taperlen=0;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  ntapers=0;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  tbp=0.0;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  deltaf=1.0;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  wavetable=NULL;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  workspace=NULL;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7f082a7cca3a74d96b16df852f3ef040"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f082a7cca3a74d96b16df852f3ef040">&#9670;&nbsp;</a></span>MTPowerSpectrumEngine() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mspass::algorithms::deconvolution::MTPowerSpectrumEngine::MTPowerSpectrumEngine </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>winsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>tbp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ntapers</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>construct with full definition. </p>
<p>This should be the normal constructor used to create this object. It creates and caches the Slepian tapers that are used on calls the apply method.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">winsize</td><td>is the length of time windows in samples the operator will be designed to compute. </td></tr>
    <tr><td class="paramname">tbp</td><td>is the time bandwidth product to use for the operator. </td></tr>
    <tr><td class="paramname">ntapers</td><td>is the number of tapers to actually use for the operator. Note the maximum ntapers is always int(tbp*2). If ntapers is more than 2*tbp a mesage will be posted to cerr and ntapers set to tbp*2. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;{</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  taperlen=winsize;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  tbp=tbpin;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  ntapers=ntpin;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  deltaf=1.0;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordtype">int</span> nseq=<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(2.0*tbp);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordflow">if</span>(ntapers&gt;nseq)</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    cerr &lt;&lt; <span class="stringliteral">&quot;MTPowerSpectrumEngine (WARNING):  requested number of tapers=&quot;</span>&lt;&lt;ntpin</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;      &lt;&lt; endl</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;is inconsistent with requested time time bandwidth product =&quot;</span>&lt;&lt;tbp</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;      &lt;&lt; endl</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;Reset number tapers to max allowed=&quot;</span>&lt;&lt;nseq&lt;&lt;endl;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    ntapers=nseq;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  }</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordtype">int</span> seql(0);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordtype">int</span> sequ=ntapers-1;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordtype">double</span> *work=<span class="keyword">new</span> <span class="keywordtype">double</span>[ntapers*taperlen];</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  dpss_calc(taperlen, tbp, seql, sequ, work);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  tapers=<a class="code" href="classmspass_1_1utility_1_1dmatrix.html">dmatrix</a>(ntapers,taperlen);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keywordtype">int</span> i,ii,j;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordflow">for</span>(i=0,ii=0; i&lt;ntapers; ++i)</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      <span class="keywordflow">for</span>(j=0; j&lt;taperlen; ++j)</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;          tapers(i,j)=work[ii];</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;          ++ii;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      }</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  }</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keyword">delete</span> [] work;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  wavetable=gsl_fft_complex_wavetable_alloc (taperlen);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  workspace=gsl_fft_complex_workspace_alloc (taperlen);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;}</div>
<div class="ttc" id="aclassmspass_1_1utility_1_1dmatrix_html"><div class="ttname"><a href="classmspass_1_1utility_1_1dmatrix.html">mspass::utility::dmatrix</a></div><div class="ttdoc">Lightweight, simple matrix object.</div><div class="ttdef"><b>Definition:</b> dmatrix.h:102</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a678a1167722867cfb20acc0c56932882"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a678a1167722867cfb20acc0c56932882">&#9670;&nbsp;</a></span>MTPowerSpectrumEngine() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mspass::algorithms::deconvolution::MTPowerSpectrumEngine::MTPowerSpectrumEngine </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmspass_1_1algorithms_1_1deconvolution_1_1_m_t_power_spectrum_engine.html">MTPowerSpectrumEngine</a> &amp;&#160;</td>
          <td class="paramname"><em>parent</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Standard copy constructor </p>
<div class="fragment"><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                                                                                : tapers(parent.tapers)</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;{</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  taperlen=parent.taperlen;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  ntapers=parent.ntapers;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  tbp=parent.tbp;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  deltaf=parent.deltaf;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  wavetable=gsl_fft_complex_wavetable_alloc (taperlen);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  workspace=gsl_fft_complex_workspace_alloc (taperlen);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8232d61152acbe74c6a890a662f89c63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8232d61152acbe74c6a890a662f89c63">&#9670;&nbsp;</a></span>~MTPowerSpectrumEngine()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mspass::algorithms::deconvolution::MTPowerSpectrumEngine::~MTPowerSpectrumEngine </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Destructor. Not trivial as it has to delete the fft workspace and cached tapers. </p>
<div class="fragment"><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;{</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">if</span>(wavetable!=NULL) gsl_fft_complex_wavetable_free (wavetable);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">if</span>(workspace!=NULL) gsl_fft_complex_workspace_free (workspace);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aa3c10c25ea2c6b82cf8bbe2991f16bfe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3c10c25ea2c6b82cf8bbe2991f16bfe">&#9670;&nbsp;</a></span>apply() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmspass_1_1seismic_1_1_power_spectrum.html">PowerSpectrum</a> mspass::algorithms::deconvolution::MTPowerSpectrumEngine::apply </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmspass_1_1seismic_1_1_time_series.html">mspass::seismic::TimeSeries</a> &amp;&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>\process a TimeSeries.</p>
<p>This is one of two methods for applying the multiaper algorithm to data. This one uses dt and data length to set the Rayleigh bin size (df). If the input data vector length is not the same as the operator length an elog complaint is posted to parent. Short data are processed but should be considered suspect unless the sizes differ by only a tiny fraction (e.g. and off by one error from rounding). Long data will be truncated on the right (i.e. sample 0 will be the start of the window used). The data return will be scaled to psd in units if 1/Hz.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">parent</td><td>is the data to process </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>vector containing estimated power spwecrum </dd></dl>
<div class="fragment"><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;{</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordflow">try</span>{</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">string</span> algorithm(<span class="stringliteral">&quot;MTPowerSpectrumEngine&quot;</span>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">/* We need to define this here to allow posting problems to elog.*/</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="classmspass_1_1seismic_1_1_power_spectrum.html">PowerSpectrum</a> result;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordtype">int</span> dsize=d.<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a347b349bb4e1f0e65978dfcd45ae3472">npts</a>();</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    vector&lt;double&gt; work;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    deltaf=this-&gt;<a class="code" href="classmspass_1_1algorithms_1_1deconvolution_1_1_m_t_power_spectrum_engine.html#a1dadcf9ec587fa2d48d04066ba1d55b4">set_df</a>(d.<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#af31c96c0e2173d7581e1c3a3f8bcfde8">dt</a>());</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">if</span>(dsize&lt;taperlen)</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      stringstream ss;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      ss&lt;&lt;<span class="stringliteral">&quot;Received data window of length=&quot;</span>&lt;&lt;d.<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a347b349bb4e1f0e65978dfcd45ae3472">npts</a>()&lt;&lt;<span class="stringliteral">&quot; samples&quot;</span>&lt;&lt;endl</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;Operator length=&quot;</span>&lt;&lt;taperlen&lt;&lt;endl</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;Results may be unreliable&quot;</span>&lt;&lt;endl;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      result.elog.<a class="code" href="classmspass_1_1utility_1_1_error_logger.html#aa69873ba0aebf67e9ba24d01992c0bcf">log_error</a>(algorithm,<span class="keywordtype">string</span>(ss.str()),ErrorSeverity::Suspect);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keywordtype">int</span> k;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <span class="keywordflow">for</span>(k=0;k&lt;taperlen;++k)work.push_back(0.0);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <span class="keywordflow">for</span>(k=0;k&lt;dsize;++k)work[k]=d.<a class="code" href="classmspass_1_1seismic_1_1_core_time_series.html#ab044edb3fe5fe734cb577a4434f390a2">s</a>[k];</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(dsize&gt;taperlen)</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      stringstream ss;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      ss&lt;&lt;<span class="stringliteral">&quot;Received data window of length=&quot;</span>&lt;&lt;d.<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a347b349bb4e1f0e65978dfcd45ae3472">npts</a>()&lt;&lt;<span class="stringliteral">&quot; samples&quot;</span>&lt;&lt;endl</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;Operator length=&quot;</span>&lt;&lt;taperlen&lt;&lt;endl</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;Results may be unreliable because data will be truncated to taper length&quot;</span>&lt;&lt;endl;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      result.elog.<a class="code" href="classmspass_1_1utility_1_1_error_logger.html#aa69873ba0aebf67e9ba24d01992c0bcf">log_error</a>(algorithm,ss.str(),ErrorSeverity::Suspect);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="keywordtype">int</span> k;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <span class="keywordflow">for</span>(k=0;k&lt;taperlen;++k)work.push_back(d.<a class="code" href="classmspass_1_1seismic_1_1_core_time_series.html#ab044edb3fe5fe734cb577a4434f390a2">s</a>[k]);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      work=d.<a class="code" href="classmspass_1_1seismic_1_1_core_time_series.html#ab044edb3fe5fe734cb577a4434f390a2">s</a>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">/* intentionally omit try catch here because the above logic assures Sizes</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">    must match here. This overloaded method will throw an exception in that case.*/</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    vector&lt;double&gt; spec(this-&gt;<a class="code" href="classmspass_1_1algorithms_1_1deconvolution_1_1_m_t_power_spectrum_engine.html#aa3c10c25ea2c6b82cf8bbe2991f16bfe">apply</a>(work));</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">/* This scaling is necessary to turn the result into power spectral density</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">    in units of 1/Hz. Multiply by dt, of course,  is division by the sampling</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">    frequency that many sources use. */</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">for</span>(<span class="keyword">auto</span> sptr=spec.begin();sptr!=spec.end();++sptr) *sptr *= d.<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#af31c96c0e2173d7581e1c3a3f8bcfde8">dt</a>();</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    result=<a class="code" href="classmspass_1_1seismic_1_1_power_spectrum.html">PowerSpectrum</a>(<span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classmspass_1_1utility_1_1_metadata.html">Metadata</a>&amp;<span class="keyword">&gt;</span>(d),spec,deltaf,<span class="keywordtype">string</span>(<span class="stringliteral">&quot;Multitaper&quot;</span>));</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">/* We post these to metadata for the generic PowerSpectrum object. */</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    result.put&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;time_bandwidth_product&quot;</span>,tbp);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    result.put&lt;<span class="keywordtype">long</span>&gt;(<span class="stringliteral">&quot;number_tapers&quot;</span>,ntapers);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  }<span class="keywordflow">catch</span>(...){<span class="keywordflow">throw</span>;};</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;}</div>
<div class="ttc" id="aclassmspass_1_1algorithms_1_1deconvolution_1_1_m_t_power_spectrum_engine_html_a1dadcf9ec587fa2d48d04066ba1d55b4"><div class="ttname"><a href="classmspass_1_1algorithms_1_1deconvolution_1_1_m_t_power_spectrum_engine.html#a1dadcf9ec587fa2d48d04066ba1d55b4">mspass::algorithms::deconvolution::MTPowerSpectrumEngine::set_df</a></div><div class="ttdeci">double set_df(double dt)</div><div class="ttdoc">PUtter equivalent of df.</div><div class="ttdef"><b>Definition:</b> MTPowerSpectrumEngine.h:114</div></div>
<div class="ttc" id="aclassmspass_1_1algorithms_1_1deconvolution_1_1_m_t_power_spectrum_engine_html_aa3c10c25ea2c6b82cf8bbe2991f16bfe"><div class="ttname"><a href="classmspass_1_1algorithms_1_1deconvolution_1_1_m_t_power_spectrum_engine.html#aa3c10c25ea2c6b82cf8bbe2991f16bfe">mspass::algorithms::deconvolution::MTPowerSpectrumEngine::apply</a></div><div class="ttdeci">mspass::seismic::PowerSpectrum apply(const mspass::seismic::TimeSeries &amp;d)</div><div class="ttdef"><b>Definition:</b> MTPowerSpectrumEngine.cc:84</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_basic_time_series_html_a347b349bb4e1f0e65978dfcd45ae3472"><div class="ttname"><a href="classmspass_1_1seismic_1_1_basic_time_series.html#a347b349bb4e1f0e65978dfcd45ae3472">mspass::seismic::BasicTimeSeries::npts</a></div><div class="ttdeci">size_t npts() const</div><div class="ttdef"><b>Definition:</b> BasicTimeSeries.h:183</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_basic_time_series_html_af31c96c0e2173d7581e1c3a3f8bcfde8"><div class="ttname"><a href="classmspass_1_1seismic_1_1_basic_time_series.html#af31c96c0e2173d7581e1c3a3f8bcfde8">mspass::seismic::BasicTimeSeries::dt</a></div><div class="ttdeci">double dt() const</div><div class="ttdef"><b>Definition:</b> BasicTimeSeries.h:157</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_core_time_series_html_ab044edb3fe5fe734cb577a4434f390a2"><div class="ttname"><a href="classmspass_1_1seismic_1_1_core_time_series.html#ab044edb3fe5fe734cb577a4434f390a2">mspass::seismic::CoreTimeSeries::s</a></div><div class="ttdeci">std::vector&lt; double &gt; s</div><div class="ttdef"><b>Definition:</b> CoreTimeSeries.h:28</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_power_spectrum_html"><div class="ttname"><a href="classmspass_1_1seismic_1_1_power_spectrum.html">mspass::seismic::PowerSpectrum</a></div><div class="ttdef"><b>Definition:</b> PowerSpectrum.h:10</div></div>
<div class="ttc" id="aclassmspass_1_1utility_1_1_error_logger_html_aa69873ba0aebf67e9ba24d01992c0bcf"><div class="ttname"><a href="classmspass_1_1utility_1_1_error_logger.html#aa69873ba0aebf67e9ba24d01992c0bcf">mspass::utility::ErrorLogger::log_error</a></div><div class="ttdeci">int log_error(const mspass::utility::MsPASSError &amp;merr)</div><div class="ttdef"><b>Definition:</b> ErrorLogger.cc:81</div></div>
<div class="ttc" id="aclassmspass_1_1utility_1_1_metadata_html"><div class="ttname"><a href="classmspass_1_1utility_1_1_metadata.html">mspass::utility::Metadata</a></div><div class="ttdef"><b>Definition:</b> Metadata.h:76</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#af31c96c0e2173d7581e1c3a3f8bcfde8">mspass::seismic::BasicTimeSeries::dt()</a>, <a class="el" href="classmspass_1_1utility_1_1_error_logger.html#aa69873ba0aebf67e9ba24d01992c0bcf">mspass::utility::ErrorLogger::log_error()</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a347b349bb4e1f0e65978dfcd45ae3472">mspass::seismic::BasicTimeSeries::npts()</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_time_series.html#ab044edb3fe5fe734cb577a4434f390a2">mspass::seismic::CoreTimeSeries::s</a>, and <a class="el" href="classmspass_1_1algorithms_1_1deconvolution_1_1_m_t_power_spectrum_engine.html#a1dadcf9ec587fa2d48d04066ba1d55b4">set_df()</a>.</p>

</div>
</div>
<a id="a3b7b9b8e20cd59a00ed0f4fbeab7829b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b7b9b8e20cd59a00ed0f4fbeab7829b">&#9670;&nbsp;</a></span>apply() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; mspass::algorithms::deconvolution::MTPowerSpectrumEngine::apply </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Low level processing of vector of data. </p>
<p>This is lower level function that processes a raw vector of data. Since it does not know the sample interval it cannot compute the rayleigh bin size so if callers need that feature they must do that (simple) calculation themselves. Unlike the TimeSeries method this one will throw an exception if the input data size does not match the operator size. It returns power spectral density assuming a sample rate of 1. i.e. it scales to correct for the gsl fft scaling by of the forward transform by N.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>is the vector of data to process. d.size() must this-&gt;taperlen() value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>vector containing estimated power spectrum (usual convention with 0 containing 0 frequency value) </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">throw</td><td>a MsPASSError if the size of d does not match operator length </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a10d4b650fdedd815652c1e4e86a0e715"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10d4b650fdedd815652c1e4e86a0e715">&#9670;&nbsp;</a></span>number_tapers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int mspass::algorithms::deconvolution::MTPowerSpectrumEngine::number_tapers </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return number of tapers used by this engine. </p>
<div class="fragment"><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">return</span> ntapers;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a51379e47b45995eb44c519c2672de77b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51379e47b45995eb44c519c2672de77b">&#9670;&nbsp;</a></span>operator=()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmspass_1_1algorithms_1_1deconvolution_1_1_m_t_power_spectrum_engine.html">MTPowerSpectrumEngine</a> &amp; mspass::algorithms::deconvolution::MTPowerSpectrumEngine::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmspass_1_1algorithms_1_1deconvolution_1_1_m_t_power_spectrum_engine.html">MTPowerSpectrumEngine</a> &amp;&#160;</td>
          <td class="paramname"><em>parent</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Standard assignment operator. </p>
<div class="fragment"><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;{</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keywordflow">if</span>(&amp;parent!=<span class="keyword">this</span>)</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    taperlen=parent.taperlen;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    ntapers=parent.ntapers;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    tbp=parent.tbp;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    deltaf=parent.deltaf;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    tapers=parent.tapers;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    wavetable = gsl_fft_complex_wavetable_alloc (taperlen);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    workspace = gsl_fft_complex_workspace_alloc (taperlen);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1dadcf9ec587fa2d48d04066ba1d55b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dadcf9ec587fa2d48d04066ba1d55b4">&#9670;&nbsp;</a></span>set_df()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double mspass::algorithms::deconvolution::MTPowerSpectrumEngine::set_df </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>PUtter equivalent of df. </p>
<p>The computation of the Rayleigh bin size (dt) is actually quote trivial but this convenience functon allows users of the vector&lt;double&gt; method to handle the comutation easily. It uses the internal oeprator size, however, to compute the df size it returns because the operator is dogmatic about using that size. Users wishing to call the frequency method and the apply method on raw vector data need to call this function before calling frequency.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dt</td><td>is the data sample interval (time domain)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>computed df </dd></dl>
<div class="fragment"><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    deltaf=1.0/(dt*<span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(taperlen));</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">return</span> deltaf;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a114db709279ea8ab275ba69fbdcbec13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a114db709279ea8ab275ba69fbdcbec13">&#9670;&nbsp;</a></span>taper_length()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int mspass::algorithms::deconvolution::MTPowerSpectrumEngine::taper_length </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Retrieve the taper length. </p>
<div class="fragment"><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">return</span> taperlen;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  };</div>
</div><!-- fragment -->
</div>
</div>
<a id="accf94d6d1dff859884d9c0aa1719994a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accf94d6d1dff859884d9c0aa1719994a">&#9670;&nbsp;</a></span>time_bandwidth_product()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double mspass::algorithms::deconvolution::MTPowerSpectrumEngine::time_bandwidth_product </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Retrieve time-bandwidth product. </p>
<div class="fragment"><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">return</span> tbp;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  };</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/runner/work/mspass/mspass/cxx/include/mspass/algorithms/deconvolution/<a class="el" href="_m_t_power_spectrum_engine_8h_source.html">MTPowerSpectrumEngine.h</a></li>
<li>/home/runner/work/mspass/mspass/cxx/src/lib/algorithms/deconvolution/MTPowerSpectrumEngine.cc</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
