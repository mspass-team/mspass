<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MsPASS C++ API: mspass::algorithms::Butterworth Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script src="striped_bg.js"></script>
<link href="that_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> version
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
   <div id="projectbrief">Defines the C++ API for MsPASS</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>mspass</b></li><li class="navelem"><b>algorithms</b></li><li class="navelem"><a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html">Butterworth</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classmspass_1_1algorithms_1_1_butterworth-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">mspass::algorithms::Butterworth Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>MsPASS implementation of <a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html" title="MsPASS implementation of Butterworth filter as processing object.">Butterworth</a> filter as processing object.  
 <a href="classmspass_1_1algorithms_1_1_butterworth.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_butterworth_8h_source.html">Butterworth.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a89009fa487f8a4090c5bce0c4af662cb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html#a89009fa487f8a4090c5bce0c4af662cb">Butterworth</a> ()</td></tr>
<tr class="memdesc:a89009fa487f8a4090c5bce0c4af662cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default constructor.  <a href="classmspass_1_1algorithms_1_1_butterworth.html#a89009fa487f8a4090c5bce0c4af662cb">More...</a><br /></td></tr>
<tr class="separator:a89009fa487f8a4090c5bce0c4af662cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb02193564836b8f7396a9acab24a50e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html#afb02193564836b8f7396a9acab24a50e">Butterworth</a> (const bool zerophase, const bool enable_lo, const bool enable_hi, const double fstoplo, const double astoplo, const double fpasslo, const double apasslo, const double fpasshi, const double apasshi, const double fstophi, const double astophi, const double sample_interval)</td></tr>
<tr class="memdesc:afb02193564836b8f7396a9acab24a50e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fully parameterized constructor with args similar to subfilt.  <a href="classmspass_1_1algorithms_1_1_butterworth.html#afb02193564836b8f7396a9acab24a50e">More...</a><br /></td></tr>
<tr class="separator:afb02193564836b8f7396a9acab24a50e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc7717b15d0d13067e819bfe3a81d806"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html#afc7717b15d0d13067e819bfe3a81d806">Butterworth</a> (const <a class="el" href="classmspass_1_1utility_1_1_metadata.html">mspass::utility::Metadata</a> &amp;md)</td></tr>
<tr class="separator:afc7717b15d0d13067e819bfe3a81d806"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85ccda5e0946fd375c03458a90f65c25"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html#a85ccda5e0946fd375c03458a90f65c25">Butterworth</a> (const bool zerophase, const bool enable_lo, const bool enable_hi, const int npolelo, const double f3dblo, const int npolehi, const double f3dbhi, const double sample_interval)</td></tr>
<tr class="memdesc:a85ccda5e0946fd375c03458a90f65c25"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct by defining corner frequencies and number of npoles.  <a href="classmspass_1_1algorithms_1_1_butterworth.html#a85ccda5e0946fd375c03458a90f65c25">More...</a><br /></td></tr>
<tr class="separator:a85ccda5e0946fd375c03458a90f65c25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60c3979ede1947661bb25d118bde228c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html#a60c3979ede1947661bb25d118bde228c">Butterworth</a> (const <a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html">Butterworth</a> &amp;parent)</td></tr>
<tr class="separator:a60c3979ede1947661bb25d118bde228c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7602075f3fe8f56e891331c98264d1a5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html">Butterworth</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html#a7602075f3fe8f56e891331c98264d1a5">operator=</a> (const <a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html">Butterworth</a> &amp;parent)</td></tr>
<tr class="separator:a7602075f3fe8f56e891331c98264d1a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b54d5d5966a85092d45ebebd0b88498"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmspass_1_1seismic_1_1_core_time_series.html">mspass::seismic::CoreTimeSeries</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html#a7b54d5d5966a85092d45ebebd0b88498">impulse_response</a> (const int n)</td></tr>
<tr class="memdesc:a7b54d5d5966a85092d45ebebd0b88498"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the impulse response.  <a href="classmspass_1_1algorithms_1_1_butterworth.html#a7b54d5d5966a85092d45ebebd0b88498">More...</a><br /></td></tr>
<tr class="separator:a7b54d5d5966a85092d45ebebd0b88498"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8c696b150ed18bfb3c4060dd884bfe3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html#ad8c696b150ed18bfb3c4060dd884bfe3">apply</a> (<a class="el" href="classmspass_1_1seismic_1_1_core_time_series.html">mspass::seismic::CoreTimeSeries</a> &amp;d)</td></tr>
<tr class="memdesc:ad8c696b150ed18bfb3c4060dd884bfe3"><td class="mdescLeft">&#160;</td><td class="mdescRight">pply the filter to a CoreTimeSeries object.  <a href="classmspass_1_1algorithms_1_1_butterworth.html#ad8c696b150ed18bfb3c4060dd884bfe3">More...</a><br /></td></tr>
<tr class="separator:ad8c696b150ed18bfb3c4060dd884bfe3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10c30a560e4dce8a3bc9fe80409cee80"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html#a10c30a560e4dce8a3bc9fe80409cee80">apply</a> (<a class="el" href="classmspass_1_1seismic_1_1_time_series.html">mspass::seismic::TimeSeries</a> &amp;d)</td></tr>
<tr class="memdesc:a10c30a560e4dce8a3bc9fe80409cee80"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply the filter to a CoreTimeSeries object.  <a href="classmspass_1_1algorithms_1_1_butterworth.html#a10c30a560e4dce8a3bc9fe80409cee80">More...</a><br /></td></tr>
<tr class="separator:a10c30a560e4dce8a3bc9fe80409cee80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b2416893b09cf7edad320a37c521c5a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html#a1b2416893b09cf7edad320a37c521c5a">apply</a> (std::vector&lt; double &gt; &amp;d)</td></tr>
<tr class="memdesc:a1b2416893b09cf7edad320a37c521c5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filter a raw vector of data.  <a href="classmspass_1_1algorithms_1_1_butterworth.html#a1b2416893b09cf7edad320a37c521c5a">More...</a><br /></td></tr>
<tr class="separator:a1b2416893b09cf7edad320a37c521c5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76dc3f128a5305ca1b04d863ae72b73b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html#a76dc3f128a5305ca1b04d863ae72b73b">apply</a> (<a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html">mspass::seismic::CoreSeismogram</a> &amp;d)</td></tr>
<tr class="memdesc:a76dc3f128a5305ca1b04d863ae72b73b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply the filter to a CoreSeismogram object.  <a href="classmspass_1_1algorithms_1_1_butterworth.html#a76dc3f128a5305ca1b04d863ae72b73b">More...</a><br /></td></tr>
<tr class="separator:a76dc3f128a5305ca1b04d863ae72b73b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb8d56355bb2b23cbf7e96b0b2fa7b24"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html#abb8d56355bb2b23cbf7e96b0b2fa7b24">apply</a> (<a class="el" href="classmspass_1_1seismic_1_1_seismogram.html">mspass::seismic::Seismogram</a> &amp;d)</td></tr>
<tr class="memdesc:abb8d56355bb2b23cbf7e96b0b2fa7b24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply the filter to a CoreTimeSeries object.  <a href="classmspass_1_1algorithms_1_1_butterworth.html#abb8d56355bb2b23cbf7e96b0b2fa7b24">More...</a><br /></td></tr>
<tr class="separator:abb8d56355bb2b23cbf7e96b0b2fa7b24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54e766697f72f1ba38b95915805dd6d9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmspass_1_1algorithms_1_1deconvolution_1_1_complex_array.html">mspass::algorithms::deconvolution::ComplexArray</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html#a54e766697f72f1ba38b95915805dd6d9">transfer_function</a> (const int n)</td></tr>
<tr class="memdesc:a54e766697f72f1ba38b95915805dd6d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the response of the filter in the frequency domain.  <a href="classmspass_1_1algorithms_1_1_butterworth.html#a54e766697f72f1ba38b95915805dd6d9">More...</a><br /></td></tr>
<tr class="separator:a54e766697f72f1ba38b95915805dd6d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94f20884465265de735d05946e1cea00"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html#a94f20884465265de735d05946e1cea00">change_dt</a> (const double dtnew)</td></tr>
<tr class="memdesc:a94f20884465265de735d05946e1cea00"><td class="mdescLeft">&#160;</td><td class="mdescRight">set the sample interval assumed for input data.  <a href="classmspass_1_1algorithms_1_1_butterworth.html#a94f20884465265de735d05946e1cea00">More...</a><br /></td></tr>
<tr class="separator:a94f20884465265de735d05946e1cea00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98d5b940b443524dbe317ae6b0efb1a3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html#a98d5b940b443524dbe317ae6b0efb1a3">low_corner</a> () const</td></tr>
<tr class="separator:a98d5b940b443524dbe317ae6b0efb1a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acae23f17a07efa21effb10a9da730f33"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html#acae23f17a07efa21effb10a9da730f33">high_corner</a> () const</td></tr>
<tr class="separator:acae23f17a07efa21effb10a9da730f33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b528a200c2b56f9420a5f29fb706d3c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html#a2b528a200c2b56f9420a5f29fb706d3c">npoles_low</a> () const</td></tr>
<tr class="separator:a2b528a200c2b56f9420a5f29fb706d3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a094f40b3c1d1ff857f696f19d0f85026"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html#a094f40b3c1d1ff857f696f19d0f85026">npoles_high</a> () const</td></tr>
<tr class="separator:a094f40b3c1d1ff857f696f19d0f85026"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb651e7aa0adb9f27cb32fbf14afeb29"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html#acb651e7aa0adb9f27cb32fbf14afeb29">current_dt</a> () const</td></tr>
<tr class="separator:acb651e7aa0adb9f27cb32fbf14afeb29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a446ac405d71fddd4adbd9d2a9722e331"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html#a446ac405d71fddd4adbd9d2a9722e331">filter_type</a> () const</td></tr>
<tr class="separator:a446ac405d71fddd4adbd9d2a9722e331"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9014cb292cb1c7ca452c80c5cb330b43"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html#a9014cb292cb1c7ca452c80c5cb330b43">is_zerophase</a> () const</td></tr>
<tr class="separator:a9014cb292cb1c7ca452c80c5cb330b43"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>MsPASS implementation of <a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html" title="MsPASS implementation of Butterworth filter as processing object.">Butterworth</a> filter as processing object. </p>
<p>MsPASS has an existing filter routine that can implement buterworth filters via obspy. This class was created to allow a clean interface to <a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html" title="MsPASS implementation of Butterworth filter as processing object.">Butterworth</a> filtering from C++ code that needs such an operator. The original use was an experimental deconvolution code, but there will likely be others because simple, efficient filters are a common internal need for potential applications.</p>
<p>This C++ class can be viewed as a wrapper for Seismic Unix functions that implement <a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html" title="MsPASS implementation of Butterworth filter as processing object.">Butterworth</a> filters. The parent functions were found in the cwp lib and were called bfdesign, bfhighpass, and bflowpass. Those three functions are the central tools used to implement this class. All the rest is really just a wrapper to provide an object oriented api to the su functions.</p>
<p>This class implements a processing object concept. That is, it is intended to be constructed and then used for processing multiple data objects with fixed parameters. For Butterwoth filtering the parameters are relatively simple (mainly two corner frequencies and number of poles defining the filter rolloff). A complexity, however, is that the class was designed to allow automatic handling of multiple sample rate data. That is handled internally by caching the sample interval of the data and automatically adjusting the coefficients when the sample interval changes. Note that feature only works for MsPASS data objects CoreTimeSeries and Seismogram where the sample interval is embedded in the object. The raw interface with a simple vector cannot know that. The method to change the expected sample interval has some sanity checks to reduce, but not eliminate the possibility of mistakes that will create unstable filters. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a89009fa487f8a4090c5bce0c4af662cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89009fa487f8a4090c5bce0c4af662cb">&#9670;&nbsp;</a></span>Butterworth() <span class="overload">[1/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mspass::algorithms::Butterworth::Butterworth </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Default constructor. </p>
<p>The default constructor does not define a null. The default generates an antialiasing filter identical to the default in the antialias function in seismic unix. That is it produces a low pass filter with a band edge (pass parameter) at 60% of Nyquist and a stop edge at Nyquist. It then calls the su bfdesign function to compute the number of poles and the 3db frequency of the corner to define this filter. These can be retrieved with getters (see below) </p>
<div class="fragment"><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;{</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="comment">/* This is a translation of a minimum phase antialias filter used in</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">    the antialias function in seismic unix.  We define it as a default</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">    because it does almost nothing - almost because it depends upon</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">    form of antialias applied to get to current state.  */</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keywordtype">double</span> fnyq,fpass,apass,fstop,astop;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    fnyq = 0.5;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    fpass = 0.6*fnyq;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    apass = 0.99;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    fstop = fnyq;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    astop = 0.01;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    this-&gt;bfdesign(fpass,apass,fstop,astop,</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;            &amp;(this-&gt;npoles_hi),&amp;(this-&gt;f3db_hi));</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    dt=1.0;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    use_lo=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    use_hi=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    f3db_lo=0.0;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    npoles_lo=0;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    zerophase=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;};</div>
</div><!-- fragment -->
</div>
</div>
<a id="afb02193564836b8f7396a9acab24a50e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb02193564836b8f7396a9acab24a50e">&#9670;&nbsp;</a></span>Butterworth() <span class="overload">[2/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mspass::algorithms::Butterworth::Butterworth </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>zerophase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>enable_lo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>enable_hi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>fstoplo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>astoplo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>fpasslo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>apasslo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>fpasshi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>apasshi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>fstophi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>astophi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>sample_interval</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fully parameterized constructor with args similar to subfilt. </p>
<p>A butterworth filter can be described two ways: (1) corner frequency and number of poles and (2) by band stop and band frequencies. This constructor is used to define the filter by stop and pass band parameters. Frequencies must satisfy fstoplo&lt;fpasslo and fpasshi&lt;fstophi as the four frequencis define a bandd pass between the fpasslo and fpasshi. The stop frequencies define where the response should near zero. Thus for band pass filters the apasslo and apasshi should be 1 and the stop Amplitudes a small number like 0.01. For a band reject filter set stop amplitudes to 1 and pass amplitudes to small numbers like 0.01. (For a reject filter the pass frequencies act like stop frequencies for a bandbpass filer - this is mostly like the subfilt seismic unix program). The booleans control which terms are enabld. When enable_lo is true the lo components are used an when enable_hi is true the high componens are used.</p>
<p>There is a confusing nomenclature related to "high" and "low". In this implmentation I always take low to mean the low side of the passband and high to be the high side of the passband as described above for the 4 frequency point defiitions. The issue is "lowcut" versus "lowpass". Seismic Unix really mixes this up as their implmenetation (which I used here) refernces bflowpass and bfhighpass but subfilt uses the inverse lowcut and higcut terminology. A geeky implementation detail is I actually changed the names of the functions to eliminate the confusion in the implementation. That matters only if you want to compare what we did here to the original seismic unix code.</p>
<p>Note the iir filter coefficiets are always derived from the poles and Frequencies so this constructor is just an alternate way to define the filter without the abstraction of number of poles.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">zerophase</td><td>when true use a zerophase filter. When false defines a one pass minimum phase filter. </td></tr>
    <tr><td class="paramname">enable_lo</td><td>is a boolean that when true enables the low band parameters for the filter (i.e. the highpass=low-cut components) </td></tr>
    <tr><td class="paramname">enable_hi</td><td>is a boolean taht when true enables the parameters defining the upper frequency band edge (i.e. lowpass=high-cut parameters) </td></tr>
    <tr><td class="paramname">fstoplo</td><td>- stop band frequency for lower band edge </td></tr>
    <tr><td class="paramname">astoplo</td><td>- amplitude at stop frequency (small number for band pass, 1 for band reject) </td></tr>
    <tr><td class="paramname">fpasslo</td><td>- pass band frequency for lower band edge </td></tr>
    <tr><td class="paramname">apasslo</td><td>- amplitude at fpasslo frequency (1 for bandpass, small number for band reject) </td></tr>
    <tr><td class="paramname">fstophi</td><td>- stop band frequency for upper band edge </td></tr>
    <tr><td class="paramname">astophi</td><td>- amplitude at stop frequency (small number for band pass, 1 for band reject) </td></tr>
    <tr><td class="paramname">fpasshi</td><td>- pass band frequency for upper band edge </td></tr>
    <tr><td class="paramname">apasshi</td><td>- amplitude at fpasshi frequency (1 for bandpass, small number for band reject) </td></tr>
    <tr><td class="paramname">sample_interval</td><td>is the expected data sample interval </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;{</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    dt=sample_interval;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    zerophase=zp;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    use_lo=lcon;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    use_hi=hcon;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    this-&gt;bfdesign(fpasslo*dt,apasslo,fstoplo*dt,astoplo,</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                    &amp;(this-&gt;npoles_lo),&amp;(this-&gt;f3db_lo));</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    this-&gt;bfdesign(fpasshi*dt,apasshi,fstophi*dt,astophi,</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                    &amp;(this-&gt;npoles_hi),&amp;(this-&gt;f3db_hi));</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;};</div>
</div><!-- fragment -->
</div>
</div>
<a id="afc7717b15d0d13067e819bfe3a81d806"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc7717b15d0d13067e819bfe3a81d806">&#9670;&nbsp;</a></span>Butterworth() <span class="overload">[3/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mspass::algorithms::Butterworth::Butterworth </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmspass_1_1utility_1_1_metadata.html">mspass::utility::Metadata</a> &amp;&#160;</td>
          <td class="paramname"><em>md</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Construct using tagged valus created from a Metadata container.</p>
<p>This behaves exactly like the fully parameterized contructor except it gets the parameters from metadata. Metadata keys in initial implementation are identical to the argument names defined above. The best guidance for using this constuctor is to look a the comments in the default parameter file.</p>
<p>Construct using tagged valus created from a Metadata container </p>
<div class="fragment"><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;{</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordtype">string</span> base_error(<span class="stringliteral">&quot;Butterworth pf constructor:  &quot;</span>);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordflow">try</span>{</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        dt=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;sample_interval&quot;</span>);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="comment">/* We define these here even if they aren&#39;t all used for all options.</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">        Better for tiny memory cost than declaration in each block */</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keywordtype">double</span> fpass, apass, fstop, astop;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        zerophase=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#a2631da9d437572ee0781ed9bd96a3ed3">get_bool</a>(<span class="stringliteral">&quot;zerophase&quot;</span>);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="comment">/* These options simplify setup but complicate this constructor.  */</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordtype">string</span> ftype,fdmeth;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        ftype=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#aa56da98a52f03babd67bf9fb55c40f3a">get_string</a>(<span class="stringliteral">&quot;filter_type&quot;</span>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        fdmeth=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#aa56da98a52f03babd67bf9fb55c40f3a">get_string</a>(<span class="stringliteral">&quot;filter_definition_method&quot;</span>);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keywordflow">if</span>(ftype==<span class="stringliteral">&quot;bandpass&quot;</span>)</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            use_lo=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            use_hi=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            <span class="keywordflow">if</span>(fdmeth==<span class="stringliteral">&quot;corner_pole&quot;</span>)</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                <span class="comment">/* Note we allow flow&gt;figh to create strongly peaked filters although</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">                we don&#39;t scale these any any rational way */</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                npoles_lo=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;npoles_low&quot;</span>);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                npoles_hi=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;npoles_high&quot;</span>);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                f3db_lo=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;corner_low&quot;</span>);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                f3db_hi=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;corner_high&quot;</span>);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                <span class="comment">/* Stored as nondimensional internally*/</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                f3db_lo *= dt;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                f3db_hi *= dt;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                <span class="comment">/* note the set routines will test validity of input and throw</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">                an error if the points do not define the right sense of pass versus cut*/</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                fpass=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;fpass_low&quot;</span>);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                apass=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;apass_low&quot;</span>);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                fstop=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;fstop_low&quot;</span>);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                astop=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;astop_low&quot;</span>);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                this-&gt;set_lo(fpass,fstop,astop,apass);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                fpass=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;fpass_high&quot;</span>);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                apass=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;apass_high&quot;</span>);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                fstop=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;fstop_high&quot;</span>);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                astop=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;astop_high&quot;</span>);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                this-&gt;set_hi(fpass,fstop,apass,astop);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ftype==<span class="stringliteral">&quot;lowpass&quot;</span>)</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="comment">/* Note the confusing naming hre - lo means lo corner not low pass*/</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            use_lo=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            use_hi=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            <span class="comment">/* Explicity initialization useful here */</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            npoles_lo=0;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            f3db_lo=0.0;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            <span class="keywordflow">if</span>(fdmeth==<span class="stringliteral">&quot;corner_pole&quot;</span>)</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                npoles_hi=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;npoles_high&quot;</span>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                f3db_hi=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;corner_high&quot;</span>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                f3db_hi *= dt;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                fpass=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;fpass_high&quot;</span>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                apass=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;apass_high&quot;</span>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                fstop=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;fstop_high&quot;</span>);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                astop=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;astop_high&quot;</span>);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                <span class="comment">/* note this handles inconsistencies and can throw an error */</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                this-&gt;set_hi(fstop,fpass,astop,apass);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ftype==<span class="stringliteral">&quot;highpass&quot;</span>)</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            use_lo=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            use_hi=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            <span class="comment">/* Explicity initialization useful here */</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            npoles_hi=0;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            f3db_hi=0.0;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            <span class="keywordflow">if</span>(fdmeth==<span class="stringliteral">&quot;corner_pole&quot;</span>)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                npoles_hi=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;npoles_low&quot;</span>);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                f3db_hi=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;corner_low&quot;</span>);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                f3db_hi *= dt;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                fpass=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;fpass_low&quot;</span>);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                apass=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;apass_low&quot;</span>);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                fstop=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;fstop_low&quot;</span>);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                astop=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;astop_low&quot;</span>);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                <span class="comment">/* note this handles inconsistencies and can throw an error */</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                this-&gt;set_lo(fstop,fpass,astop,apass);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ftype==<span class="stringliteral">&quot;bandreject&quot;</span>)</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            use_lo=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            use_hi=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="keywordflow">if</span>(fdmeth==<span class="stringliteral">&quot;corner_pole&quot;</span>)</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                <span class="comment">/* Note we allow flow&gt;figh to create strongly peaked filters although</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">                we don&#39;t scale these any any rational way */</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                npoles_lo=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;npoles_low&quot;</span>);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                npoles_hi=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;npoles_high&quot;</span>);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                f3db_lo=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;corner_low&quot;</span>);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                f3db_hi=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;corner_high&quot;</span>);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                <span class="comment">/* Enforce this constraint or we don&#39;t have a band reject filtr */</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                <span class="keywordflow">if</span>(f3db_lo&lt;f3db_hi)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                    <span class="keywordflow">throw</span> <a class="code" href="classmspass_1_1utility_1_1_ms_p_a_s_s_error.html">MsPASSError</a>(base_error+<span class="stringliteral">&quot;Illegal corner frequencies for band reject filter definition&quot;</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                     + <span class="stringliteral">&quot;For a band reject low corner must be larger than high corner (pass becomes cut to reject)&quot;</span>,</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                     ErrorSeverity::Invalid);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                f3db_lo *=dt;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                f3db_hi *=dt;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                <span class="comment">/* We should test these values for defining band reject but bypass</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">                these safeties for now as I don&#39;t expect this feature to get much</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">                use. */</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                fpass=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;fpass_low&quot;</span>);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                apass=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;apass_low&quot;</span>);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                fstop=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;fstop_low&quot;</span>);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                astop=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;astop_low&quot;</span>);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                this-&gt;bfdesign(fpass*dt,apass,fstop*dt,astop,&amp;(this-&gt;npoles_lo),&amp;(this-&gt;f3db_lo));</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                fpass=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;fpass_high&quot;</span>);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                apass=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;apass_high&quot;</span>);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                fstop=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;fstop_high&quot;</span>);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                astop=md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;astop_high&quot;</span>);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                this-&gt;bfdesign(fpass*dt,apass,fstop*dt,astop,&amp;(this-&gt;npoles_hi),&amp;(this-&gt;f3db_hi));</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classmspass_1_1utility_1_1_ms_p_a_s_s_error.html">MsPASSError</a>(base_error+<span class="stringliteral">&quot;Unsupported filtr_type=&quot;</span>+ftype,</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                ErrorSeverity::Invalid);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        }</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    }<span class="keywordflow">catch</span>(...){<span class="keywordflow">throw</span>;};</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;}</div>
<div class="ttc" id="aclassmspass_1_1utility_1_1_metadata_html_a2631da9d437572ee0781ed9bd96a3ed3"><div class="ttname"><a href="classmspass_1_1utility_1_1_metadata.html#a2631da9d437572ee0781ed9bd96a3ed3">mspass::utility::Metadata::get_bool</a></div><div class="ttdeci">bool get_bool(const std::string key) const override</div><div class="ttdef"><b>Definition:</b> Metadata.h:228</div></div>
<div class="ttc" id="aclassmspass_1_1utility_1_1_metadata_html_aa56da98a52f03babd67bf9fb55c40f3a"><div class="ttname"><a href="classmspass_1_1utility_1_1_metadata.html#aa56da98a52f03babd67bf9fb55c40f3a">mspass::utility::Metadata::get_string</a></div><div class="ttdeci">std::string get_string(const std::string key) const override</div><div class="ttdef"><b>Definition:</b> Metadata.h:213</div></div>
<div class="ttc" id="aclassmspass_1_1utility_1_1_metadata_html_af2b1cac0f295d9ab5fb240b8b5e12539"><div class="ttname"><a href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">mspass::utility::Metadata::get</a></div><div class="ttdeci">T get(const std::string key) const</div><div class="ttdef"><b>Definition:</b> Metadata.h:472</div></div>
<div class="ttc" id="aclassmspass_1_1utility_1_1_ms_p_a_s_s_error_html"><div class="ttname"><a href="classmspass_1_1utility_1_1_ms_p_a_s_s_error.html">mspass::utility::MsPASSError</a></div><div class="ttdoc">Base class for error object thrown by MsPASS library routines.</div><div class="ttdef"><b>Definition:</b> MsPASSError.h:40</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">mspass::utility::Metadata::get()</a>, <a class="el" href="classmspass_1_1utility_1_1_metadata.html#a2631da9d437572ee0781ed9bd96a3ed3">mspass::utility::Metadata::get_bool()</a>, and <a class="el" href="classmspass_1_1utility_1_1_metadata.html#aa56da98a52f03babd67bf9fb55c40f3a">mspass::utility::Metadata::get_string()</a>.</p>

</div>
</div>
<a id="a85ccda5e0946fd375c03458a90f65c25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85ccda5e0946fd375c03458a90f65c25">&#9670;&nbsp;</a></span>Butterworth() <span class="overload">[4/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mspass::algorithms::Butterworth::Butterworth </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>zerophase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>enable_lo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>enable_hi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>npolelo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>f3dblo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>npolehi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>f3dbhi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>sample_interval</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct by defining corner frequencies and number of npoles. </p>
<p><a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html" title="MsPASS implementation of Butterworth filter as processing object.">Butterworth</a> filters can also be defind by a corner frequency and number of poles. In fact, only the nondimensional form of these parameters are stored as private attributes to define the filter. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">zerophase</td><td>when true use a zerophase filter. When false defines a one pass minimum phase filter. </td></tr>
    <tr><td class="paramname">enable_lo</td><td>is a boolean that when true enables the low band parameters for the filter (i.e. the highpass=low-cut components) </td></tr>
    <tr><td class="paramname">enable_hi</td><td>is a boolean taht when true enables the parameters defining the upper frequency band edge (i.e. lowpass=high-cut parameters) </td></tr>
    <tr><td class="paramname">npolelo</td><td>is the number of poles for the low frequency corner (highpass) </td></tr>
    <tr><td class="paramname">f3dblo</td><td>is the corner frequency for the low frequency corner (highpass) </td></tr>
    <tr><td class="paramname">npolehi</td><td>is the number of poles for the high frequency corner (lowpass) </td></tr>
    <tr><td class="paramname">f3dbhi</td><td>is the corner frequency for the high frequency corner (lowpass) </td></tr>
    <tr><td class="paramname">sample_interval</td><td>is the expected data sample interval </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;{</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    this-&gt;dt=sample_interval;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    this-&gt;zerophase=zero;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    this-&gt;use_lo=locut;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    this-&gt;use_hi=hicut;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    this-&gt;f3db_hi=f3dbhi;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    this-&gt;f3db_lo=f3dblo;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    this-&gt;npoles_lo=npolelo;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    this-&gt;npoles_hi=npolehi;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">/* Convert the frequencies to nondimensional form */</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    this-&gt;f3db_lo *= dt;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    this-&gt;f3db_hi *= dt;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a60c3979ede1947661bb25d118bde228c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60c3979ede1947661bb25d118bde228c">&#9670;&nbsp;</a></span>Butterworth() <span class="overload">[5/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mspass::algorithms::Butterworth::Butterworth </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html">Butterworth</a> &amp;&#160;</td>
          <td class="paramname"><em>parent</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Standard copy conststructor. </p>
<div class="fragment"><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;{</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    use_lo=parent.use_lo;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    use_hi=parent.use_hi;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    zerophase=parent.zerophase;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    f3db_lo=parent.f3db_lo;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    f3db_hi=parent.f3db_hi;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    npoles_lo=parent.npoles_lo;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    npoles_hi=parent.npoles_hi;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    dt=parent.dt;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a76dc3f128a5305ca1b04d863ae72b73b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76dc3f128a5305ca1b04d863ae72b73b">&#9670;&nbsp;</a></span>apply() <span class="overload">[1/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mspass::algorithms::Butterworth::apply </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html">mspass::seismic::CoreSeismogram</a> &amp;&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply the filter to a CoreSeismogram object. </p>
<p>This method alters the data vector inside d in place and changes no other parts of the data. Automatic switching of data sample rate is used on the operator. That is, if the sample rate of the data is different than the operator sample rate the internal operator coefficients will be adjusted to the new sample rate. The operator sample rate will also be changed to the sample rate of d whenever the sample rate changes from the previous call.</p>
<p>This method has a safety to prevent irrational sample rate changes. The IRR filter used to compute a <a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html" title="MsPASS implementation of Butterworth filter as processing object.">Butterworth</a> filter becomes unstable if the low pass filter component (high corner) approach Nyquist or worse exceed Nyquist. This method will throw a MsPASSError exception if the sample rate of d is too low for the filter high corner. (current 90% of Nyquist). When this error is throw the data will be unaltered and the internal sample rate will be left in the previous state.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>input data to be filtered - altered in place. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">throws</td><td>a MsPASSError if the hi corner is inconsistent with the sample rate of d </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;{</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="comment">/* we could just handle a MsPASSError to take care of exceptions</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">    thrown by apply if the sample rate is illegal, but this is more adaptable. */</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">try</span>{</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="keywordtype">double</span> d_dt=d.<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#af31c96c0e2173d7581e1c3a3f8bcfde8">dt</a>();</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="keywordflow">if</span>(this-&gt;dt != d_dt) this-&gt;<a class="code" href="classmspass_1_1algorithms_1_1_butterworth.html#a94f20884465265de735d05946e1cea00">change_dt</a>(d_dt);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <span class="comment">/* We copy each component to this buffer, filter, and then copy</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">        back.  Not as efficient as if we used a strike parameter in the filter</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">        functions, but I did not want to rewrite those functions. */</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        vector&lt;double&gt; comp;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="keywordtype">int</span> npts=d.<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a347b349bb4e1f0e65978dfcd45ae3472">npts</a>();</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        comp.reserve(npts);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="comment">/* This initializes the buffer to allow us a simpler loop from 0 to 2</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">        using the blas function dcopy to handle the skip for a fortran style</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">        array used for storing the 3c data in  u*/</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">auto</span> i=0;i&lt;npts;++i)comp.push_back(0.0);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">auto</span> k=0;k&lt;3;++k)</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            dcopy(npts,d.<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.get_address(k,0),3,&amp;(comp[0]),1);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            this-&gt;<a class="code" href="classmspass_1_1algorithms_1_1_butterworth.html#ad8c696b150ed18bfb3c4060dd884bfe3">apply</a>(comp);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            dcopy(npts,&amp;(comp[0]),1,d.<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.get_address(k,0),3);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        }</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    }<span class="keywordflow">catch</span>(...){<span class="keywordflow">throw</span>;};</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;}</div>
<div class="ttc" id="aclassmspass_1_1algorithms_1_1_butterworth_html_a94f20884465265de735d05946e1cea00"><div class="ttname"><a href="classmspass_1_1algorithms_1_1_butterworth.html#a94f20884465265de735d05946e1cea00">mspass::algorithms::Butterworth::change_dt</a></div><div class="ttdeci">void change_dt(const double dtnew)</div><div class="ttdoc">set the sample interval assumed for input data.</div><div class="ttdef"><b>Definition:</b> Butterworth.h:295</div></div>
<div class="ttc" id="aclassmspass_1_1algorithms_1_1_butterworth_html_ad8c696b150ed18bfb3c4060dd884bfe3"><div class="ttname"><a href="classmspass_1_1algorithms_1_1_butterworth.html#ad8c696b150ed18bfb3c4060dd884bfe3">mspass::algorithms::Butterworth::apply</a></div><div class="ttdeci">void apply(mspass::seismic::CoreTimeSeries &amp;d)</div><div class="ttdoc">pply the filter to a CoreTimeSeries object.</div><div class="ttdef"><b>Definition:</b> Butterworth.cc:256</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_basic_time_series_html_a347b349bb4e1f0e65978dfcd45ae3472"><div class="ttname"><a href="classmspass_1_1seismic_1_1_basic_time_series.html#a347b349bb4e1f0e65978dfcd45ae3472">mspass::seismic::BasicTimeSeries::npts</a></div><div class="ttdeci">size_t npts() const</div><div class="ttdef"><b>Definition:</b> BasicTimeSeries.h:188</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_basic_time_series_html_af31c96c0e2173d7581e1c3a3f8bcfde8"><div class="ttname"><a href="classmspass_1_1seismic_1_1_basic_time_series.html#af31c96c0e2173d7581e1c3a3f8bcfde8">mspass::seismic::BasicTimeSeries::dt</a></div><div class="ttdeci">double dt() const</div><div class="ttdef"><b>Definition:</b> BasicTimeSeries.h:162</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_core_seismogram_html_a9ac5c7c060d582b1a399fb066d06779f"><div class="ttname"><a href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">mspass::seismic::CoreSeismogram::u</a></div><div class="ttdeci">mspass::utility::dmatrix u</div><div class="ttdef"><b>Definition:</b> CoreSeismogram.h:53</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#af31c96c0e2173d7581e1c3a3f8bcfde8">mspass::seismic::BasicTimeSeries::dt()</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a347b349bb4e1f0e65978dfcd45ae3472">mspass::seismic::BasicTimeSeries::npts()</a>, and <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">mspass::seismic::CoreSeismogram::u</a>.</p>

</div>
</div>
<a id="ad8c696b150ed18bfb3c4060dd884bfe3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8c696b150ed18bfb3c4060dd884bfe3">&#9670;&nbsp;</a></span>apply() <span class="overload">[2/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mspass::algorithms::Butterworth::apply </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmspass_1_1seismic_1_1_core_time_series.html">mspass::seismic::CoreTimeSeries</a> &amp;&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>pply the filter to a CoreTimeSeries object. </p>
<p>This method alters the data vector inside d in place and changes no other parts of the data. Automatic switching of data sample rate is used on the operator. That is, if the sample rate of the data is different than the operator sample rate the internal operator coefficients will be adjusted to the new sample rate. The operator sample rate will also be changed to the sample rate of d whenever the sample rate changes from the previous call.</p>
<p>This method has a safety to prevent irrational sample rate changes. The IRR filter used to compute a <a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html" title="MsPASS implementation of Butterworth filter as processing object.">Butterworth</a> filter becomes unstable if the low pass filter component (high corner) approach Nyquist or worse exceed Nyquist. This method will throw a MsPASSError exception if the sample rate of d is too low for the filter high corner. (current 90% of Nyquist). When this error is throw the data will be unaltered and the internal sample rate will be left in the previous state.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>input data to be filtered - altered in place. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">throws</td><td>a MsPASSError if the hi corner is inconsistent with the sample rate of d </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;{</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordtype">double</span> d_dt=d.<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#af31c96c0e2173d7581e1c3a3f8bcfde8">dt</a>();</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">if</span>(this-&gt;dt != d_dt)</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="comment">/* Here we throw an exception if a requested sample rate is</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">        illegal */</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="keywordtype">double</span> fhtest=d_dt/(this-&gt;dt);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keywordflow">if</span>(fhtest&gt;FHighFloor)</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            stringstream ss;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            ss &lt;&lt; <span class="stringliteral">&quot;Butterworth::apply:  automatic dt change error&quot;</span>&lt;&lt;endl</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;Current operator dt=&quot;</span>&lt;&lt;this-&gt;dt&lt;&lt;<span class="stringliteral">&quot; data dt=&quot;</span>&lt;&lt;d_dt&lt;&lt;endl</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;Change would produce a corner too close to Nyquist&quot;</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; and create an unstable filter&quot;</span>&lt;&lt;endl</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;Use a different filter operator for data with this sample rate&quot;</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                &lt;&lt; endl;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classmspass_1_1utility_1_1_ms_p_a_s_s_error.html">MsPASSError</a>(ss.str(),ErrorSeverity::Invalid);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        this-&gt;<a class="code" href="classmspass_1_1algorithms_1_1_butterworth.html#a94f20884465265de735d05946e1cea00">change_dt</a>(d_dt);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    this-&gt;<a class="code" href="classmspass_1_1algorithms_1_1_butterworth.html#ad8c696b150ed18bfb3c4060dd884bfe3">apply</a>(d.<a class="code" href="classmspass_1_1seismic_1_1_core_time_series.html#ab044edb3fe5fe734cb577a4434f390a2">s</a>);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;}</div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_core_time_series_html_ab044edb3fe5fe734cb577a4434f390a2"><div class="ttname"><a href="classmspass_1_1seismic_1_1_core_time_series.html#ab044edb3fe5fe734cb577a4434f390a2">mspass::seismic::CoreTimeSeries::s</a></div><div class="ttdeci">std::vector&lt; double &gt; s</div><div class="ttdef"><b>Definition:</b> CoreTimeSeries.h:28</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#af31c96c0e2173d7581e1c3a3f8bcfde8">mspass::seismic::BasicTimeSeries::dt()</a>, and <a class="el" href="classmspass_1_1seismic_1_1_core_time_series.html#ab044edb3fe5fe734cb577a4434f390a2">mspass::seismic::CoreTimeSeries::s</a>.</p>

</div>
</div>
<a id="abb8d56355bb2b23cbf7e96b0b2fa7b24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb8d56355bb2b23cbf7e96b0b2fa7b24">&#9670;&nbsp;</a></span>apply() <span class="overload">[3/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mspass::algorithms::Butterworth::apply </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmspass_1_1seismic_1_1_seismogram.html">mspass::seismic::Seismogram</a> &amp;&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply the filter to a CoreTimeSeries object. </p>
<p>This method alters the data vector inside d in place and changes no other parts of the data. Automatic switching of data sample rate is used on the operator. That is, if the sample rate of the data is different than the operator sample rate the internal operator coefficients will be adjusted to the new sample rate. The operator sample rate will also be changed to the sample rate of d whenever the sample rate changes from the previous call.</p>
<p>This method has a safety to prevent irrational sample rate changes. The IRR filter used to compute a <a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html" title="MsPASS implementation of Butterworth filter as processing object.">Butterworth</a> filter becomes unstable if the low pass filter component (high corner) approach Nyquist or worse exceed Nyquist. This method will automatically disable the high corner (lowpass) component of the filter if the corner approaches or exceed Nyquist. When that happens the internal sample rate is restored to the previous value and a complaint message is posted to elog of d.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>input data to be filtered - altered in place. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">none,but</td><td>callers should consider checking for errors posted to elog </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;{</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordtype">double</span> d_dt=d.<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#af31c96c0e2173d7581e1c3a3f8bcfde8">dt</a>();</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">if</span>(this-&gt;dt != d_dt)</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="comment">/* Here we throw an exception if a requested sample rate is</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">        illegal */</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <span class="keywordtype">double</span> fhtest=d_dt/(this-&gt;dt);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <span class="keywordflow">if</span>(use_hi &amp;&amp; (fhtest&gt;FHighFloor))</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            <span class="comment">/*In this case we temporarily disable the upper corner and</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">            cache the old dt to restore it before returning. */</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            <span class="keywordtype">double</span> olddt=this-&gt;dt;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            <span class="keywordtype">double</span> flow_old=this-&gt;f3db_lo;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            use_hi=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            this-&gt;<a class="code" href="classmspass_1_1algorithms_1_1_butterworth.html#ad8c696b150ed18bfb3c4060dd884bfe3">apply</a>(d);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            use_hi=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            this-&gt;dt=olddt;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            this-&gt;f3db_lo=flow_old;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            stringstream ss;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            ss &lt;&lt;<span class="stringliteral">&quot;Auto adjust for sample rate change error&quot;</span>&lt;&lt;endl</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;Upper corner of filter=&quot;</span>&lt;&lt;this-&gt;<a class="code" href="classmspass_1_1algorithms_1_1_butterworth.html#acae23f17a07efa21effb10a9da730f33">high_corner</a>()</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; is near or above Nyquist frequency for requested sample &quot;</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;interval=&quot;</span>&lt;&lt;this-&gt;dt&lt;&lt;endl</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;Disabling upper corner (lowpass) and applying filter anyway&quot;</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                &lt;&lt;endl;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            d.elog.<a class="code" href="classmspass_1_1utility_1_1_error_logger.html#aa69873ba0aebf67e9ba24d01992c0bcf">log_error</a>(<span class="keywordtype">string</span>(<span class="stringliteral">&quot;Butterworth::apply&quot;</span>),</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;               ss.str(),ErrorSeverity::Complaint);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            <span class="comment">/* With this logic we have separate return here */</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        }</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            this-&gt;<a class="code" href="classmspass_1_1algorithms_1_1_butterworth.html#a94f20884465265de735d05946e1cea00">change_dt</a>(d_dt);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        }</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    }</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    vector&lt;double&gt; comp;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordtype">int</span> npts=d.<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a347b349bb4e1f0e65978dfcd45ae3472">npts</a>();</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    comp.reserve(npts);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="comment">/* This initializes the buffer to allow us a simpler loop from 0 to 2</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">    using the blas function dcopy to handle the skip for a fortran style</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">    array used for storing the 3c data in  u*/</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordflow">for</span>(<span class="keyword">auto</span> i=0;i&lt;npts;++i)comp.push_back(0.0);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordflow">for</span>(<span class="keyword">auto</span> k=0;k&lt;3;++k)</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        dcopy(npts,d.<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.get_address(k,0),3,&amp;(comp[0]),1);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        this-&gt;<a class="code" href="classmspass_1_1algorithms_1_1_butterworth.html#ad8c696b150ed18bfb3c4060dd884bfe3">apply</a>(comp);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        dcopy(npts,&amp;(comp[0]),1,d.<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.get_address(k,0),3);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;}</div>
<div class="ttc" id="aclassmspass_1_1algorithms_1_1_butterworth_html_acae23f17a07efa21effb10a9da730f33"><div class="ttname"><a href="classmspass_1_1algorithms_1_1_butterworth.html#acae23f17a07efa21effb10a9da730f33">mspass::algorithms::Butterworth::high_corner</a></div><div class="ttdeci">double high_corner() const</div><div class="ttdef"><b>Definition:</b> Butterworth.h:307</div></div>
<div class="ttc" id="aclassmspass_1_1utility_1_1_error_logger_html_aa69873ba0aebf67e9ba24d01992c0bcf"><div class="ttname"><a href="classmspass_1_1utility_1_1_error_logger.html#aa69873ba0aebf67e9ba24d01992c0bcf">mspass::utility::ErrorLogger::log_error</a></div><div class="ttdeci">int log_error(const mspass::utility::MsPASSError &amp;merr)</div><div class="ttdef"><b>Definition:</b> ErrorLogger.cc:81</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#af31c96c0e2173d7581e1c3a3f8bcfde8">mspass::seismic::BasicTimeSeries::dt()</a>, <a class="el" href="classmspass_1_1utility_1_1_error_logger.html#aa69873ba0aebf67e9ba24d01992c0bcf">mspass::utility::ErrorLogger::log_error()</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a347b349bb4e1f0e65978dfcd45ae3472">mspass::seismic::BasicTimeSeries::npts()</a>, and <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">mspass::seismic::CoreSeismogram::u</a>.</p>

</div>
</div>
<a id="a10c30a560e4dce8a3bc9fe80409cee80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10c30a560e4dce8a3bc9fe80409cee80">&#9670;&nbsp;</a></span>apply() <span class="overload">[4/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mspass::algorithms::Butterworth::apply </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmspass_1_1seismic_1_1_time_series.html">mspass::seismic::TimeSeries</a> &amp;&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply the filter to a CoreTimeSeries object. </p>
<p>This method alters the data vector inside d in place and changes no other parts of the data. Automatic switching of data sample rate is used on the operator. That is, if the sample rate of the data is different than the operator sample rate the internal operator coefficients will be adjusted to the new sample rate. The operator sample rate will also be changed to the sample rate of d whenever the sample rate changes from the previous call.</p>
<p>This method has a safety to prevent irrational sample rate changes. The IRR filter used to compute a <a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html" title="MsPASS implementation of Butterworth filter as processing object.">Butterworth</a> filter becomes unstable if the low pass filter component (high corner) approach Nyquist or worse exceed Nyquist. This method will automatically disable the high corner (lowpass) component of the filter if the corner approaches or exceed Nyquist. When that happens the internal sample rate is restored to the previous value and a complaint message is posted to elog of d.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>input data to be filtered - altered in place. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">none,but</td><td>callers should consider checking for errors posted to elog </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;{</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordtype">double</span> d_dt=d.<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#af31c96c0e2173d7581e1c3a3f8bcfde8">dt</a>();</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">if</span>(this-&gt;dt != d_dt)</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="comment">/* Here we throw an exception if a requested sample rate is</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">        illegal */</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="keywordtype">double</span> fhtest=d_dt/(this-&gt;dt);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="keywordflow">if</span>(use_hi &amp;&amp; (fhtest&gt;FHighFloor))</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            <span class="comment">/*In this case we temporarily disable the upper corner and</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">            cache the old dt to restore it before returning. */</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            <span class="keywordtype">double</span> olddt=this-&gt;dt;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            <span class="keywordtype">double</span> flow_old=this-&gt;f3db_lo;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            use_hi=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            this-&gt;<a class="code" href="classmspass_1_1algorithms_1_1_butterworth.html#ad8c696b150ed18bfb3c4060dd884bfe3">apply</a>(d.<a class="code" href="classmspass_1_1seismic_1_1_core_time_series.html#ab044edb3fe5fe734cb577a4434f390a2">s</a>);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            use_hi=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            this-&gt;dt=olddt;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            this-&gt;f3db_lo=flow_old;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            stringstream ss;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            ss &lt;&lt;<span class="stringliteral">&quot;Auto adjust for sample rate change error&quot;</span>&lt;&lt;endl</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;Upper corner of filter=&quot;</span>&lt;&lt;this-&gt;<a class="code" href="classmspass_1_1algorithms_1_1_butterworth.html#acae23f17a07efa21effb10a9da730f33">high_corner</a>()</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; is near or above Nyquist frequency for requested sample &quot;</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;interval=&quot;</span>&lt;&lt;this-&gt;dt&lt;&lt;endl</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;Disabling upper corner (lowpass) and applying filter anyway&quot;</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                &lt;&lt;endl;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            d.elog.<a class="code" href="classmspass_1_1utility_1_1_error_logger.html#aa69873ba0aebf67e9ba24d01992c0bcf">log_error</a>(<span class="keywordtype">string</span>(<span class="stringliteral">&quot;Butterworth::apply&quot;</span>),</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                      ss.str(),ErrorSeverity::Complaint);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <span class="comment">/* With this logic we have separate return here */</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            this-&gt;<a class="code" href="classmspass_1_1algorithms_1_1_butterworth.html#a94f20884465265de735d05946e1cea00">change_dt</a>(d_dt);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        }</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    }</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    this-&gt;<a class="code" href="classmspass_1_1algorithms_1_1_butterworth.html#ad8c696b150ed18bfb3c4060dd884bfe3">apply</a>(d.<a class="code" href="classmspass_1_1seismic_1_1_core_time_series.html#ab044edb3fe5fe734cb577a4434f390a2">s</a>);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#af31c96c0e2173d7581e1c3a3f8bcfde8">mspass::seismic::BasicTimeSeries::dt()</a>, <a class="el" href="classmspass_1_1utility_1_1_error_logger.html#aa69873ba0aebf67e9ba24d01992c0bcf">mspass::utility::ErrorLogger::log_error()</a>, and <a class="el" href="classmspass_1_1seismic_1_1_core_time_series.html#ab044edb3fe5fe734cb577a4434f390a2">mspass::seismic::CoreTimeSeries::s</a>.</p>

</div>
</div>
<a id="a1b2416893b09cf7edad320a37c521c5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b2416893b09cf7edad320a37c521c5a">&#9670;&nbsp;</a></span>apply() <span class="overload">[5/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mspass::algorithms::Butterworth::apply </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Filter a raw vector of data. </p>
<p>Use this method to apply the filter to a raw vector of data. The C++ interface uses an std::vector container, but the python api in MsPASS allows this to be a double numpy array or any iterable version of a vector container (meaning storage as a contiguous block of memory). If this method is used it is assumed the sample interval defined for the operator is the same as the for the input data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>is the data to be filtered (note the data are altered in place) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a94f20884465265de735d05946e1cea00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94f20884465265de735d05946e1cea00">&#9670;&nbsp;</a></span>change_dt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void mspass::algorithms::Butterworth::change_dt </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>dtnew</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>set the sample interval assumed for input data. </p>
<p>This function can be used when running with raw data vectors if the sample interval of the data series is different from that called on construction or set previously. This is a nontrivial change because the filter coefficients depend upon sample interval. In particular, for this implementation npoles and the 3db frequency points stored internally are altered when this function is called. If the frequency intervals change the expectation is the user will create a new instance of this object.</p>
<p>Warning: this routine does not implement the safeties built into TimeSeries and Seismogram apply methods. It will silently change the upper corner to an unstable position if called inappropriately.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dtnew</td><td>is the new sample interval to set for the operator. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    this-&gt;f3db_lo *= (dtnew/(this-&gt;dt));</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    this-&gt;f3db_hi *= (dtnew/(this-&gt;dt));</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    this-&gt;dt=dtnew;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  };</div>
</div><!-- fragment -->
</div>
</div>
<a id="acb651e7aa0adb9f27cb32fbf14afeb29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb651e7aa0adb9f27cb32fbf14afeb29">&#9670;&nbsp;</a></span>current_dt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double mspass::algorithms::Butterworth::current_dt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return the current operator sample interval. </p>
<div class="fragment"><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;{<span class="keywordflow">return</span> dt;};</div>
</div><!-- fragment -->
</div>
</div>
<a id="a446ac405d71fddd4adbd9d2a9722e331"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a446ac405d71fddd4adbd9d2a9722e331">&#9670;&nbsp;</a></span>filter_type()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string mspass::algorithms::Butterworth::filter_type </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return a string defining the type of operator this filter defines. Currently can be one of the following: bandpass, lowpass, or highpass. It is possible to construct a band reject filter with the right constructor, but the implementation of this method will not detect that condition. A band reject filter will be incorrectly tagged bandpass. The algorithm just looks to see which of the band edges are defined (the hi and lo concepts described above) and guesses the filter type. If both are off it returns "Undefined". </p>
<div class="fragment"><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordflow">if</span>(use_lo)</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="keywordflow">if</span>(use_hi)</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="keywordflow">return</span> std::string(<span class="stringliteral">&quot;bandpass&quot;</span>);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="keywordflow">return</span> std::string(<span class="stringliteral">&quot;highpass&quot;</span>);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    }</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <span class="keywordflow">if</span>(use_hi)</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="keywordflow">return</span> std::string(<span class="stringliteral">&quot;lowpass&quot;</span>);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="keywordflow">return</span> std::string(<span class="stringliteral">&quot;Undefined&quot;</span>);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    }</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  };</div>
</div><!-- fragment -->
</div>
</div>
<a id="acae23f17a07efa21effb10a9da730f33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acae23f17a07efa21effb10a9da730f33">&#9670;&nbsp;</a></span>high_corner()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double mspass::algorithms::Butterworth::high_corner </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return the high frequency 3db corner (in Hz). </p>
<div class="fragment"><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordflow">return</span> f3db_hi/dt;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7b54d5d5966a85092d45ebebd0b88498"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b54d5d5966a85092d45ebebd0b88498">&#9670;&nbsp;</a></span>impulse_response()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmspass_1_1seismic_1_1_core_time_series.html">CoreTimeSeries</a> mspass::algorithms::Butterworth::impulse_response </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the impulse response. </p>
<p>The response of a linear filter like the butterworth filter can always be described by either the time domain impulse response or its fourier transform commonly called the tranfer function. This function returns the impulse response centered in a time window with a specified number of samples using the current sample interval cached in the object. Note the return has dt and the impulse is at the center of the data window (n/2) with t0 set so the functions zero is correct if using the implict time scale (time method) of a time series object.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>is the number of samples to generate to characterize the impulse response. The function is always returned centered on the vector of length n and t0 of the TimeSeries is set to make that impulse point be time 0. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;{</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <a class="code" href="classmspass_1_1seismic_1_1_core_time_series.html">CoreTimeSeries</a> result(n);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">/* We use a feature that the above constructor initiallizes the buffer</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">    to zeros so just a spike at n/2. */</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    result.s[n/2]=1.0;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    result.set_t0( ((<span class="keywordtype">double</span>)(-n/2))*(this-&gt;dt) );</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    result.set_dt(this-&gt;dt);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    result.set_tref(TimeReferenceType::Relative);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    result.set_live();</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    this-&gt;<a class="code" href="classmspass_1_1algorithms_1_1_butterworth.html#ad8c696b150ed18bfb3c4060dd884bfe3">apply</a>(result.s);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  result.s = normalize&lt;double&gt;(result.s);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;}</div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_core_time_series_html"><div class="ttname"><a href="classmspass_1_1seismic_1_1_core_time_series.html">mspass::seismic::CoreTimeSeries</a></div><div class="ttdoc">Scalar time series data object.</div><div class="ttdef"><b>Definition:</b> CoreTimeSeries.h:18</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1seismic_1_1_core_time_series.html#ab044edb3fe5fe734cb577a4434f390a2">mspass::seismic::CoreTimeSeries::s</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_time_series.html#a97ff6732aa816b0c327c5bf667ffe841">mspass::seismic::CoreTimeSeries::set_dt()</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a1ca7ba8bcd8337bd49d438664e74966d">mspass::seismic::BasicTimeSeries::set_live()</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_time_series.html#ae90b28cff0bc1997aa65a1693d8562d0">mspass::seismic::CoreTimeSeries::set_t0()</a>, and <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#ac3f8c8200710fe0d3ef211c7c758e864">mspass::seismic::BasicTimeSeries::set_tref()</a>.</p>

</div>
</div>
<a id="a9014cb292cb1c7ca452c80c5cb330b43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9014cb292cb1c7ca452c80c5cb330b43">&#9670;&nbsp;</a></span>is_zerophase()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool mspass::algorithms::Butterworth::is_zerophase </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return true if the filter is defined as a zero phase filter. Returns false if it is minimum phase. </p>
<div class="fragment"><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keywordflow">return</span> zerophase;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a98d5b940b443524dbe317ae6b0efb1a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98d5b940b443524dbe317ae6b0efb1a3">&#9670;&nbsp;</a></span>low_corner()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double mspass::algorithms::Butterworth::low_corner </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return the low frequency 3db corner (in Hz). </p>
<div class="fragment"><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordflow">return</span> f3db_lo/dt;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a094f40b3c1d1ff857f696f19d0f85026"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a094f40b3c1d1ff857f696f19d0f85026">&#9670;&nbsp;</a></span>npoles_high()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int mspass::algorithms::Butterworth::npoles_high </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return the number of poles defining the lowpass (highcut) element of the filter. </p>
<div class="fragment"><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;{<span class="keywordflow">return</span> npoles_hi;};</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2b528a200c2b56f9420a5f29fb706d3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b528a200c2b56f9420a5f29fb706d3c">&#9670;&nbsp;</a></span>npoles_low()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int mspass::algorithms::Butterworth::npoles_low </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return the number of poles defining the highpass (lowcut) element of the filter. </p>
<div class="fragment"><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;{<span class="keywordflow">return</span> npoles_lo;};</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7602075f3fe8f56e891331c98264d1a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7602075f3fe8f56e891331c98264d1a5">&#9670;&nbsp;</a></span>operator=()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html">Butterworth</a> &amp; mspass::algorithms::Butterworth::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmspass_1_1algorithms_1_1_butterworth.html">Butterworth</a> &amp;&#160;</td>
          <td class="paramname"><em>parent</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Standard assignment operator. </p>
<div class="fragment"><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;{</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">if</span>(<span class="keyword">this</span> != &amp;parent)</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        use_lo=parent.use_lo;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        use_hi=parent.use_hi;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        zerophase=parent.zerophase;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        f3db_lo=parent.f3db_lo;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        f3db_hi=parent.f3db_hi;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        npoles_lo=parent.npoles_lo;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        npoles_hi=parent.npoles_hi;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        dt=parent.dt;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a54e766697f72f1ba38b95915805dd6d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54e766697f72f1ba38b95915805dd6d9">&#9670;&nbsp;</a></span>transfer_function()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmspass_1_1algorithms_1_1deconvolution_1_1_complex_array.html">ComplexArray</a> mspass::algorithms::Butterworth::transfer_function </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the response of the filter in the frequency domain. </p>
<p>The impulse response of any linear system can always be characterized by either the time domain response to spike signal or the alternative frequency domain version of the same function commonly called the transfer function. This method returns the transfer funtion as a <a class="el" href="classmspass_1_1algorithms_1_1deconvolution_1_1_complex_array.html">mspass::algorithms::deconvolution::ComplexArray</a> container. Use methods in that object to get amplitude and phase response functions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>is the number of points that should be used to characterize the transfer function. Note because we are dealing with strictly real valued signals the array returned will be folded at the Nyquist frequency in the standard way of all FFT implementations (current implementation uses the fft in the gnu scientific library that definitely does that). </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;{</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <a class="code" href="classmspass_1_1seismic_1_1_core_time_series.html">CoreTimeSeries</a> imp=this-&gt;<a class="code" href="classmspass_1_1algorithms_1_1_butterworth.html#a7b54d5d5966a85092d45ebebd0b88498">impulse_response</a>(nfft);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="comment">/* the impulse response function uses a time shift and sets t0 to the</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">    required position.  A disconnect with any fft is that will introduce an</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">    undesirable phase shift for many algorithms.  We remove it here using our</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">    circular shift function */</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordtype">int</span> ishift=imp.<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#abe28ca2812a2ac21dd2196385ad106ab">sample_number</a>(0.0);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    imp.<a class="code" href="classmspass_1_1seismic_1_1_core_time_series.html#ab044edb3fe5fe734cb577a4434f390a2">s</a>=circular_shift(imp.<a class="code" href="classmspass_1_1seismic_1_1_core_time_series.html#ab044edb3fe5fe734cb577a4434f390a2">s</a>,ishift);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    gsl_fft_complex_wavetable *wavetable = gsl_fft_complex_wavetable_alloc (nfft);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    gsl_fft_complex_workspace *workspace = gsl_fft_complex_workspace_alloc (nfft);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <a class="code" href="classmspass_1_1algorithms_1_1deconvolution_1_1_complex_array.html">ComplexArray</a> work(nfft,imp.<a class="code" href="classmspass_1_1seismic_1_1_core_time_series.html#ab044edb3fe5fe734cb577a4434f390a2">s</a>);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    gsl_fft_complex_forward(work.ptr(), 1, nfft, wavetable, workspace);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    gsl_fft_complex_wavetable_free (wavetable);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    gsl_fft_complex_workspace_free (workspace);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">return</span> work;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;}</div>
<div class="ttc" id="aclassmspass_1_1algorithms_1_1_butterworth_html_a7b54d5d5966a85092d45ebebd0b88498"><div class="ttname"><a href="classmspass_1_1algorithms_1_1_butterworth.html#a7b54d5d5966a85092d45ebebd0b88498">mspass::algorithms::Butterworth::impulse_response</a></div><div class="ttdeci">mspass::seismic::CoreTimeSeries impulse_response(const int n)</div><div class="ttdoc">Return the impulse response.</div><div class="ttdef"><b>Definition:</b> Butterworth.cc:240</div></div>
<div class="ttc" id="aclassmspass_1_1algorithms_1_1deconvolution_1_1_complex_array_html"><div class="ttname"><a href="classmspass_1_1algorithms_1_1deconvolution_1_1_complex_array.html">mspass::algorithms::deconvolution::ComplexArray</a></div><div class="ttdef"><b>Definition:</b> ComplexArray.h:40</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_basic_time_series_html_abe28ca2812a2ac21dd2196385ad106ab"><div class="ttname"><a href="classmspass_1_1seismic_1_1_basic_time_series.html#abe28ca2812a2ac21dd2196385ad106ab">mspass::seismic::BasicTimeSeries::sample_number</a></div><div class="ttdeci">int sample_number(double t) const</div><div class="ttdef"><b>Definition:</b> BasicTimeSeries.h:74</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1seismic_1_1_core_time_series.html#ab044edb3fe5fe734cb577a4434f390a2">mspass::seismic::CoreTimeSeries::s</a>, and <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#abe28ca2812a2ac21dd2196385ad106ab">mspass::seismic::BasicTimeSeries::sample_number()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/runner/work/mspass/mspass/cxx/include/mspass/algorithms/<a class="el" href="_butterworth_8h_source.html">Butterworth.h</a></li>
<li>/home/runner/work/mspass/mspass/cxx/src/lib/algorithms/Butterworth.cc</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
