<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MsPASS C++ API: mspass::seismic::CoreSeismogram Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script src="striped_bg.js"></script>
<link href="that_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> version
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
   <div id="projectbrief">Defines the C++ API for MsPASS</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>mspass</b></li><li class="navelem"><a class="el" href="namespacemspass_1_1seismic.html">seismic</a></li><li class="navelem"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html">CoreSeismogram</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classmspass_1_1seismic_1_1_core_seismogram-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">mspass::seismic::CoreSeismogram Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Vector (three-component) seismogram data object.  
 <a href="classmspass_1_1seismic_1_1_core_seismogram.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_core_seismogram_8h_source.html">CoreSeismogram.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for mspass::seismic::CoreSeismogram:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classmspass_1_1seismic_1_1_core_seismogram.png" usemap="#mspass::seismic::CoreSeismogram_map" alt=""/>
  <map id="mspass::seismic::CoreSeismogram_map" name="mspass::seismic::CoreSeismogram_map">
<area href="classmspass_1_1seismic_1_1_basic_time_series.html" title="Base class for time series objects." alt="mspass::seismic::BasicTimeSeries" shape="rect" coords="0,56,214,80"/>
<area href="classmspass_1_1utility_1_1_metadata.html" alt="mspass::utility::Metadata" shape="rect" coords="224,56,438,80"/>
<area href="classmspass_1_1utility_1_1_basic_metadata.html" title="Abstract base class for Metadata concept." alt="mspass::utility::BasicMetadata" shape="rect" coords="224,0,438,24"/>
<area href="classmspass_1_1seismic_1_1_seismogram.html" title="Implemntation of Seismogram for MsPASS." alt="mspass::seismic::Seismogram" shape="rect" coords="112,168,326,192"/>
<area href="classmspass_1_1seismic_1_1_seismogram_w_gaps.html" alt="mspass::seismic::SeismogramWGaps" shape="rect" coords="112,224,326,248"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a9be7b3811cfcd0b0396b32214d7eab51"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9be7b3811cfcd0b0396b32214d7eab51">CoreSeismogram</a> ()</td></tr>
<tr class="separator:a9be7b3811cfcd0b0396b32214d7eab51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88d2aa5099488eb2cbdbd1188c81339e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a88d2aa5099488eb2cbdbd1188c81339e">CoreSeismogram</a> (const size_t nsamples)</td></tr>
<tr class="separator:a88d2aa5099488eb2cbdbd1188c81339e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c7307434dac26ca63ac423b55ecb5ec"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a8c7307434dac26ca63ac423b55ecb5ec">CoreSeismogram</a> (const std::vector&lt; <a class="el" href="classmspass_1_1seismic_1_1_core_time_series.html">mspass::seismic::CoreTimeSeries</a> &gt; &amp;ts, const unsigned int component_to_clone=0)</td></tr>
<tr class="separator:a8c7307434dac26ca63ac423b55ecb5ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67232df3f9d1e1b5ac245f97478adee9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a67232df3f9d1e1b5ac245f97478adee9">CoreSeismogram</a> (const <a class="el" href="classmspass_1_1utility_1_1_metadata.html">mspass::utility::Metadata</a> &amp;md, const bool load_data=true)</td></tr>
<tr class="memdesc:a67232df3f9d1e1b5ac245f97478adee9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct from Metadata definition that includes data path.  <a href="classmspass_1_1seismic_1_1_core_seismogram.html#a67232df3f9d1e1b5ac245f97478adee9">More...</a><br /></td></tr>
<tr class="separator:a67232df3f9d1e1b5ac245f97478adee9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c993726c259d7a6f1c213d0d04db5ba"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9c993726c259d7a6f1c213d0d04db5ba">CoreSeismogram</a> (const <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html">CoreSeismogram</a> &amp;)</td></tr>
<tr class="separator:a9c993726c259d7a6f1c213d0d04db5ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e51c2c6d3a1aa02281ba242a1d15bf2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a5e51c2c6d3a1aa02281ba242a1d15bf2">set_dt</a> (const double sample_interval)</td></tr>
<tr class="memdesc:a5e51c2c6d3a1aa02281ba242a1d15bf2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the sample interval.  <a href="classmspass_1_1seismic_1_1_core_seismogram.html#a5e51c2c6d3a1aa02281ba242a1d15bf2">More...</a><br /></td></tr>
<tr class="separator:a5e51c2c6d3a1aa02281ba242a1d15bf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae94bac250fe5928ced41babc322c2c79"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#ae94bac250fe5928ced41babc322c2c79">set_npts</a> (const size_t <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a347b349bb4e1f0e65978dfcd45ae3472">npts</a>)</td></tr>
<tr class="memdesc:ae94bac250fe5928ced41babc322c2c79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the number of samples attribute for data.  <a href="classmspass_1_1seismic_1_1_core_seismogram.html#ae94bac250fe5928ced41babc322c2c79">More...</a><br /></td></tr>
<tr class="separator:ae94bac250fe5928ced41babc322c2c79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a629ae308ad656912abd32d086730f35d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a629ae308ad656912abd32d086730f35d">sync_npts</a> ()</td></tr>
<tr class="memdesc:a629ae308ad656912abd32d086730f35d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sync the number of samples attribute with actual data size.  <a href="classmspass_1_1seismic_1_1_core_seismogram.html#a629ae308ad656912abd32d086730f35d">More...</a><br /></td></tr>
<tr class="separator:a629ae308ad656912abd32d086730f35d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7724b7cfa40eebf0b15e0d2b39ae615e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7724b7cfa40eebf0b15e0d2b39ae615e">set_t0</a> (const double t0in)</td></tr>
<tr class="memdesc:a7724b7cfa40eebf0b15e0d2b39ae615e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the data start time.  <a href="classmspass_1_1seismic_1_1_core_seismogram.html#a7724b7cfa40eebf0b15e0d2b39ae615e">More...</a><br /></td></tr>
<tr class="separator:a7724b7cfa40eebf0b15e0d2b39ae615e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa906f3915cfd8ba04adefedc35032e7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html">CoreSeismogram</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#aaa906f3915cfd8ba04adefedc35032e7">operator=</a> (const <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html">CoreSeismogram</a> &amp;)</td></tr>
<tr class="separator:aaa906f3915cfd8ba04adefedc35032e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4824e03f8697c3f36fa7957bb82e122c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html">CoreSeismogram</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a4824e03f8697c3f36fa7957bb82e122c">operator+=</a> (const <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html">CoreSeismogram</a> &amp;d)</td></tr>
<tr class="memdesc:a4824e03f8697c3f36fa7957bb82e122c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Summation operator.  <a href="classmspass_1_1seismic_1_1_core_seismogram.html#a4824e03f8697c3f36fa7957bb82e122c">More...</a><br /></td></tr>
<tr class="separator:a4824e03f8697c3f36fa7957bb82e122c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0254f287fe5fb2217fcda0131b65410f"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html">CoreSeismogram</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a0254f287fe5fb2217fcda0131b65410f">operator+</a> (const <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html">CoreSeismogram</a> &amp;other) const</td></tr>
<tr class="separator:a0254f287fe5fb2217fcda0131b65410f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb19d36d0e3ed2e52eb77da34c65f4f3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html">CoreSeismogram</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#acb19d36d0e3ed2e52eb77da34c65f4f3">operator*=</a> (const double)</td></tr>
<tr class="separator:acb19d36d0e3ed2e52eb77da34c65f4f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af749235404f3cf11808598ef133bf781"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html">CoreSeismogram</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#af749235404f3cf11808598ef133bf781">operator-=</a> (const <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html">CoreSeismogram</a> &amp;d)</td></tr>
<tr class="memdesc:af749235404f3cf11808598ef133bf781"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subtraction operator.  <a href="classmspass_1_1seismic_1_1_core_seismogram.html#af749235404f3cf11808598ef133bf781">More...</a><br /></td></tr>
<tr class="separator:af749235404f3cf11808598ef133bf781"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac44e27ef57299045b2e0c7a252e32a89"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html">CoreSeismogram</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#ac44e27ef57299045b2e0c7a252e32a89">operator-</a> (const <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html">CoreSeismogram</a> &amp;other) const</td></tr>
<tr class="separator:ac44e27ef57299045b2e0c7a252e32a89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b8fc85ca5a5e14d2e2cdd51a9697fcc"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a1b8fc85ca5a5e14d2e2cdd51a9697fcc">operator[]</a> (const int sample) const</td></tr>
<tr class="separator:a1b8fc85ca5a5e14d2e2cdd51a9697fcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdf52d3336018194da73d6832150169d"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#abdf52d3336018194da73d6832150169d">operator[]</a> (const double <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a438b4f6453a4ff2a46de53dfdf3599c2">time</a>) const</td></tr>
<tr class="memdesc:abdf52d3336018194da73d6832150169d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Overloaded version of operator[] for time.  <a href="classmspass_1_1seismic_1_1_core_seismogram.html#abdf52d3336018194da73d6832150169d">More...</a><br /></td></tr>
<tr class="separator:abdf52d3336018194da73d6832150169d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22f733f1d159422844f3091450813445"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a22f733f1d159422844f3091450813445">~CoreSeismogram</a> ()</td></tr>
<tr class="separator:a22f733f1d159422844f3091450813445"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a756ee542caaa6001f9f40fed3607ff7e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a756ee542caaa6001f9f40fed3607ff7e">rotate_to_standard</a> ()</td></tr>
<tr class="separator:a756ee542caaa6001f9f40fed3607ff7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab52a292c7c7bc8fc5fef68db9eb847e0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#ab52a292c7c7bc8fc5fef68db9eb847e0">rotate</a> (<a class="el" href="structmspass_1_1utility_1_1_spherical_coordinate.html">mspass::utility::SphericalCoordinate</a> &amp;sc)</td></tr>
<tr class="separator:ab52a292c7c7bc8fc5fef68db9eb847e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bfacfda2b33e2df7938695126fbb0db"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a8bfacfda2b33e2df7938695126fbb0db">rotate</a> (const double nu[3])</td></tr>
<tr class="separator:a8bfacfda2b33e2df7938695126fbb0db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a895a06c26825e8abe8c8617622cf8d5e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a895a06c26825e8abe8c8617622cf8d5e">rotate</a> (const double phi)</td></tr>
<tr class="memdesc:a895a06c26825e8abe8c8617622cf8d5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate horizontals by a simple angle in degrees.  <a href="classmspass_1_1seismic_1_1_core_seismogram.html#a895a06c26825e8abe8c8617622cf8d5e">More...</a><br /></td></tr>
<tr class="separator:a895a06c26825e8abe8c8617622cf8d5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9ea31f9e36577a51660c61e0749d4a6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#ae9ea31f9e36577a51660c61e0749d4a6">transform</a> (const double a[3][3])</td></tr>
<tr class="separator:ae9ea31f9e36577a51660c61e0749d4a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adccfb78a6ebcdf62039e5cb351566438"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#adccfb78a6ebcdf62039e5cb351566438">free_surface_transformation</a> (const <a class="el" href="classmspass_1_1seismic_1_1_slowness_vector.html">mspass::seismic::SlownessVector</a> <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>, const double vp0, const double vs0)</td></tr>
<tr class="separator:adccfb78a6ebcdf62039e5cb351566438"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae2950b408052bda849ba07c4ea9b018"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmspass_1_1utility_1_1dmatrix.html">mspass::utility::dmatrix</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#aae2950b408052bda849ba07c4ea9b018">get_transformation_matrix</a> () const</td></tr>
<tr class="separator:aae2950b408052bda849ba07c4ea9b018"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94e13495475bfb8c1e62f40006f13bdc"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a94e13495475bfb8c1e62f40006f13bdc">set_transformation_matrix</a> (const <a class="el" href="classmspass_1_1utility_1_1dmatrix.html">mspass::utility::dmatrix</a> &amp;A)</td></tr>
<tr class="memdesc:a94e13495475bfb8c1e62f40006f13bdc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Define the transformaton matrix.  <a href="classmspass_1_1seismic_1_1_core_seismogram.html#a94e13495475bfb8c1e62f40006f13bdc">More...</a><br /></td></tr>
<tr class="separator:a94e13495475bfb8c1e62f40006f13bdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad60b2dca7acfd76ff1f8d677ef609f8a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#ad60b2dca7acfd76ff1f8d677ef609f8a">set_transformation_matrix</a> (const double a[3][3])</td></tr>
<tr class="memdesc:ad60b2dca7acfd76ff1f8d677ef609f8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Define the transformaton matrix with a C style 3x3 matrix.  <a href="classmspass_1_1seismic_1_1_core_seismogram.html#ad60b2dca7acfd76ff1f8d677ef609f8a">More...</a><br /></td></tr>
<tr class="separator:ad60b2dca7acfd76ff1f8d677ef609f8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a686a13c4938df315e175cd249a52b74e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a686a13c4938df315e175cd249a52b74e">set_transformation_matrix</a> (pybind11::object a)</td></tr>
<tr class="memdesc:a686a13c4938df315e175cd249a52b74e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Define the transformaton matrix with a python object.  <a href="classmspass_1_1seismic_1_1_core_seismogram.html#a686a13c4938df315e175cd249a52b74e">More...</a><br /></td></tr>
<tr class="separator:a686a13c4938df315e175cd249a52b74e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dd1a9469bca89f7e07c6aa928dc4a09"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a1dd1a9469bca89f7e07c6aa928dc4a09">cardinal</a> () const</td></tr>
<tr class="separator:a1dd1a9469bca89f7e07c6aa928dc4a09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41711bd9b0c88089e6e217f318c01de2"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a41711bd9b0c88089e6e217f318c01de2">orthogonal</a> () const</td></tr>
<tr class="separator:a41711bd9b0c88089e6e217f318c01de2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae043fa67b9d889965ae473da583a1eb4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#ae043fa67b9d889965ae473da583a1eb4">endtime</a> () const noexcept</td></tr>
<tr class="separator:ae043fa67b9d889965ae473da583a1eb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classmspass_1_1seismic_1_1_basic_time_series')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html">mspass::seismic::BasicTimeSeries</a></td></tr>
<tr class="memitem:a02072f2001d400e7f7ab5f9463e236c8 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a02072f2001d400e7f7ab5f9463e236c8">BasicTimeSeries</a> ()</td></tr>
<tr class="separator:a02072f2001d400e7f7ab5f9463e236c8 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8945a16bf52101d89dbc6f7b907b3fd9 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a8945a16bf52101d89dbc6f7b907b3fd9">BasicTimeSeries</a> (const <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html">BasicTimeSeries</a> &amp;)</td></tr>
<tr class="separator:a8945a16bf52101d89dbc6f7b907b3fd9 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2839e2405b168e0f1ad4d236f31eac8e inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a2839e2405b168e0f1ad4d236f31eac8e">~BasicTimeSeries</a> ()</td></tr>
<tr class="memdesc:a2839e2405b168e0f1ad4d236f31eac8e inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual destructor.  <a href="classmspass_1_1seismic_1_1_basic_time_series.html#a2839e2405b168e0f1ad4d236f31eac8e">More...</a><br /></td></tr>
<tr class="separator:a2839e2405b168e0f1ad4d236f31eac8e inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a438b4f6453a4ff2a46de53dfdf3599c2 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a438b4f6453a4ff2a46de53dfdf3599c2">time</a> (const int i) const</td></tr>
<tr class="separator:a438b4f6453a4ff2a46de53dfdf3599c2 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe28ca2812a2ac21dd2196385ad106ab inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#abe28ca2812a2ac21dd2196385ad106ab">sample_number</a> (double t) const</td></tr>
<tr class="separator:abe28ca2812a2ac21dd2196385ad106ab inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8982109d3caaeee15bb5b3a63b89317 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#af8982109d3caaeee15bb5b3a63b89317">endtime</a> () const noexcept</td></tr>
<tr class="separator:af8982109d3caaeee15bb5b3a63b89317 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e83b446d82202d808504429b0257eb0 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a1e83b446d82202d808504429b0257eb0">shifted</a> () const</td></tr>
<tr class="separator:a1e83b446d82202d808504429b0257eb0 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83c9a758b4a05ebddf09e17373b1e656 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a83c9a758b4a05ebddf09e17373b1e656">time_reference</a> () const</td></tr>
<tr class="separator:a83c9a758b4a05ebddf09e17373b1e656 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab87672dc6adffed90b0dc9c144219d44 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#ab87672dc6adffed90b0dc9c144219d44">force_t0_shift</a> (const double t)</td></tr>
<tr class="memdesc:ab87672dc6adffed90b0dc9c144219d44 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="mdescLeft">&#160;</td><td class="mdescRight">Force a t0 shift value on data.  <a href="classmspass_1_1seismic_1_1_basic_time_series.html#ab87672dc6adffed90b0dc9c144219d44">More...</a><br /></td></tr>
<tr class="separator:ab87672dc6adffed90b0dc9c144219d44 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfb9a7a1162b72d5d33e7e3430117611 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#adfb9a7a1162b72d5d33e7e3430117611">ator</a> (const double tshift)</td></tr>
<tr class="separator:adfb9a7a1162b72d5d33e7e3430117611 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21faa1455f1b3a0b723e7ee136ac4d2b inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a21faa1455f1b3a0b723e7ee136ac4d2b">rtoa</a> ()</td></tr>
<tr class="separator:a21faa1455f1b3a0b723e7ee136ac4d2b inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35bf7426cc825e9b3dcf3226816d8316 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a35bf7426cc825e9b3dcf3226816d8316">shift</a> (const double <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#af31c96c0e2173d7581e1c3a3f8bcfde8">dt</a>)</td></tr>
<tr class="separator:a35bf7426cc825e9b3dcf3226816d8316 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8aae898b7cf2f75d111b3eb6d8184396 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a8aae898b7cf2f75d111b3eb6d8184396">live</a> () const</td></tr>
<tr class="separator:a8aae898b7cf2f75d111b3eb6d8184396 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa96e795f96b5050996d791f5b6f3867d inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#aa96e795f96b5050996d791f5b6f3867d">dead</a> () const</td></tr>
<tr class="separator:aa96e795f96b5050996d791f5b6f3867d inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc56784b2aaadf8223a9e189830ae3dc inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#acc56784b2aaadf8223a9e189830ae3dc">kill</a> ()</td></tr>
<tr class="separator:acc56784b2aaadf8223a9e189830ae3dc inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ca7ba8bcd8337bd49d438664e74966d inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a1ca7ba8bcd8337bd49d438664e74966d">set_live</a> ()</td></tr>
<tr class="separator:a1ca7ba8bcd8337bd49d438664e74966d inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af31c96c0e2173d7581e1c3a3f8bcfde8 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#af31c96c0e2173d7581e1c3a3f8bcfde8">dt</a> () const</td></tr>
<tr class="separator:af31c96c0e2173d7581e1c3a3f8bcfde8 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf47da6a5d44415cf8a3b70e9a0bc5d5 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#aaf47da6a5d44415cf8a3b70e9a0bc5d5">time_is_UTC</a> () const</td></tr>
<tr class="separator:aaf47da6a5d44415cf8a3b70e9a0bc5d5 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a858bde44fbc9801ba833970604c965d1 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top"><a id="a858bde44fbc9801ba833970604c965d1"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>time_is_relative</b> () const</td></tr>
<tr class="separator:a858bde44fbc9801ba833970604c965d1 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0f23a3d725302665f4ff0c576b39237 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top"><a id="ac0f23a3d725302665f4ff0c576b39237"></a>
<a class="el" href="namespacemspass_1_1seismic.html#a0b8373068c66c7453bd012fe5367dbd2">TimeReferenceType</a>&#160;</td><td class="memItemRight" valign="bottom"><b>timetype</b> () const</td></tr>
<tr class="separator:ac0f23a3d725302665f4ff0c576b39237 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21bbb21d3debe26b9c185dc0c93651d0 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a21bbb21d3debe26b9c185dc0c93651d0">samprate</a> () const</td></tr>
<tr class="separator:a21bbb21d3debe26b9c185dc0c93651d0 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a347b349bb4e1f0e65978dfcd45ae3472 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a347b349bb4e1f0e65978dfcd45ae3472">npts</a> () const</td></tr>
<tr class="separator:a347b349bb4e1f0e65978dfcd45ae3472 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a472074f3074d59f794d18017b010ab81 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a472074f3074d59f794d18017b010ab81">t0</a> () const</td></tr>
<tr class="separator:a472074f3074d59f794d18017b010ab81 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3f8c8200710fe0d3ef211c7c758e864 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#ac3f8c8200710fe0d3ef211c7c758e864">set_tref</a> (const <a class="el" href="namespacemspass_1_1seismic.html#a0b8373068c66c7453bd012fe5367dbd2">TimeReferenceType</a> newtref)</td></tr>
<tr class="memdesc:ac3f8c8200710fe0d3ef211c7c758e864 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="mdescLeft">&#160;</td><td class="mdescRight">Force the time standard.  <a href="classmspass_1_1seismic_1_1_basic_time_series.html#ac3f8c8200710fe0d3ef211c7c758e864">More...</a><br /></td></tr>
<tr class="separator:ac3f8c8200710fe0d3ef211c7c758e864 inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf05bc1fe471e194bec093906c1a607c inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html">BasicTimeSeries</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#aaf05bc1fe471e194bec093906c1a607c">operator=</a> (const <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html">BasicTimeSeries</a> &amp;parent)</td></tr>
<tr class="separator:aaf05bc1fe471e194bec093906c1a607c inherit pub_methods_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classmspass_1_1utility_1_1_metadata"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classmspass_1_1utility_1_1_metadata')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classmspass_1_1utility_1_1_metadata.html">mspass::utility::Metadata</a></td></tr>
<tr class="memitem:a4a87cd6a6f8fc5cdbee65cb85958cb2c inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1utility_1_1_metadata.html#a4a87cd6a6f8fc5cdbee65cb85958cb2c">Metadata</a> ()</td></tr>
<tr class="separator:a4a87cd6a6f8fc5cdbee65cb85958cb2c inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5255fc3ae6accb650f221c9065a92eff inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1utility_1_1_metadata.html#a5255fc3ae6accb650f221c9065a92eff">Metadata</a> (std::ifstream &amp;ifs, const std::string form=std::string(&quot;pf&quot;))</td></tr>
<tr class="separator:a5255fc3ae6accb650f221c9065a92eff inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa617529be5501b6b059091118a1a51f inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1utility_1_1_metadata.html#afa617529be5501b6b059091118a1a51f">Metadata</a> (const <a class="el" href="classmspass_1_1utility_1_1_metadata.html">Metadata</a> &amp;mdold)</td></tr>
<tr class="separator:afa617529be5501b6b059091118a1a51f inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d06560c0b169240031c6a274dc7990f inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1utility_1_1_metadata.html#a6d06560c0b169240031c6a274dc7990f">~Metadata</a> ()</td></tr>
<tr class="separator:a6d06560c0b169240031c6a274dc7990f inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadbae283dfdb87a82832519a9955fdfa inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmspass_1_1utility_1_1_metadata.html">Metadata</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1utility_1_1_metadata.html#aadbae283dfdb87a82832519a9955fdfa">operator=</a> (const <a class="el" href="classmspass_1_1utility_1_1_metadata.html">Metadata</a> &amp;mdold)</td></tr>
<tr class="separator:aadbae283dfdb87a82832519a9955fdfa inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afadcdb42814abc1448a78d1d9f3d44aa inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmspass_1_1utility_1_1_metadata.html">Metadata</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1utility_1_1_metadata.html#afadcdb42814abc1448a78d1d9f3d44aa">operator+=</a> (const <a class="el" href="classmspass_1_1utility_1_1_metadata.html">Metadata</a> &amp;rhs) noexcept</td></tr>
<tr class="separator:afadcdb42814abc1448a78d1d9f3d44aa inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbd50c491ecc4d42cf2b4213b8bc3327 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classmspass_1_1utility_1_1_metadata.html">Metadata</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1utility_1_1_metadata.html#afbd50c491ecc4d42cf2b4213b8bc3327">operator+</a> (const <a class="el" href="classmspass_1_1utility_1_1_metadata.html">Metadata</a> &amp;other) const</td></tr>
<tr class="separator:afbd50c491ecc4d42cf2b4213b8bc3327 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad69a5786d997104df560775f4f688b02 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1utility_1_1_metadata.html#ad69a5786d997104df560775f4f688b02">get_double</a> (const std::string key) const override</td></tr>
<tr class="separator:ad69a5786d997104df560775f4f688b02 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78f3a01e1b1deccd84a0833bea4ef462 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1utility_1_1_metadata.html#a78f3a01e1b1deccd84a0833bea4ef462">get_int</a> (const std::string key) const override</td></tr>
<tr class="separator:a78f3a01e1b1deccd84a0833bea4ef462 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ace0c05ebb00b3c383cb8cccd225504 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1utility_1_1_metadata.html#a7ace0c05ebb00b3c383cb8cccd225504">get_long</a> (const std::string key) const</td></tr>
<tr class="separator:a7ace0c05ebb00b3c383cb8cccd225504 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa56da98a52f03babd67bf9fb55c40f3a inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1utility_1_1_metadata.html#aa56da98a52f03babd67bf9fb55c40f3a">get_string</a> (const std::string key) const override</td></tr>
<tr class="separator:aa56da98a52f03babd67bf9fb55c40f3a inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2631da9d437572ee0781ed9bd96a3ed3 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1utility_1_1_metadata.html#a2631da9d437572ee0781ed9bd96a3ed3">get_bool</a> (const std::string key) const override</td></tr>
<tr class="separator:a2631da9d437572ee0781ed9bd96a3ed3 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2b1cac0f295d9ab5fb240b8b5e12539 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:af2b1cac0f295d9ab5fb240b8b5e12539 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memTemplItemLeft" align="right" valign="top">T&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classmspass_1_1utility_1_1_metadata.html#af2b1cac0f295d9ab5fb240b8b5e12539">get</a> (const std::string key) const</td></tr>
<tr class="separator:af2b1cac0f295d9ab5fb240b8b5e12539 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d6876ed25c3f5d93052239ec828a3c5 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:a5d6876ed25c3f5d93052239ec828a3c5 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memTemplItemLeft" align="right" valign="top">T&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classmspass_1_1utility_1_1_metadata.html#a5d6876ed25c3f5d93052239ec828a3c5">get</a> (const char *key) const</td></tr>
<tr class="memdesc:a5d6876ed25c3f5d93052239ec828a3c5 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic get interface for C char array.  <a href="classmspass_1_1utility_1_1_metadata.html#a5d6876ed25c3f5d93052239ec828a3c5">More...</a><br /></td></tr>
<tr class="separator:a5d6876ed25c3f5d93052239ec828a3c5 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a991516933477580b6b59dd578819df06 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top">boost::any&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1utility_1_1_metadata.html#a991516933477580b6b59dd578819df06">get_any</a> (const std::string key) const</td></tr>
<tr class="separator:a991516933477580b6b59dd578819df06 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5cd3bfc81c7fccd83bbb30ef1c2774c inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top"><a id="ad5cd3bfc81c7fccd83bbb30ef1c2774c"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><b>type</b> (const std::string key) const</td></tr>
<tr class="separator:ad5cd3bfc81c7fccd83bbb30ef1c2774c inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2162ed3e7349998ee06ace77645bf77 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memTemplParams" colspan="2"><a id="ab2162ed3e7349998ee06ace77645bf77"></a>
template&lt;typename T &gt; </td></tr>
<tr class="memitem:ab2162ed3e7349998ee06ace77645bf77 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><b>put</b> (const std::string key, T val) noexcept</td></tr>
<tr class="separator:ab2162ed3e7349998ee06ace77645bf77 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec776bbbbf8528903432d9b30d1272d8 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memTemplParams" colspan="2"><a id="aec776bbbbf8528903432d9b30d1272d8"></a>
template&lt;typename T &gt; </td></tr>
<tr class="memitem:aec776bbbbf8528903432d9b30d1272d8 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><b>put</b> (const char *key, T val) noexcept</td></tr>
<tr class="separator:aec776bbbbf8528903432d9b30d1272d8 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefee14db8cda9c7143a0eb7bf2d1be1f inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top"><a id="aefee14db8cda9c7143a0eb7bf2d1be1f"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>put</b> (const std::string key, const double val) override</td></tr>
<tr class="separator:aefee14db8cda9c7143a0eb7bf2d1be1f inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11ef6cbc1adec7964e2d9c3a4ead15b1 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top"><a id="a11ef6cbc1adec7964e2d9c3a4ead15b1"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>put</b> (const std::string key, const int val) override</td></tr>
<tr class="separator:a11ef6cbc1adec7964e2d9c3a4ead15b1 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3989b1152e9b7b3dcce36aaec89f46d inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top"><a id="ab3989b1152e9b7b3dcce36aaec89f46d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>put</b> (const std::string key, const bool val) override</td></tr>
<tr class="separator:ab3989b1152e9b7b3dcce36aaec89f46d inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc016a9bb2288f1f0a7687cfa6844ceb inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top"><a id="adc016a9bb2288f1f0a7687cfa6844ceb"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>put</b> (const std::string key, const std::string val) override</td></tr>
<tr class="separator:adc016a9bb2288f1f0a7687cfa6844ceb inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa60d283b9eaae245294914557c723c30 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1utility_1_1_metadata.html#aa60d283b9eaae245294914557c723c30">put</a> (const char *key, const char *val)</td></tr>
<tr class="separator:aa60d283b9eaae245294914557c723c30 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45c295b33cdbcc297b7429235b81de9a inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top"><a id="a45c295b33cdbcc297b7429235b81de9a"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>put</b> (std::string key, const char *val)</td></tr>
<tr class="separator:a45c295b33cdbcc297b7429235b81de9a inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8402af6778236df398ff0fe25911e21 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top"><a id="aa8402af6778236df398ff0fe25911e21"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>put_object</b> (const std::string key, const pybind11::object val)</td></tr>
<tr class="separator:aa8402af6778236df398ff0fe25911e21 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fe91d35373564958386f08915b7ce3c inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top"><a id="a5fe91d35373564958386f08915b7ce3c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>put_int</b> (const std::string key, const int val)</td></tr>
<tr class="separator:a5fe91d35373564958386f08915b7ce3c inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5efd5678db951e3517c5667fefe93ddf inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top"><a id="a5efd5678db951e3517c5667fefe93ddf"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>put_string</b> (const std::string key, const std::string val)</td></tr>
<tr class="separator:a5efd5678db951e3517c5667fefe93ddf inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add02049febdc316d70d0fb62e96b2e36 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top"><a id="add02049febdc316d70d0fb62e96b2e36"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>put_bool</b> (const std::string key, const bool val)</td></tr>
<tr class="separator:add02049febdc316d70d0fb62e96b2e36 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafaa017f0e16f37a81a6abdb406a1e08 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top"><a id="aafaa017f0e16f37a81a6abdb406a1e08"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>put_double</b> (const std::string key, const double val)</td></tr>
<tr class="separator:aafaa017f0e16f37a81a6abdb406a1e08 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1ede27ae9810767832f0879ccbfd234 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top"><a id="ab1ede27ae9810767832f0879ccbfd234"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>put_long</b> (const std::string key, const long val)</td></tr>
<tr class="separator:ab1ede27ae9810767832f0879ccbfd234 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa288eb54e6fafb8af13f71e2f3dce4a2 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1utility_1_1_metadata.html#aa288eb54e6fafb8af13f71e2f3dce4a2">append_chain</a> (const std::string key, const std::string val, const std::string separator=std::string(&quot;:&quot;))</td></tr>
<tr class="separator:aa288eb54e6fafb8af13f71e2f3dce4a2 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fec2640022e944afe1ae1180e741da5 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top">std::set&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1utility_1_1_metadata.html#a0fec2640022e944afe1ae1180e741da5">modified</a> () const</td></tr>
<tr class="separator:a0fec2640022e944afe1ae1180e741da5 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a610962d5ca59e48d1b2833e613bbad1d inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1utility_1_1_metadata.html#a610962d5ca59e48d1b2833e613bbad1d">clear_modified</a> ()</td></tr>
<tr class="memdesc:a610962d5ca59e48d1b2833e613bbad1d inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mark all data as unmodified.  <a href="classmspass_1_1utility_1_1_metadata.html#a610962d5ca59e48d1b2833e613bbad1d">More...</a><br /></td></tr>
<tr class="separator:a610962d5ca59e48d1b2833e613bbad1d inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52e2040555616a39b900aa0831c3bd10 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top">std::set&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1utility_1_1_metadata.html#a52e2040555616a39b900aa0831c3bd10">keys</a> () const noexcept</td></tr>
<tr class="separator:a52e2040555616a39b900aa0831c3bd10 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e96e8682297fe8b21acf09b4d399cc6 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1utility_1_1_metadata.html#a1e96e8682297fe8b21acf09b4d399cc6">is_defined</a> (const std::string key) const noexcept</td></tr>
<tr class="separator:a1e96e8682297fe8b21acf09b4d399cc6 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a096d3ea32cc03c3f9ae9c69cd9ee28ba inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1utility_1_1_metadata.html#a096d3ea32cc03c3f9ae9c69cd9ee28ba">erase</a> (const std::string key)</td></tr>
<tr class="separator:a096d3ea32cc03c3f9ae9c69cd9ee28ba inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a153ca69299a4d70aa0c6e69e8c70a767 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1utility_1_1_metadata.html#a153ca69299a4d70aa0c6e69e8c70a767">size</a> () const noexcept</td></tr>
<tr class="separator:a153ca69299a4d70aa0c6e69e8c70a767 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9aea7916d2b11f9f1e94b7d84b8db23 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top">std::map&lt; std::string, boost::any &gt;::const_iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1utility_1_1_metadata.html#af9aea7916d2b11f9f1e94b7d84b8db23">begin</a> () const noexcept</td></tr>
<tr class="separator:af9aea7916d2b11f9f1e94b7d84b8db23 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f1e227ec1acaab97343ecbf47bedac4 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top">std::map&lt; std::string, boost::any &gt;::const_iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1utility_1_1_metadata.html#a7f1e227ec1acaab97343ecbf47bedac4">end</a> () const noexcept</td></tr>
<tr class="separator:a7f1e227ec1acaab97343ecbf47bedac4 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20c1da469f6e0a073b291a680425f9e8 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1utility_1_1_metadata.html#a20c1da469f6e0a073b291a680425f9e8">change_key</a> (const std::string oldkey, const std::string newkey)</td></tr>
<tr class="memdesc:a20c1da469f6e0a073b291a680425f9e8 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="mdescLeft">&#160;</td><td class="mdescRight">Change the keyword to access an attribute.  <a href="classmspass_1_1utility_1_1_metadata.html#a20c1da469f6e0a073b291a680425f9e8">More...</a><br /></td></tr>
<tr class="separator:a20c1da469f6e0a073b291a680425f9e8 inherit pub_methods_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a9ac5c7c060d582b1a399fb066d06779f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmspass_1_1utility_1_1dmatrix.html">mspass::utility::dmatrix</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a></td></tr>
<tr class="separator:a9ac5c7c060d582b1a399fb066d06779f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a7e983515950366013bde880ddb740b36"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7e983515950366013bde880ddb740b36">components_are_orthogonal</a></td></tr>
<tr class="separator:a7e983515950366013bde880ddb740b36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af87b223c30872f55e8c5a5246da143ba"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a></td></tr>
<tr class="separator:af87b223c30872f55e8c5a5246da143ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30316a5d8ed7794f0d51da0c96d97882"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a> [3][3]</td></tr>
<tr class="separator:a30316a5d8ed7794f0d51da0c96d97882"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classmspass_1_1seismic_1_1_basic_time_series"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classmspass_1_1seismic_1_1_basic_time_series')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html">mspass::seismic::BasicTimeSeries</a></td></tr>
<tr class="memitem:a7b2e9b878959d376790f09194edc51d9 inherit pro_attribs_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a7b2e9b878959d376790f09194edc51d9">mlive</a></td></tr>
<tr class="separator:a7b2e9b878959d376790f09194edc51d9 inherit pro_attribs_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea80df11992ca2c7ff915aab5fcba6f5 inherit pro_attribs_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#aea80df11992ca2c7ff915aab5fcba6f5">mdt</a></td></tr>
<tr class="separator:aea80df11992ca2c7ff915aab5fcba6f5 inherit pro_attribs_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb40f4223a8ee73e79f9af065372a757 inherit pro_attribs_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#aeb40f4223a8ee73e79f9af065372a757">mt0</a></td></tr>
<tr class="separator:aeb40f4223a8ee73e79f9af065372a757 inherit pro_attribs_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cb0afe9272567b8fd3394f79f46628a inherit pro_attribs_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a></td></tr>
<tr class="separator:a0cb0afe9272567b8fd3394f79f46628a inherit pro_attribs_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb88ddef3bab3b3205dfe6c6cfdb91aa inherit pro_attribs_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemspass_1_1seismic.html#a0b8373068c66c7453bd012fe5367dbd2">TimeReferenceType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#abb88ddef3bab3b3205dfe6c6cfdb91aa">tref</a></td></tr>
<tr class="separator:abb88ddef3bab3b3205dfe6c6cfdb91aa inherit pro_attribs_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af749170531556c0c39ba6916057d2b17 inherit pro_attribs_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top"><a id="af749170531556c0c39ba6916057d2b17"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>t0shift_is_valid</b></td></tr>
<tr class="separator:af749170531556c0c39ba6916057d2b17 inherit pro_attribs_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae79b68bf89b4cd4e6001bbf2c491f539 inherit pro_attribs_classmspass_1_1seismic_1_1_basic_time_series"><td class="memItemLeft" align="right" valign="top"><a id="ae79b68bf89b4cd4e6001bbf2c491f539"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>t0shift</b></td></tr>
<tr class="separator:ae79b68bf89b4cd4e6001bbf2c491f539 inherit pro_attribs_classmspass_1_1seismic_1_1_basic_time_series"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classmspass_1_1utility_1_1_metadata"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classmspass_1_1utility_1_1_metadata')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classmspass_1_1utility_1_1_metadata.html">mspass::utility::Metadata</a></td></tr>
<tr class="memitem:af564bb9ced4cc480d71a1e13c3fa582e inherit pro_attribs_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top"><a id="af564bb9ced4cc480d71a1e13c3fa582e"></a>
std::map&lt; std::string, boost::any &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>md</b></td></tr>
<tr class="separator:af564bb9ced4cc480d71a1e13c3fa582e inherit pro_attribs_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abaa3b11bec830a2ab4f93e79623af591 inherit pro_attribs_classmspass_1_1utility_1_1_metadata"><td class="memItemLeft" align="right" valign="top"><a id="abaa3b11bec830a2ab4f93e79623af591"></a>
std::set&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>changed_or_set</b></td></tr>
<tr class="separator:abaa3b11bec830a2ab4f93e79623af591 inherit pro_attribs_classmspass_1_1utility_1_1_metadata"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Vector (three-component) seismogram data object. </p>
<p>A three-component seismogram is a common concept in seismology. The concept used here is that a three-component seismogram is a time series with a 3-vector as the data at each time step. As a result the data are stored internally as a matrix with row defining the component number (C indexing 0,1,2) and the column defining the time variable. The object inherits common concepts of a time series through the <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html" title="Base class for time series objects.">BasicTimeSeries</a> object. Auxiliary parameters are defined for the object through inheritance of a Metadata object. </p><dl class="section author"><dt>Author</dt><dd>Gary L. Pavlis </dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a9be7b3811cfcd0b0396b32214d7eab51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9be7b3811cfcd0b0396b32214d7eab51">&#9670;&nbsp;</a></span>CoreSeismogram() <span class="overload">[1/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mspass::seismic::CoreSeismogram::CoreSeismogram </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Default constructor.</p>
<p>Sets ns to zero and builds an empty data matrix. The live variable in <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html" title="Base class for time series objects.">BasicTimeSeries</a> is also set false. </p>
<div class="fragment"><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;                               : <a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a02072f2001d400e7f7ab5f9463e236c8">BasicTimeSeries</a>(),<a class="code" href="classmspass_1_1utility_1_1_metadata.html#a4a87cd6a6f8fc5cdbee65cb85958cb2c">Metadata</a>()</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;{</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="comment">/* mlive and tref are set in BasicTimeSeries so we don&#39;t use putters for</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">  them here.   These three initialize Metadata properly for these attributes*/</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a5e51c2c6d3a1aa02281ba242a1d15bf2">set_dt</a>(1.0);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7724b7cfa40eebf0b15e0d2b39ae615e">set_t0</a>(0.0);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#ae94bac250fe5928ced41babc322c2c79">set_npts</a>(0);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7e983515950366013bde880ddb740b36">components_are_orthogonal</a>=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;3; ++i)</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;3; ++j)</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            <span class="keywordflow">if</span>(i==j)</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[i][i]=1.0;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[i][j]=0.0;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7e983515950366013bde880ddb740b36">components_are_orthogonal</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a5e51c2c6d3a1aa02281ba242a1d15bf2">set_dt()</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#ae94bac250fe5928ced41babc322c2c79">set_npts()</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7724b7cfa40eebf0b15e0d2b39ae615e">set_t0()</a>, and <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>.</p>

</div>
</div>
<a id="a88d2aa5099488eb2cbdbd1188c81339e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88d2aa5099488eb2cbdbd1188c81339e">&#9670;&nbsp;</a></span>CoreSeismogram() <span class="overload">[2/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mspass::seismic::CoreSeismogram::CoreSeismogram </td>
          <td>(</td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>nsamples</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Simplest parameterized constructor.</p>
<p>Initializes data and sets aside memory for matrix of size 3xnsamples. The data matrix is not initialized and the object is marked as not live. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nsamples</td><td>number of samples expected for holding data. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    : <a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a02072f2001d400e7f7ab5f9463e236c8">BasicTimeSeries</a>(),<a class="code" href="classmspass_1_1utility_1_1_metadata.html#a4a87cd6a6f8fc5cdbee65cb85958cb2c">Metadata</a>()</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;{</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="comment">/* IMPORTANT:  this constructor assumes BasicTimeSeries initializes the</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">  equivalent of:</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">  set_dt(1.0)</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">  set_t0(0.0)</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">  set_tref(TimeReferenceType::Relative)</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">  this-&gt;kill() - i.e. marked dead</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#ae94bac250fe5928ced41babc322c2c79">set_npts</a>(nsamples);  <span class="comment">// Assume this is an allocator of the 3xnsamples matrix</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7e983515950366013bde880ddb740b36">components_are_orthogonal</a>=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;3; ++i)</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;3; ++j)</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keywordflow">if</span>(i==j)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[i][i]=1.0;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[i][j]=0.0;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7e983515950366013bde880ddb740b36">components_are_orthogonal</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#ae94bac250fe5928ced41babc322c2c79">set_npts()</a>, and <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>.</p>

</div>
</div>
<a id="a8c7307434dac26ca63ac423b55ecb5ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c7307434dac26ca63ac423b55ecb5ec">&#9670;&nbsp;</a></span>CoreSeismogram() <span class="overload">[3/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mspass::seismic::CoreSeismogram::CoreSeismogram </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classmspass_1_1seismic_1_1_core_time_series.html">mspass::seismic::CoreTimeSeries</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>component_to_clone</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Construct a three component seismogram from three <a class="el" href="classmspass_1_1seismic_1_1_time_series.html" title="Implemntation of TimeSeries for MsPASS.">TimeSeries</a> objects.</p>
<p>A three component seismogram is commonly assembled from individual single channel components. This constructor does the process taking reasonable care to deal with (potentially) irregular start and end times of the individual components. If the start and end times are all the same it uses a simple copy operation. Otherwise it runs a more complicated (read much slower) algorithm that handles the ragged start and stop times by adding a marked gap.</p>
<p>If start or end times are not constant the algorithm shortens the output to the latest start time and earliest end time respectively.</p>
<p>Note this constructor requires variables hang and vang, which are orientation angles defined in the CSS3.0 schema (NOT spherical coordinates by the way), by set for each component. This is used to construct the transformation matrix for the object that allows, for example, removing raw data orientation errors using rotate_to_standard. The constructor will throw an exception if any component does not have these attributes set in their Metadata area.</p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SeisppError</td><td>exception can be throw for a variety of serious problems. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ts</td><td>vector of 3 <a class="el" href="classmspass_1_1seismic_1_1_time_series.html" title="Implemntation of TimeSeries for MsPASS.">TimeSeries</a> objects to be used to assemble this <a class="el" href="classmspass_1_1seismic_1_1_seismogram.html" title="Implemntation of Seismogram for MsPASS.">Seismogram</a>. Input vector order could be arbitrary because a transformation matrix is computed, but for efficiency standard order (E,N,Z) is advised. </td></tr>
    <tr><td class="paramname">component_to_clone</td><td>the auxiliary parameters (Metadata and <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html" title="Base class for time series objects.">BasicTimeSeries</a> common parameters) from one of the components is cloned to assure common required parameters are copied to this object. This argument controls which of the three components passed through ts is used. Default is 0. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a67232df3f9d1e1b5ac245f97478adee9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67232df3f9d1e1b5ac245f97478adee9">&#9670;&nbsp;</a></span>CoreSeismogram() <span class="overload">[4/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mspass::seismic::CoreSeismogram::CoreSeismogram </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmspass_1_1utility_1_1_metadata.html">mspass::utility::Metadata</a> &amp;&#160;</td>
          <td class="paramname"><em>md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>load_data</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct from Metadata definition that includes data path. </p>
<p>A Metadata object is sufficiently general that it can contain enough information to contruct an object from attributes contained in it. This constuctor uses that approach, with the actual loading of data being an option (on by default). In mspass this is constructor is used to load data with Metadata constructed from MongoDB and then using the path created from two parameters (dir and dfile used as in css3.0 wfdisc) to read data. The API is general but the implementation in mspass is very rigid. It blindly assumes the data being read are binary doubles in the right byte order and ordered in the native order for dmatrix (Fortran order). i.e. the constuctor does a raw fread of ns*3 doubles into the internal array used in the dmatrix implementation.</p>
<p>A second element of the Metadata that is special for MsPASS is the handling of the transformation matrix by this constructor. In MsPASS the transformation matrix is stored as a python object in MongoDB. This constructor aims to fetch that entity with the key 'tmatrix'. To be more robust and simpler to use with data not loaded from mongodb we default tmatrix to assume the data are in standard coordinates. That is, if the key tmatrix is not defined in Metadata passed as arg0, the constructor assumes it should set the transformation matrix to an identity. Use set_transformation_matrix if that assumption is wrong for your data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">md</td><td>is the Metadata used for the construction.</td></tr>
    <tr><td class="paramname">load_data</td><td>if true (default) a file name is constructed from dir+"/"+dfile, the file is openned, fseek is called to foff, data are read with fread, and the file is closed. If false a dmatrix for u is still created of size 3xns, but the matrix is only initialized to all zeros.</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">Will</td><td>throw a MsPASSError if required metadata are missing. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                                      : <a class="code" href="classmspass_1_1utility_1_1_metadata.html#a4a87cd6a6f8fc5cdbee65cb85958cb2c">Metadata</a>(md)</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;{</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordtype">string</span> dfile, dir;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordtype">long</span> foff;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    FILE *fp;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordtype">double</span> *inbuffer;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7e983515950366013bde880ddb740b36">components_are_orthogonal</a>=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a7b2e9b878959d376790f09194edc51d9">mlive</a>=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="comment">/* Names used are from mspass defintions as of Jan 2020.</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">        We don&#39;t need to call the set methods for these attributes as they</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">        would add the overhead of setting delta, startime, and npts to the</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">        same value passed. */</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#aea80df11992ca2c7ff915aab5fcba6f5">mdt</a> = this-&gt;<a class="code" href="classmspass_1_1utility_1_1_metadata.html#ad69a5786d997104df560775f4f688b02">get_double</a>(<a class="code" href="namespacemspass_1_1seismic.html#a3f7a9857fd532d0e6800f2a316b50772">SEISMICMD_dt</a>);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#aeb40f4223a8ee73e79f9af065372a757">mt0</a> = this-&gt;<a class="code" href="classmspass_1_1utility_1_1_metadata.html#ad69a5786d997104df560775f4f688b02">get_double</a>(<a class="code" href="namespacemspass_1_1seismic.html#a1e5b45ce0ed02e9c1d154ea0434138c0">SEISMICMD_t0</a>);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classmspass_1_1utility_1_1_metadata.html#a1e96e8682297fe8b21acf09b4d399cc6">is_defined</a>(<a class="code" href="namespacemspass_1_1seismic.html#a88a01d6c4e1838b7bac28931b9cc8c58">SEISMICMD_time_standard</a>))</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;          <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classmspass_1_1utility_1_1_metadata.html#aa56da98a52f03babd67bf9fb55c40f3a">get_string</a>(<a class="code" href="namespacemspass_1_1seismic.html#a88a01d6c4e1838b7bac28931b9cc8c58">SEISMICMD_time_standard</a>) == <span class="stringliteral">&quot;UTC&quot;</span>)</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#ac3f8c8200710fe0d3ef211c7c758e864">set_tref</a>(<a class="code" href="namespacemspass_1_1seismic.html#a0b8373068c66c7453bd012fe5367dbd2a9234324ddf6b4176b57d803a925b7961">TimeReferenceType::UTC</a>);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;          {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#ac3f8c8200710fe0d3ef211c7c758e864">set_tref</a>(<a class="code" href="namespacemspass_1_1seismic.html#a0b8373068c66c7453bd012fe5367dbd2a2ca9469819fb0fb61ff98e914a7ccca0">TimeReferenceType::Relative</a>);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <span class="comment">/* For now we can&#39;t post an error because this is CoreSeismogram</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">            so elog is not defined.   For now let this error be silent as it</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">            is harmless */</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            <span class="comment">/*</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">            this-&gt;elog.log_error(&quot;CoreSeismogram Metadata constructor&quot;,</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">              SEISMICMD_time_standard+&quot; attribute is not defined - set to Relative&quot;,</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">              ErrorSeverity::Complaint);</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">              */</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;          }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordflow">if</span>(this-&gt;time_is_relative())</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;          <span class="comment">/* It is not an error if a t0 shift is not defined and we are</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">          in relative time. That is the norm for active source data. */</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;          <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classmspass_1_1utility_1_1_metadata.html#a1e96e8682297fe8b21acf09b4d399cc6">is_defined</a>(<a class="code" href="namespacemspass_1_1seismic.html#a0951fef82377e868ee7cfcd4841979cf">SEISMICMD_t0_shift</a>))</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;          {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <span class="keywordtype">double</span> t0shift=this-&gt;<a class="code" href="classmspass_1_1utility_1_1_metadata.html#ad69a5786d997104df560775f4f688b02">get_double</a>(<a class="code" href="namespacemspass_1_1seismic.html#a0951fef82377e868ee7cfcd4841979cf">SEISMICMD_t0_shift</a>);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#ab87672dc6adffed90b0dc9c144219d44">force_t0_shift</a>(t0shift);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;          }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="comment">/* This section is done specially to handle interaction with MongoDB.</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">        We store tmatrix there as a python object so we use a get_any to fetch</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">        it.   Oct 22, 2021 added a bug fix to handle tmatrix not defined.</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">        We will take a null (undefined) tmatrix stored in the database to</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">        imply the data are cardinal and orthogonal (i.e. stardard geographic</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">        coordinates in e,n,z order.)*/</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classmspass_1_1utility_1_1_metadata.html#a1e96e8682297fe8b21acf09b4d399cc6">is_defined</a>(<span class="stringliteral">&quot;tmatrix&quot;</span>))</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;          this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a94e13495475bfb8c1e62f40006f13bdc">set_transformation_matrix</a></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                    (boost::any_cast&lt;py::object&gt;(this-&gt;<a class="code" href="classmspass_1_1utility_1_1_metadata.html#a991516933477580b6b59dd578819df06">get_any</a>(<span class="stringliteral">&quot;tmatrix&quot;</span>)));</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;          <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>=this-&gt;tmatrix_is_cardinal();</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>)</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7e983515950366013bde880ddb740b36">components_are_orthogonal</a>=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7e983515950366013bde880ddb740b36">components_are_orthogonal</a>=<span class="keyword">false</span>;  <span class="comment">//May be wrong but cost is tiny</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;          <span class="comment">/* this might not be needed but best be explicit*/</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          <span class="keywordflow">for</span>(<span class="keyword">auto</span> i=0;i&lt;3;++i)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">auto</span> j=0;j&lt;3;++j) this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[i][j] = 0.0;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;          <span class="keywordflow">for</span>(<span class="keyword">auto</span> i=0;i&lt;3;++i) this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[i][i] = 1.0;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;          <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7e983515950366013bde880ddb740b36">components_are_orthogonal</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;          <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="comment">/* We have to handle nsamp specially in the case when load_data </span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">        is false.  To be consistent with TimeSeries we use a feature that </span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">        if the Metadata container does not define npts we default it.  </span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">        In this case that means the default constructor for u and set</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">        nsamp to 0 (via set_npts). */</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">if</span>(md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#a1e96e8682297fe8b21acf09b4d399cc6">is_defined</a>(<a class="code" href="namespacemspass_1_1seismic.html#ac848a79911ca1930abf265f01a6d635f">SEISMICMD_npts</a>))</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;          <span class="keywordtype">long</span> <span class="keywordtype">int</span> ns = md.<a class="code" href="classmspass_1_1utility_1_1_metadata.html#a7ace0c05ebb00b3c383cb8cccd225504">get_long</a>(<a class="code" href="namespacemspass_1_1seismic.html#ac848a79911ca1930abf265f01a6d635f">SEISMICMD_npts</a>);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;          this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#ae94bac250fe5928ced41babc322c2c79">set_npts</a>(ns);  <span class="comment">/* note this is assumed to initialize u*/</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;          this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#ae94bac250fe5928ced41babc322c2c79">set_npts</a>(0);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="comment">/* Note previous code had an else clause to to with the </span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">        following conditional.  It used to zero the u matrix.  </span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">        The call to set_npts above will always do that so that would</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">        have been redundant and was removed June 2022*/</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="keywordflow">if</span>(load_data)</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            dir = this-&gt;<a class="code" href="classmspass_1_1utility_1_1_metadata.html#aa56da98a52f03babd67bf9fb55c40f3a">get_string</a>(<a class="code" href="namespacemspass_1_1seismic.html#ab8ff84666cf6d1c391987306eaad2546">SEISMICMD_dir</a>);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            dfile = this-&gt;<a class="code" href="classmspass_1_1utility_1_1_metadata.html#aa56da98a52f03babd67bf9fb55c40f3a">get_string</a>(<a class="code" href="namespacemspass_1_1seismic.html#a1254f7fb8e1be5b198218604ac9b3c8a">SEISMICMD_dfile</a>);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            foff = this-&gt;<a class="code" href="classmspass_1_1utility_1_1_metadata.html#a7ace0c05ebb00b3c383cb8cccd225504">get_long</a>(<a class="code" href="namespacemspass_1_1seismic.html#a17279751e3795fee46d6a3cdfe427c33">SEISMICMD_foff</a>);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <span class="keywordtype">string</span> fname=dir+<span class="stringliteral">&quot;/&quot;</span>+dfile;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <span class="keywordflow">if</span>((fp=fopen(fname.c_str(),<span class="stringliteral">&quot;r&quot;</span>)) == NULL)</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                <span class="keywordflow">throw</span>(<a class="code" href="classmspass_1_1utility_1_1_ms_p_a_s_s_error.html">MsPASSError</a>(<span class="keywordtype">string</span>(<span class="stringliteral">&quot;Open failure for file &quot;</span>)+fname,</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                                 ErrorSeverity::Invalid));</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <span class="keywordflow">if</span> (foff&gt;0)fseek(fp,foff,SEEK_SET);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            <span class="comment">/* The older seispp code allowed byte swapping here.   For</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">            efficiency we don&#39;t support that here and assume can do a</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">            raw fread from the file and get valid data.  If support for</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">            other types is needed this will need to be extended.  Here</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">            we just point fread at the internal u array. */</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            inbuffer = this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.get_address(0,0);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nt=3*this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            <span class="keywordflow">if</span>(fread((<span class="keywordtype">void</span> *)(inbuffer),<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>),nt,fp)</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                    != nt )</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                fclose(fp);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                <span class="keywordflow">throw</span>(<a class="code" href="classmspass_1_1utility_1_1_ms_p_a_s_s_error.html">MsPASSError</a>(<span class="keywordtype">string</span>(<span class="stringliteral">&quot;CoreSeismogram constructor:  fread error on file &quot;</span>)+fname,</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                      ErrorSeverity::Invalid));</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            fclose(fp);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a7b2e9b878959d376790f09194edc51d9">mlive</a>=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    } <span class="keywordflow">catch</span> (<a class="code" href="classmspass_1_1utility_1_1_ms_p_a_s_s_error.html">MsPASSError</a>&amp; mpe) {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordflow">throw</span>(mpe);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    } <span class="keywordflow">catch</span> (boost::bad_any_cast&amp; be) {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordflow">throw</span>(<a class="code" href="classmspass_1_1utility_1_1_ms_p_a_s_s_error.html">MsPASSError</a>(<span class="keywordtype">string</span>(<span class="stringliteral">&quot;CoreSeismogram constructor:  tmatrix type is not recognized&quot;</span>),</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                ErrorSeverity::Invalid));</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    } <span class="keywordflow">catch</span> (...) {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <span class="keywordflow">throw</span>;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    };</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7e983515950366013bde880ddb740b36">components_are_orthogonal</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#ab87672dc6adffed90b0dc9c144219d44">mspass::seismic::BasicTimeSeries::force_t0_shift()</a>, <a class="el" href="classmspass_1_1utility_1_1_metadata.html#a991516933477580b6b59dd578819df06">mspass::utility::Metadata::get_any()</a>, <a class="el" href="classmspass_1_1utility_1_1_metadata.html#ad69a5786d997104df560775f4f688b02">mspass::utility::Metadata::get_double()</a>, <a class="el" href="classmspass_1_1utility_1_1_metadata.html#a7ace0c05ebb00b3c383cb8cccd225504">mspass::utility::Metadata::get_long()</a>, <a class="el" href="classmspass_1_1utility_1_1_metadata.html#aa56da98a52f03babd67bf9fb55c40f3a">mspass::utility::Metadata::get_string()</a>, <a class="el" href="classmspass_1_1utility_1_1_metadata.html#a1e96e8682297fe8b21acf09b4d399cc6">mspass::utility::Metadata::is_defined()</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#aea80df11992ca2c7ff915aab5fcba6f5">mspass::seismic::BasicTimeSeries::mdt</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a7b2e9b878959d376790f09194edc51d9">mspass::seismic::BasicTimeSeries::mlive</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#aeb40f4223a8ee73e79f9af065372a757">mspass::seismic::BasicTimeSeries::mt0</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">mspass::seismic::BasicTimeSeries::nsamp</a>, <a class="el" href="namespacemspass_1_1seismic.html#a0b8373068c66c7453bd012fe5367dbd2a2ca9469819fb0fb61ff98e914a7ccca0">mspass::seismic::Relative</a>, <a class="el" href="namespacemspass_1_1seismic.html#a1254f7fb8e1be5b198218604ac9b3c8a">mspass::seismic::SEISMICMD_dfile()</a>, <a class="el" href="namespacemspass_1_1seismic.html#ab8ff84666cf6d1c391987306eaad2546">mspass::seismic::SEISMICMD_dir()</a>, <a class="el" href="namespacemspass_1_1seismic.html#a3f7a9857fd532d0e6800f2a316b50772">mspass::seismic::SEISMICMD_dt()</a>, <a class="el" href="namespacemspass_1_1seismic.html#a17279751e3795fee46d6a3cdfe427c33">mspass::seismic::SEISMICMD_foff()</a>, <a class="el" href="namespacemspass_1_1seismic.html#ac848a79911ca1930abf265f01a6d635f">mspass::seismic::SEISMICMD_npts()</a>, <a class="el" href="namespacemspass_1_1seismic.html#a1e5b45ce0ed02e9c1d154ea0434138c0">mspass::seismic::SEISMICMD_t0()</a>, <a class="el" href="namespacemspass_1_1seismic.html#a0951fef82377e868ee7cfcd4841979cf">mspass::seismic::SEISMICMD_t0_shift()</a>, <a class="el" href="namespacemspass_1_1seismic.html#a88a01d6c4e1838b7bac28931b9cc8c58">mspass::seismic::SEISMICMD_time_standard()</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#ae94bac250fe5928ced41babc322c2c79">set_npts()</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a94e13495475bfb8c1e62f40006f13bdc">set_transformation_matrix()</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#ac3f8c8200710fe0d3ef211c7c758e864">mspass::seismic::BasicTimeSeries::set_tref()</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>, and <a class="el" href="namespacemspass_1_1seismic.html#a0b8373068c66c7453bd012fe5367dbd2a9234324ddf6b4176b57d803a925b7961">mspass::seismic::UTC</a>.</p>

</div>
</div>
<a id="a9c993726c259d7a6f1c213d0d04db5ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c993726c259d7a6f1c213d0d04db5ba">&#9670;&nbsp;</a></span>CoreSeismogram() <span class="overload">[5/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mspass::seismic::CoreSeismogram::CoreSeismogram </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html">CoreSeismogram</a> &amp;&#160;</td>
          <td class="paramname"><em>t3c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Standard copy constructor. </p>
<div class="fragment"><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                                                        :</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a02072f2001d400e7f7ab5f9463e236c8">BasicTimeSeries</a>(<span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a02072f2001d400e7f7ab5f9463e236c8">BasicTimeSeries</a>&amp;<span class="keyword">&gt;</span>(t3c)),</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="classmspass_1_1utility_1_1_metadata.html#a4a87cd6a6f8fc5cdbee65cb85958cb2c">Metadata</a>(<span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classmspass_1_1utility_1_1_metadata.html">Metadata</a>&amp;<span class="keyword">&gt;</span>(t3c)),</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>(t3c.u)</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;{</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordtype">int</span> i,j;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7e983515950366013bde880ddb740b36">components_are_orthogonal</a>=t3c.components_are_orthogonal;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>=t3c.components_are_cardinal;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">for</span>(i=0; i&lt;3; ++i)</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keywordflow">for</span>(j=0; j&lt;3; ++j) <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[i][j]=t3c.tmatrix[i][j];</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7e983515950366013bde880ddb740b36">components_are_orthogonal</a>, and <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>.</p>

</div>
</div>
<a id="a22f733f1d159422844f3091450813445"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22f733f1d159422844f3091450813445">&#9670;&nbsp;</a></span>~CoreSeismogram()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual mspass::seismic::CoreSeismogram::~CoreSeismogram </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Standard destructor. </p>
<div class="fragment"><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;{};</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a1dd1a9469bca89f7e07c6aa928dc4a09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dd1a9469bca89f7e07c6aa928dc4a09">&#9670;&nbsp;</a></span>cardinal()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool mspass::seismic::CoreSeismogram::cardinal </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns true of components are cardinal. </p>
<div class="fragment"><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;{<span class="keywordflow">return</span> <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>;};</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>.</p>

</div>
</div>
<a id="ae043fa67b9d889965ae473da583a1eb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae043fa67b9d889965ae473da583a1eb4">&#9670;&nbsp;</a></span>endtime()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double mspass::seismic::CoreSeismogram::endtime </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns the end time (time associated with last data sample) of this data object. </p>
<div class="fragment"><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  {</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      <span class="keywordflow">return</span>(<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#aeb40f4223a8ee73e79f9af065372a757">mt0</a>+<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#aea80df11992ca2c7ff915aab5fcba6f5">mdt</a>*<span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.<a class="code" href="classmspass_1_1utility_1_1dmatrix.html#ac32006f0dff7ca1b59fa8f3889deb9e5">columns</a>()-1));</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  };</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1utility_1_1dmatrix.html#ac32006f0dff7ca1b59fa8f3889deb9e5">mspass::utility::dmatrix::columns()</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#aea80df11992ca2c7ff915aab5fcba6f5">mspass::seismic::BasicTimeSeries::mdt</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#aeb40f4223a8ee73e79f9af065372a757">mspass::seismic::BasicTimeSeries::mt0</a>, and <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.</p>

</div>
</div>
<a id="adccfb78a6ebcdf62039e5cb351566438"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adccfb78a6ebcdf62039e5cb351566438">&#9670;&nbsp;</a></span>free_surface_transformation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mspass::seismic::CoreSeismogram::free_surface_transformation </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmspass_1_1seismic_1_1_slowness_vector.html">mspass::seismic::SlownessVector</a>&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>vp0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>vs0</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Computes and applies the Kennett [1991] free surface transformation matrix.</p>
<p>Kennett [1991] gives the form for a free surface transformation operator that reduces to a nonorthogonal transformation matrix when the wavefield is not evanescent. On output x1 will be transverse, x2 will be SV (radial), and x3 will be longitudinal.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">u</td><td>slowness vector off the incident wavefield </td></tr>
    <tr><td class="paramname">vp0</td><td>Surface P wave velocity </td></tr>
    <tr><td class="paramname">vs0</td><td>Surface S wave velocity. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;{</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="keywordflow">if</span>( (<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.<a class="code" href="classmspass_1_1utility_1_1dmatrix.html#aa78dbbdf719f69c8422734612e9a56af">size</a>()[1]&lt;=0) || <a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#aa96e795f96b5050996d791f5b6f3867d">dead</a>()) <span class="keywordflow">return</span>; <span class="comment">// do nothing in these situations</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="keywordtype">double</span> a02,b02,pslow,p2;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="keywordtype">double</span> qa,qb,vpz,vpr,vsr,vsz;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    pslow=uvec.mag();</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="comment">// silently do nothing if magnitude of the slowness vector is 0</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="comment">// (vertical incidence)</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="keywordflow">if</span>(pslow&lt;DBL_EPSILON) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="comment">// Can&#39;t handle evanescent waves with this operator</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="keywordtype">double</span> vapparent=1.0/pslow;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keywordflow">if</span>(vapparent&lt;a0 || vapparent&lt;b0)</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    {</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        stringstream ss;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        ss&lt;&lt;<span class="stringliteral">&quot;CoreSeismogram::free_surface_transformation method:  illegal input&quot;</span>&lt;&lt;endl</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;Apparent velocity defined by input slowness vector=&quot;</span>&lt;&lt;vapparent&lt;&lt;endl</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;Smaller than specified surface P velocity=&quot;</span>&lt;&lt;a0&lt;&lt;<span class="stringliteral">&quot; or S velocity=&quot;</span>&lt;&lt;b0&lt;&lt;endl</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;That implies evanescent waves that violate the assumption of this operator&quot;</span>&lt;&lt;endl;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classmspass_1_1utility_1_1_ms_p_a_s_s_error.html">MsPASSError</a>(ss.str(),ErrorSeverity::Invalid);</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    }</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160; </div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="comment">// First the horizonal rotation</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <a class="code" href="structmspass_1_1utility_1_1_spherical_coordinate.html">SphericalCoordinate</a> scor;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="comment">//rotation angle is - azimuth to put x2 (north in standard coord)</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="comment">//in radial direction</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    scor.<a class="code" href="structmspass_1_1utility_1_1_spherical_coordinate.html#a2c970fd569ae883e5545f81e58458ef9">phi</a>=atan2(uvec.uy,uvec.ux);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    scor.<a class="code" href="structmspass_1_1utility_1_1_spherical_coordinate.html#ae06e9f7deab80ef715e5a3629fbab2f7">theta</a>=0.0;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    scor.<a class="code" href="structmspass_1_1utility_1_1_spherical_coordinate.html#a8f9f987e89e175fecb85c9cbe5bdbc13">radius</a>=1.0;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="comment">// after this transformation x1=transverse horizontal</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="comment">// x2=radial horizonal, and x3 is still vertical</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#ab52a292c7c7bc8fc5fef68db9eb847e0">rotate</a>(scor);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160; </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    a02=a0*a0;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    b02=b0*b0;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    p2=pslow*pslow;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    qa=sqrt((1.0/a02)-p2);</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    qb=sqrt((1.0/b02)-p2);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    vpz=-(1.0-2.0*b02*p2)/(2.0*a0*qa);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    vpr=pslow*b02/a0;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    vsr=(1.0-2.0*b02*p2)/(2.0*b0*qb);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    vsz=pslow*b0;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="comment">/* Now construct the transformation matrix</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment">     This is different from Bostock&#39;s original code</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment">     in sign and order.  Also note this transformation</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment">         is not scaled to have a unit matrix norm so amplitudes</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment">         after the transformation are distorted.  rotate_to_standard,</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment">         however, should still restore original data within roundoff</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment">         error if called on the result. */</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keywordtype">double</span> fstran[3][3];</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    fstran[0][0]=0.5;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    fstran[0][1]=0.0;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    fstran[0][2]=0.0;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    fstran[1][0]=0.0;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    fstran[1][1]=vsr;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    fstran[1][2]=vpr;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    fstran[2][0]=0.0;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    fstran[2][1]=-vsz;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    fstran[2][2]=-vpz;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#ae9ea31f9e36577a51660c61e0749d4a6">transform</a>(fstran);</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160; </div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7e983515950366013bde880ddb740b36">components_are_orthogonal</a>=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7e983515950366013bde880ddb740b36">components_are_orthogonal</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#aa96e795f96b5050996d791f5b6f3867d">mspass::seismic::BasicTimeSeries::dead()</a>, <a class="el" href="classmspass_1_1seismic_1_1_slowness_vector.html#a2e1d2b9fb9e0267ffa99ccf3291f5540">mspass::seismic::SlownessVector::mag()</a>, <a class="el" href="structmspass_1_1utility_1_1_spherical_coordinate.html#a2c970fd569ae883e5545f81e58458ef9">mspass::utility::SphericalCoordinate::phi</a>, <a class="el" href="structmspass_1_1utility_1_1_spherical_coordinate.html#a8f9f987e89e175fecb85c9cbe5bdbc13">mspass::utility::SphericalCoordinate::radius</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#ab52a292c7c7bc8fc5fef68db9eb847e0">rotate()</a>, <a class="el" href="classmspass_1_1utility_1_1dmatrix.html#aa78dbbdf719f69c8422734612e9a56af">mspass::utility::dmatrix::size()</a>, <a class="el" href="structmspass_1_1utility_1_1_spherical_coordinate.html#ae06e9f7deab80ef715e5a3629fbab2f7">mspass::utility::SphericalCoordinate::theta</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#ae9ea31f9e36577a51660c61e0749d4a6">transform()</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>, <a class="el" href="classmspass_1_1seismic_1_1_slowness_vector.html#aed8526fcbb32eb86bfb4f193d2ff03f9">mspass::seismic::SlownessVector::ux</a>, and <a class="el" href="classmspass_1_1seismic_1_1_slowness_vector.html#a2a7134614117cc5a648a1d292021fab0">mspass::seismic::SlownessVector::uy</a>.</p>

</div>
</div>
<a id="aae2950b408052bda849ba07c4ea9b018"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae2950b408052bda849ba07c4ea9b018">&#9670;&nbsp;</a></span>get_transformation_matrix()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmspass_1_1utility_1_1dmatrix.html">mspass::utility::dmatrix</a> mspass::seismic::CoreSeismogram::get_transformation_matrix </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return current transformation matrix.</p>
<p>The transformation matrix is maintained internally in this object. Transformations like rotations and the transform method can change make this matrix not an identity matrix. It should always be an identity matrix when the coordinates are cardinal (i.e. ENZ).</p>
<dl class="section return"><dt>Returns</dt><dd>3x3 transformation matrix. </dd></dl>
<div class="fragment"><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      <a class="code" href="classmspass_1_1utility_1_1dmatrix.html">mspass::utility::dmatrix</a> result(3,3);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;3;++i)</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;3;++j) result(i,j)=<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[i][j];</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  };</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>.</p>

</div>
</div>
<a id="acb19d36d0e3ed2e52eb77da34c65f4f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb19d36d0e3ed2e52eb77da34c65f4f3">&#9670;&nbsp;</a></span>operator*=()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html">CoreSeismogram</a> &amp; mspass::seismic::CoreSeismogram::operator*= </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>scale</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Multiply data by a scalar. </p>
<div class="fragment"><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;{</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  <span class="comment">/* do nothing to empty data or data marked dead*/</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  <span class="keywordflow">if</span>((this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a347b349bb4e1f0e65978dfcd45ae3472">npts</a>()==0) || (this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#aa96e795f96b5050996d791f5b6f3867d">dead</a>())) <span class="keywordflow">return</span>(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="comment">/* We can use this dscal blas function because dmatrix puts all the data</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment">  in a continguous block. Beware if there is am implementation change for</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment">  the matrix data*/</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  <span class="keywordtype">double</span> *ptr=this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.get_address(0,0);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  dscal(3*this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a347b349bb4e1f0e65978dfcd45ae3472">npts</a>(),scale,ptr,1);</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  <span class="keywordflow">return</span>(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#aa96e795f96b5050996d791f5b6f3867d">mspass::seismic::BasicTimeSeries::dead()</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a347b349bb4e1f0e65978dfcd45ae3472">mspass::seismic::BasicTimeSeries::npts()</a>, and <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.</p>

</div>
</div>
<a id="a0254f287fe5fb2217fcda0131b65410f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0254f287fe5fb2217fcda0131b65410f">&#9670;&nbsp;</a></span>operator+()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html">CoreSeismogram</a> mspass::seismic::CoreSeismogram::operator+ </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html">CoreSeismogram</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Addition operator.</p>
<p>This operator is implemented in a standard way utilizing operator+=. For data with irregular start and end times that has an important consequence; the operator is not communative. i.e given x an y z=x+y will not yield the same result as z=y+x. </p>
<div class="fragment"><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;{</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9be7b3811cfcd0b0396b32214d7eab51">CoreSeismogram</a> result(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  result += other;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4824e03f8697c3f36fa7957bb82e122c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4824e03f8697c3f36fa7957bb82e122c">&#9670;&nbsp;</a></span>operator+=()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html">CoreSeismogram</a> &amp; mspass::seismic::CoreSeismogram::operator+= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html">CoreSeismogram</a> &amp;&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Summation operator. </p>
<p>Summing data from signals of irregular length requires handling potential mismatches in size and overlap. This behaves the way a += operator should logically behave in that situation. That is, because the lhs is where the sum is being accumulated, the size is always controlled by the left hand side of the operator. Any portions of the right hand side that are outside the t0 to <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#ae043fa67b9d889965ae473da583a1eb4">endtime()</a> of the left hand side are silently discarded. If the start time of the right hand side is greater than t0 or the endtime is less than endtime of the lhs there will be discontinuties in the sum there the ends of the rhs are inside the range of the lhs.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>is other signal to add to this. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">MsPASSError</td><td>can be thrown if lhs and rhs do not have matching time standards. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;{</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="keywordtype">int</span> i,iend,jend;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="keywordtype">size_t</span> j,i0,j0;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="comment">// Silently do nothing if d or lhs is marked dead</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="keywordflow">if</span>( d.dead() || (this-&gt;dead()) ) <span class="keywordflow">return</span>(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="comment">// Silently do nothing if d does not overlap with data to contain sum</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <span class="keywordflow">if</span>( (d.endtime()&lt;<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#aeb40f4223a8ee73e79f9af065372a757">mt0</a>)</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;            || (d.mt0&gt;(this-&gt;endtime())) ) <span class="keywordflow">return</span>(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="keywordflow">if</span>(d.tref!=(this-&gt;tref))</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classmspass_1_1utility_1_1_ms_p_a_s_s_error.html">MsPASSError</a>(<span class="stringliteral">&quot;CoreSeismogram += operator cannot handle data with inconsistent time base\n&quot;</span>,</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                          ErrorSeverity::Invalid);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="comment">/* this defines the range of left and right hand sides to be summed */</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    i=d.sample_number(this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#aeb40f4223a8ee73e79f9af065372a757">mt0</a>);</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="keywordflow">if</span>(i&lt;0)</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    {</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;      j0=this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#abe28ca2812a2ac21dd2196385ad106ab">sample_number</a>(d.t0());</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;      i0=0;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    }</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    {</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;      j0=0;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;      i0=i;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    }</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    iend=d.sample_number(this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#ae043fa67b9d889965ae473da583a1eb4">endtime</a>());</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    jend=this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#abe28ca2812a2ac21dd2196385ad106ab">sample_number</a>(d.endtime());</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="keywordflow">if</span>(iend&gt;=(d.npts()))</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    {</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        iend=d.npts()-1;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    }</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="keywordflow">if</span>(jend&gt;=this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a347b349bb4e1f0e65978dfcd45ae3472">npts</a>())</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    {</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      jend=this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a347b349bb4e1f0e65978dfcd45ae3472">npts</a>()-1;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    }</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <span class="keywordflow">for</span>(i=i0,j=j0; i&lt;=iend &amp;&amp; j&lt;=jend; ++i,++j)</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    {</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>(0,j)+=d.u(0,i);</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>(1,j)+=d.u(1,i);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>(2,j)+=d.u(2,i);</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    }</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordflow">return</span>(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#aa96e795f96b5050996d791f5b6f3867d">mspass::seismic::BasicTimeSeries::dead()</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#ae043fa67b9d889965ae473da583a1eb4">endtime()</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#aeb40f4223a8ee73e79f9af065372a757">mspass::seismic::BasicTimeSeries::mt0</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a347b349bb4e1f0e65978dfcd45ae3472">mspass::seismic::BasicTimeSeries::npts()</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#abe28ca2812a2ac21dd2196385ad106ab">mspass::seismic::BasicTimeSeries::sample_number()</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a472074f3074d59f794d18017b010ab81">mspass::seismic::BasicTimeSeries::t0()</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#abb88ddef3bab3b3205dfe6c6cfdb91aa">mspass::seismic::BasicTimeSeries::tref</a>, and <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.</p>

</div>
</div>
<a id="ac44e27ef57299045b2e0c7a252e32a89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac44e27ef57299045b2e0c7a252e32a89">&#9670;&nbsp;</a></span>operator-()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html">CoreSeismogram</a> mspass::seismic::CoreSeismogram::operator- </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html">CoreSeismogram</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Subtraction operator.</p>
<p>This operator is implemented in a standard way utilizing operator-=. For data with irregular start and end times that has an important consequence; the operator is not communative. i.e given x an y z=x-y will not yield the same result as z=-(y-x). </p>
<div class="fragment"><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;{</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9be7b3811cfcd0b0396b32214d7eab51">CoreSeismogram</a> result(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  result -= other;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af749235404f3cf11808598ef133bf781"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af749235404f3cf11808598ef133bf781">&#9670;&nbsp;</a></span>operator-=()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html">CoreSeismogram</a> &amp; mspass::seismic::CoreSeismogram::operator-= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html">CoreSeismogram</a> &amp;&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subtraction operator. </p>
<p>Differencing data from signals of irregular length requires handling potential mismatches in size and overlap. This behaves the way a -= operator should logically behave in that situation. That is, because the lhs is where the sum is being accumulated, the size is always controlled by the left hand side of the operator. Any portions of the right hand side that are outside the t0 to <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#ae043fa67b9d889965ae473da583a1eb4">endtime()</a> of the left hand side are silently discarded. If the start time of the right hand side is greater than t0 or the endtime is less than endtime of the lhs there will be discontinuties in the sum there the ends of the rhs are inside the range of the lhs.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>is other signal to subract from this. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">MsPASSError</td><td>can be thrown if lhs and rhs do not have matching time standards. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;{</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <span class="keywordtype">int</span> i,iend,jend;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="keywordtype">size_t</span> j,i0,j0;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <span class="comment">// Sun&#39;s compiler complains about const objects without this.</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9be7b3811cfcd0b0396b32214d7eab51">CoreSeismogram</a>&amp; d=<span class="keyword">const_cast&lt;</span><a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9be7b3811cfcd0b0396b32214d7eab51">CoreSeismogram</a>&amp;<span class="keyword">&gt;</span>(data);</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <span class="comment">// Silently do nothing if d is marked dead</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="keywordflow">if</span>(!d.mlive) <span class="keywordflow">return</span>(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    <span class="comment">// Silently do nothing if d does not overlap with data to contain sum</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="keywordflow">if</span>( (d.endtime()&lt;<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#aeb40f4223a8ee73e79f9af065372a757">mt0</a>)</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;            || (d.mt0&gt;(this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#ae043fa67b9d889965ae473da583a1eb4">endtime</a>())) ) <span class="keywordflow">return</span>(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <span class="keywordflow">if</span>(d.tref!=(this-&gt;tref))</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classmspass_1_1utility_1_1_ms_p_a_s_s_error.html">MsPASSError</a>(<span class="stringliteral">&quot;CoreSeismogram += operator cannot handle data with inconsistent time base\n&quot;</span>,</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                          ErrorSeverity::Invalid);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <span class="comment">/* this defines the range of left and right hand sides to be summed */</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    i=d.sample_number(this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#aeb40f4223a8ee73e79f9af065372a757">mt0</a>);</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <span class="keywordflow">if</span>(i&lt;0)</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    {</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;      j0=this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#abe28ca2812a2ac21dd2196385ad106ab">sample_number</a>(d.t0());</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      i0=0;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    }</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    {</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;      j0=0;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;      i0=i;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    }</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    iend=d.sample_number(this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#ae043fa67b9d889965ae473da583a1eb4">endtime</a>());</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    jend=this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#abe28ca2812a2ac21dd2196385ad106ab">sample_number</a>(d.endtime());</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <span class="keywordflow">if</span>(iend&gt;=(d.npts()))</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    {</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        iend=d.npts()-1;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    }</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keywordflow">if</span>(jend&gt;=this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a347b349bb4e1f0e65978dfcd45ae3472">npts</a>())</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    {</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;      jend=this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a347b349bb4e1f0e65978dfcd45ae3472">npts</a>()-1;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    }</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <span class="keywordflow">for</span>(i=i0,j=j0; i&lt;=iend &amp;&amp; j&lt;=jend; ++i,++j)</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    {</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>(0,j)-=d.u(0,i);</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>(1,j)-=d.u(1,i);</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>(2,j)-=d.u(2,i);</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    }</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="keywordflow">return</span>(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#ae043fa67b9d889965ae473da583a1eb4">endtime()</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a7b2e9b878959d376790f09194edc51d9">mspass::seismic::BasicTimeSeries::mlive</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#aeb40f4223a8ee73e79f9af065372a757">mspass::seismic::BasicTimeSeries::mt0</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a347b349bb4e1f0e65978dfcd45ae3472">mspass::seismic::BasicTimeSeries::npts()</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#abe28ca2812a2ac21dd2196385ad106ab">mspass::seismic::BasicTimeSeries::sample_number()</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a472074f3074d59f794d18017b010ab81">mspass::seismic::BasicTimeSeries::t0()</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#abb88ddef3bab3b3205dfe6c6cfdb91aa">mspass::seismic::BasicTimeSeries::tref</a>, and <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.</p>

</div>
</div>
<a id="aaa906f3915cfd8ba04adefedc35032e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa906f3915cfd8ba04adefedc35032e7">&#9670;&nbsp;</a></span>operator=()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html">CoreSeismogram</a> &amp; mspass::seismic::CoreSeismogram::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html">CoreSeismogram</a> &amp;&#160;</td>
          <td class="paramname"><em>seisin</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Standard assignment operator. </p>
<div class="fragment"><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;{</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="keywordflow">if</span>(<span class="keyword">this</span>!=&amp;seisin)</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    {</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#aaf05bc1fe471e194bec093906c1a607c">BasicTimeSeries::operator=</a>(seisin);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        this-&gt;<a class="code" href="classmspass_1_1utility_1_1_metadata.html#aadbae283dfdb87a82832519a9955fdfa">Metadata::operator=</a>(seisin);</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7e983515950366013bde880ddb740b36">components_are_orthogonal</a>=seisin.components_are_orthogonal;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>=seisin.components_are_cardinal;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;3; ++i)</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        {</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;3; ++j)</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;            {</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[i][j]=seisin.tmatrix[i][j];</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;            }</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        }</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>=seisin.u;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    }</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="keywordflow">return</span>(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7e983515950366013bde880ddb740b36">components_are_orthogonal</a>, <a class="el" href="classmspass_1_1utility_1_1_metadata.html#aadbae283dfdb87a82832519a9955fdfa">mspass::utility::Metadata::operator=()</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#aaf05bc1fe471e194bec093906c1a607c">mspass::seismic::BasicTimeSeries::operator=()</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>, and <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.</p>

</div>
</div>
<a id="abdf52d3336018194da73d6832150169d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdf52d3336018194da73d6832150169d">&#9670;&nbsp;</a></span>operator[]() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; double &gt; mspass::seismic::CoreSeismogram::operator[] </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>time</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Overloaded version of operator[] for time. </p>
<p>Sometimes it is useful to ask for data at a specified time without worrying about the time conversion. This simplifies that process. It is still subject to an exception if the the time requested is outside the data range.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">time</td><td>is the time of the requested sample </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>3 vector of data samples at requested time </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">MsPASSError</td><td>will be thrown if the time is outside the data range. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;{</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        vector&lt;double&gt; result;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        <span class="keywordtype">int</span> i=this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#abe28ca2812a2ac21dd2196385ad106ab">sample_number</a>(t);</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        <span class="comment">/* could test for a negative i and i too large but we assume</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="comment">        the dmatrix container will throw an exception if it resolves that way*/</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0;k&lt;3;++k)</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;          result.push_back(this-&gt;u(k,i));</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;        <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    }<span class="keywordflow">catch</span>(...){<span class="keywordflow">throw</span>;};</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#abe28ca2812a2ac21dd2196385ad106ab">mspass::seismic::BasicTimeSeries::sample_number()</a>.</p>

</div>
</div>
<a id="a1b8fc85ca5a5e14d2e2cdd51a9697fcc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b8fc85ca5a5e14d2e2cdd51a9697fcc">&#9670;&nbsp;</a></span>operator[]() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; double &gt; mspass::seismic::CoreSeismogram::operator[] </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>sample</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Extract a sample from data vector.</p>
<p>A sample in this context means a three-vector at a requested sample index. Range checking is implicit because of the internal use of the dmatrix to store the samples of data. This operator is an alternative to extracting samples through indexing of the internal dmatrix u that holds the data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sample</td><td>is the sample number requested (must be in range or an exception will be thrown)</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">MsPASSError</td><td>if the requested sample is outside the range of the data. Note this includes an implicit "outside" defined when the contents are marked dead. Note the code does this by catching an error thrown by dmatrix in this situation, printing the error message from the dmatrix object, and then throwing a new SeisppError with a shorter message. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>std::vector containing a 3 vector of the samples at requested sample number</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sample</td><td>is the integer sample number of data desired. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;{</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        vector&lt;double&gt; result;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        result.reserve(3);</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0;k&lt;3;++k)</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;          result.push_back(this-&gt;u(k,i));</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    }<span class="keywordflow">catch</span>(...){<span class="keywordflow">throw</span>;};</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a41711bd9b0c88089e6e217f318c01de2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41711bd9b0c88089e6e217f318c01de2">&#9670;&nbsp;</a></span>orthogonal()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool mspass::seismic::CoreSeismogram::orthogonal </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return true if the components are orthogonal. </p>
<div class="fragment"><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;{<span class="keywordflow">return</span> <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7e983515950366013bde880ddb740b36">components_are_orthogonal</a>;};</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7e983515950366013bde880ddb740b36">components_are_orthogonal</a>.</p>

</div>
</div>
<a id="a8bfacfda2b33e2df7938695126fbb0db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bfacfda2b33e2df7938695126fbb0db">&#9670;&nbsp;</a></span>rotate() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mspass::seismic::CoreSeismogram::rotate </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>nu</em>[3]</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Rotate data using a P wave type coordinate definition.</p>
<p>In seismology the longitudinal motion direction of a P wave defines a direction in space. This method rotates the data into a coordinate system defined by a direction passed through the argument. The data are rotated such that x1 becomes the transverse component, x2 becomes radial, and x3 becomes longitudinal. In the special case for a vector pointing in the x3 direction the data are not altered.</p>
<p>This method effectively turns nu into a SphericalCoordinate object and calles the related rotate method that has a SphericalCoordinate object as an argument. The potential confusion of orientation is not as extreme here. After the transformation x3prime will point in the direction of nu, x2 will be in the x3-x3prime plane (rotation by theta) and orthogonal to x3prime, and x1 will be horizontal and perpendicular to x2prime and x3prime.</p>
<p>A VERY IMPORTANT thing to recognize about this tranformation is it will always yield a result relative to cardinal coordinates. i.e. if the data had been previously rotated or were not originally in ENZ form they will be first transformed to ENZ before actually performing this transformation. Use the transform or horizontal rotation method to</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nu</td><td>defines direction of x3 direction (longitudinal) as a unit vector with three components. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;{</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="keywordflow">if</span>( (<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.<a class="code" href="classmspass_1_1utility_1_1dmatrix.html#aa78dbbdf719f69c8422734612e9a56af">size</a>()[1]&lt;=0) || this-&gt;dead()) <span class="keywordflow">return</span>; <span class="comment">// do nothing in these situations</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <a class="code" href="structmspass_1_1utility_1_1_spherical_coordinate.html">SphericalCoordinate</a> xsc=UnitVectorToSpherical(nu);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#ab52a292c7c7bc8fc5fef68db9eb847e0">rotate</a>(xsc);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#ab52a292c7c7bc8fc5fef68db9eb847e0">rotate()</a>, <a class="el" href="classmspass_1_1utility_1_1dmatrix.html#aa78dbbdf719f69c8422734612e9a56af">mspass::utility::dmatrix::size()</a>, and <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.</p>

</div>
</div>
<a id="a895a06c26825e8abe8c8617622cf8d5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a895a06c26825e8abe8c8617622cf8d5e">&#9670;&nbsp;</a></span>rotate() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mspass::seismic::CoreSeismogram::rotate </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>phi</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate horizontals by a simple angle in degrees. </p>
<pre class="fragment">A common transformation in 3C processing is a rotation of the
horizontal components by an angle.  This leaves the vertical
(assumed here x3) unaltered.   This routine rotates the horizontals
by angle phi using with positive phi counterclockwise as in
polar coordinates and the azimuth angle of spherical coordinates.

Note this transformation is cummulative.  i.e. this transformation
is cumulative.  The internal transformation matrix will be updated.
This is a useful feature for things like incremental horizontal
rotation in rotational angle grid searches.

\param phi rotation angle around x3 axis in counterclockwise
  direction (in radians).
</pre> <div class="fragment"><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;{</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordflow">if</span>( (<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.<a class="code" href="classmspass_1_1utility_1_1dmatrix.html#aa78dbbdf719f69c8422734612e9a56af">size</a>()[1]&lt;=0) || <a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#aa96e795f96b5050996d791f5b6f3867d">dead</a>()) <span class="keywordflow">return</span>; <span class="comment">// do nothing in these situations</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keywordtype">int</span> i,j,k;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordtype">double</span> a,b;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    a=cos(phi);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    b=sin(phi);</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="keywordtype">double</span> tmnew[3][3];</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    tmnew[0][0] = a;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    tmnew[1][0] = b;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    tmnew[2][0] = 0.0;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    tmnew[0][1] = -b;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    tmnew[1][1] = a;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    tmnew[2][1] = 0.0;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    tmnew[0][2] = 0.0;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    tmnew[1][2] = 0.0;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    tmnew[2][2] = 1.0;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="comment">/* Now multiply the data by this transformation matrix.</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment">     Not trick in this i only goes to 2 because 3 component</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">     is an identity.*/</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="keywordtype">double</span> *work[2];</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="keywordflow">for</span>(i=0; i&lt;2; ++i)work[i] = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>];</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="keywordflow">for</span>(i=0; i&lt;2; ++i)</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    {</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        dcopy(<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>,<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.get_address(0,0),3,work[i],1);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        dscal(<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>,tmnew[i][0],work[i],1);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        daxpy(<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>,tmnew[i][1],<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.get_address(1,0),3,work[i],1);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    }</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keywordflow">for</span>(i=0; i&lt;2; ++i) dcopy(<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>,work[i],1,<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.get_address(i,0),3);</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="keywordtype">double</span> tm_tmp[3][3];</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="keywordtype">double</span> prod;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="keywordflow">for</span>(i=0; i&lt;3; ++i)</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        <span class="keywordflow">for</span>(j=0; j&lt;3; ++j)</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        {</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            <span class="keywordflow">for</span>(prod=0.0,k=0; k&lt;3; ++k)</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                prod+=tmnew[i][k]*<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[k][j];</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;            tm_tmp[i][j]=prod;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        }</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="keywordflow">for</span>(i=0; i&lt;3; ++i)</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        <span class="keywordflow">for</span>(j=0; j&lt;3; ++j)<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[i][j]=tm_tmp[i][j];</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="keywordflow">for</span>(i=0; i&lt;2; ++i) <span class="keyword">delete</span> [] work[i];</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#aa96e795f96b5050996d791f5b6f3867d">mspass::seismic::BasicTimeSeries::dead()</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">mspass::seismic::BasicTimeSeries::nsamp</a>, <a class="el" href="classmspass_1_1utility_1_1dmatrix.html#aa78dbbdf719f69c8422734612e9a56af">mspass::utility::dmatrix::size()</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>, and <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.</p>

</div>
</div>
<a id="ab52a292c7c7bc8fc5fef68db9eb847e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab52a292c7c7bc8fc5fef68db9eb847e0">&#9670;&nbsp;</a></span>rotate() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mspass::seismic::CoreSeismogram::rotate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmspass_1_1utility_1_1_spherical_coordinate.html">mspass::utility::SphericalCoordinate</a> &amp;&#160;</td>
          <td class="paramname"><em>sc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Rotate data using a P wave type coordinate definition.</p>
<p>In seismology the longitudinal motion direction of a P wave defines a direction in space. This method rotates the data into a coordinate system defined by a direction passed through the argument. The data are rotated such that x1 becomes the transverse component, x2 becomes radial, and x3 becomes longitudinal. In the special case for a vector pointing in the x3 direction the data are not altered. The transformation matrix is effectively the matrix product of two coordinate rotations: (1) rotation around x3 by angle phi and (2) rotation around x1 by theta.</p>
<p>The sense of this transformation is confusing because of a difference in convention between spherical coordinates and standard earth coordinates. In particular, orientation on the earth uses a convention with x2 being the x2 axis and bearings are relative to that with a standard azimuth measured clockwise from north. Spherical coordinate angle phi (used here) is measured counterclockwise relative to the x1 axis, which is east in standard earth coordinates. This transformation is computed using a phi angle. To use this then to compute a transformation to standard ray coordinates with x2 pointing in the direction of wavefront advance, phi should be set to pi/2-azimuth which gives the phi angle needed to rotate x2 to radial. This is extremely confusing because in spherical coordinates it would be more intuitive to rotate x1 to radial, but this is NOT the convention used here. In general to use this feature the best way to avoid this confusion is to use the PMHalfSpaceModel procedure to compute a SphericalCoordinate object consistent with given propagation direction defined by a slowness vector. Alternatively, use the free_surface_transformation method defined below.</p>
<p>A VERY IMPORTANT thing to recognize about this tranformation is it will always yield a result relative to cardinal coordinates. i.e. if the data had been previously rotated or were not originally in ENZ form they will be first transformed to ENZ before actually performing this transformation. Use the transform or horizontal rotation method to create cummulative transformations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sc</td><td>defines final x3 direction (longitudinal) in a spherical coordinate structure. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;{</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="keywordflow">if</span>( (<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.<a class="code" href="classmspass_1_1utility_1_1dmatrix.html#aa78dbbdf719f69c8422734612e9a56af">size</a>()[1]&lt;=0) || <a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#aa96e795f96b5050996d791f5b6f3867d">dead</a>()) <span class="keywordflow">return</span>; <span class="comment">// do nothing in these situations</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="comment">//Earlier version had a reset of the nsamp variable here - we need to trust</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="comment">//that is correct here for efficiency.  We the new API it would be hard</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="comment">//to have that happen. without a serious blunder</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordtype">double</span> theta, phi;  <span class="comment">/* corrected angles after dealing with signs */</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="keywordtype">double</span> a,b,c,d;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160; </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="comment">//Undo any previous transformations</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a756ee542caaa6001f9f40fed3607ff7e">rotate_to_standard</a>();</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="keywordflow">if</span>(xsc.theta == M_PI)</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    {</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <span class="comment">//This will be left handed</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[2][2] = -1.0;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        dscal(<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>,-1.0,<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.get_address(2,0),3);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    }</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keywordflow">if</span>(xsc.theta &lt; 0.0)</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    {</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        theta = -(xsc.theta);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        phi = xsc.phi + M_PI;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <span class="keywordflow">if</span>(phi &gt; M_PI) phi -= (2.0*M_PI);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    }</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(xsc.theta &gt; M_PI)</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    {</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        theta = xsc.theta - M_PI;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        phi = xsc.phi + M_PI;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="keywordflow">if</span>(phi &gt; M_PI) phi -= (2.0*M_PI);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    }</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    {</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        theta = xsc.theta;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        phi = xsc.phi;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    }</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="comment">/* Am using a formula here for azimuth with is pi/2 - phi*/</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keywordtype">double</span> azimuth=M_PI_2-phi;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    a = cos(azimuth);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    b = sin(azimuth);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    c = cos(theta);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    d = sin(theta);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[0][0] = a;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[1][0] = b*c;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[2][0] = b*d;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[0][1] = -b;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[1][1] = a*c;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[2][1] = a*d;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[0][2] = 0.0;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[1][2] = -d;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[2][2] = c;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="comment">/* Now multiply the data by this transformation matrix.  */</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keywordtype">double</span> *work[3];</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordflow">for</span>(i=0; i&lt;3; ++i)work[i] = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>];</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="keywordflow">for</span>(i=0; i&lt;3; ++i)</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    {</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        dcopy(<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>,<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.get_address(0,0),3,work[i],1);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        dscal(<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>,<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[i][0],work[i],1);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        daxpy(<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>,<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[i][1],<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.get_address(1,0),3,work[i],1);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        daxpy(<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>,<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[i][2],<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.get_address(2,0),3,work[i],1);</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    }</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordflow">for</span>(i=0; i&lt;3; ++i) dcopy(<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>,work[i],1,<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.get_address(i,0),3);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keywordflow">for</span>(i=0; i&lt;3; ++i) <span class="keyword">delete</span> [] work[i];</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#aa96e795f96b5050996d791f5b6f3867d">mspass::seismic::BasicTimeSeries::dead()</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">mspass::seismic::BasicTimeSeries::nsamp</a>, <a class="el" href="structmspass_1_1utility_1_1_spherical_coordinate.html#a2c970fd569ae883e5545f81e58458ef9">mspass::utility::SphericalCoordinate::phi</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a756ee542caaa6001f9f40fed3607ff7e">rotate_to_standard()</a>, <a class="el" href="classmspass_1_1utility_1_1dmatrix.html#aa78dbbdf719f69c8422734612e9a56af">mspass::utility::dmatrix::size()</a>, <a class="el" href="structmspass_1_1utility_1_1_spherical_coordinate.html#ae06e9f7deab80ef715e5a3629fbab2f7">mspass::utility::SphericalCoordinate::theta</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>, and <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.</p>

</div>
</div>
<a id="a756ee542caaa6001f9f40fed3607ff7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a756ee542caaa6001f9f40fed3607ff7e">&#9670;&nbsp;</a></span>rotate_to_standard()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mspass::seismic::CoreSeismogram::rotate_to_standard </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Apply inverse transformation matrix to return data to cardinal direction components.</p>
<p>It is frequently necessary to make certain a set of three component data are oriented to the standard reference frame (EW, NS, Vertical). This function does this. For efficiency it checks the components_are_cardinal variable and does nothing if it is set true. Otherwise, it applies the inverse transformation and then sets this variable true. Note even if the current transformation matrix is not orthogonal it will be put back into cardinal coordinates. </p><dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SeisppError</td><td>thrown if the an inversion of the transformation matrix is required and that matrix is singular. This can happen if the transformation matrix is incorrectly defined or the actual data are coplanar. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;{</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordflow">if</span>( (<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.<a class="code" href="classmspass_1_1utility_1_1dmatrix.html#aa78dbbdf719f69c8422734612e9a56af">size</a>()[1]&lt;=0) || this-&gt;dead()) <span class="keywordflow">return</span>; <span class="comment">// do nothing in these situations</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordtype">double</span> *work[3];</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordtype">int</span> i,j;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment">/* We assume nsamp is the number of samples = number of columns in u - we don&#39;t</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">    check here for efficiency */</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">for</span>(j=0; j&lt;3; ++j) work[j]=<span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>];</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7e983515950366013bde880ddb740b36">components_are_orthogonal</a>)</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <span class="comment">//Use a daxpy algorithm.  tmatrix stores the</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <span class="comment">//forward transformation used to get current</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="comment">//Use the transpose to get back</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <span class="keywordflow">for</span>(i=0; i&lt;3; ++i)</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            <span class="comment">// x has a stride of 3 because we store in fortran order in x</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            dcopy(<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>,<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.get_address(0,0),3,work[i],1);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            dscal(<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>,<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[0][i],work[i],1);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            daxpy(<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>,<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[1][i],<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.get_address(1,0),3,work[i],1);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            daxpy(<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>,<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[2][i],<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.get_address(2,0),3,work[i],1);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        }</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="keywordflow">for</span>(i=0; i&lt;3; ++i) dcopy(<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>,work[i],1,<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.get_address(i,0),3);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="comment">//Enter here only when the transformation matrix is</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="comment">//not orthogonal.  We have to construct a fortran</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="comment">//order matrix a to use LINPACK routine in sunperf/perf</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="comment">//This could be done with the matrix template library</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="comment">//but the overhead ain&#39;t worth it</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="keywordtype">double</span> a[9];</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="keywordtype">int</span> ipivot[3];</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <span class="keywordtype">int</span> info;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        a[0] = <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[0][0];</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        a[1] = <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[1][0];</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        a[2] = <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[2][0];</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        a[3] = <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[0][1];</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        a[4] = <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[1][1];</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        a[5] = <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[2][1];</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        a[6] = <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[0][2];</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        a[7] = <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[1][2];</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        a[8] = <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[2][2];</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="comment">//LAPACK routine with FORTRAN interface using pass by reference and pointers</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <span class="keywordtype">int</span> three(3);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        dgetrf(three,three,a,three,ipivot,info);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="keywordflow">if</span>(info!=0)</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            <span class="keywordflow">for</span>(i=0; i&lt;3; ++i) <span class="keyword">delete</span> [] work[i];</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            <span class="keywordflow">throw</span>(<a class="code" href="classmspass_1_1utility_1_1_ms_p_a_s_s_error.html">MsPASSError</a>(</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                      <span class="keywordtype">string</span>(<span class="stringliteral">&quot;rotate_to_standard:  LU factorization of transformation matrix failed&quot;</span>)),</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                  ErrorSeverity::Invalid);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        }</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <span class="comment">// inversion routine after factorization from lapack FORT$RAN interface</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="keywordtype">double</span> awork[10];  <span class="comment">//Larger than required but safety value small cost</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <span class="keywordtype">int</span> ldwork(10);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        dgetri(three,a,three,ipivot,awork,ldwork,info);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="comment">// This is the openblas version</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <span class="comment">//info=LAPACKE_dgetri(LAPACK_COL_MAJOR,3,a,3,ipivot);</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="keywordflow">if</span>(info!=0)</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        {</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            <span class="keywordflow">for</span>(i=0; i&lt;3; ++i) <span class="keyword">delete</span> [] work[i];</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            <span class="keywordflow">throw</span>(<a class="code" href="classmspass_1_1utility_1_1_ms_p_a_s_s_error.html">MsPASSError</a>(</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                      <span class="keywordtype">string</span>(<span class="stringliteral">&quot;rotate_to_standard:  LU factorization inversion of transformation matrix failed&quot;</span>)),</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                  ErrorSeverity::Invalid);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        }</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[0][0] = a[0];</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[1][0] = a[1];</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[2][0] = a[2];</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[0][1] = a[3];</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[1][1] = a[4];</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[2][1] = a[5];</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[0][2] = a[6];</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[1][2] = a[7];</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[2][2] = a[8];</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="comment">/* The inverse is now in tmatrix so we reverse the</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">           rows and columms from above loop */</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <span class="keywordflow">for</span>(i=0; i&lt;3; ++i)</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        {</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            dcopy(<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>,<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.get_address(0,0),3,work[i],1);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            dscal(<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>,<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[i][0],work[i],1);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            daxpy(<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>,<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[i][1],<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.get_address(1,0),3,work[i],1);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            daxpy(<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>,<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[i][2],<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.get_address(2,0),3,work[i],1);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        }</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="keywordflow">for</span>(i=0; i&lt;3; ++i) dcopy(<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>,work[i],1,<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.get_address(i,0),3);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7e983515950366013bde880ddb740b36">components_are_orthogonal</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    }</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="comment">//Have to set the transformation matrix to an identity now</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordflow">for</span>(i=0; i&lt;3; ++i)</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <span class="keywordflow">for</span>(j=0; j&lt;3; ++j)</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            <span class="keywordflow">if</span>(i==j)</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[i][i]=1.0;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[i][j]=0.0;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordflow">for</span>(i=0; i&lt;3; ++i) <span class="keyword">delete</span> [] work[i];</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7e983515950366013bde880ddb740b36">components_are_orthogonal</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">mspass::seismic::BasicTimeSeries::nsamp</a>, <a class="el" href="classmspass_1_1utility_1_1dmatrix.html#aa78dbbdf719f69c8422734612e9a56af">mspass::utility::dmatrix::size()</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>, and <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.</p>

</div>
</div>
<a id="a5e51c2c6d3a1aa02281ba242a1d15bf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e51c2c6d3a1aa02281ba242a1d15bf2">&#9670;&nbsp;</a></span>set_dt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void mspass::seismic::CoreSeismogram::set_dt </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>sample_interval</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the sample interval. </p>
<p>This method is complicated by the need to sync the changed value with Metadata. That is further complicated by the need to support aliases for the keys used to defined dt in Metadata. That is handled by first setting the internal dt value and then going through a fixed list of valid alias keys for dt. Any that exist are changed. If none were previously defined the unique name (see documentation) is added to Metadata.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sample_interval</td><td>is the new data sample interval to be used. </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a1813dfea28479ff50528e8ed008e62e8">mspass::seismic::BasicTimeSeries</a>.</p>
<div class="fragment"><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;{</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a1813dfea28479ff50528e8ed008e62e8">BasicTimeSeries::set_dt</a>(sample_interval);</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  <span class="comment">/* This is the unique name defined in the mspass schema - we always set it. */</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  this-&gt;put(<a class="code" href="namespacemspass_1_1seismic.html#a3f7a9857fd532d0e6800f2a316b50772">SEISMICMD_dt</a>,sample_interval);</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  <span class="comment">/* these are hard coded aliases for sample_interval */</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  std::set&lt;string&gt; aliases;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  std::set&lt;string&gt;::iterator aptr;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <span class="comment">/* Note these aren&#39;t set in keywords - aliases are flexible and this</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment">  can allow another way to make these attribute names more flexible. */</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  aliases.insert(<span class="stringliteral">&quot;dt&quot;</span>);</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  <span class="keywordflow">for</span>(aptr=aliases.begin();aptr!=aliases.end();++aptr)</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  {</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classmspass_1_1utility_1_1_metadata.html#a1e96e8682297fe8b21acf09b4d399cc6">is_defined</a>(*aptr))</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    {</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      this-&gt;put(*aptr,sample_interval);</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    }</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  }</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1utility_1_1_metadata.html#a1e96e8682297fe8b21acf09b4d399cc6">mspass::utility::Metadata::is_defined()</a>, <a class="el" href="namespacemspass_1_1seismic.html#a3f7a9857fd532d0e6800f2a316b50772">mspass::seismic::SEISMICMD_dt()</a>, and <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a1813dfea28479ff50528e8ed008e62e8">mspass::seismic::BasicTimeSeries::set_dt()</a>.</p>

</div>
</div>
<a id="ae94bac250fe5928ced41babc322c2c79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae94bac250fe5928ced41babc322c2c79">&#9670;&nbsp;</a></span>set_npts()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void mspass::seismic::CoreSeismogram::set_npts </td>
          <td>(</td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>npts</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the number of samples attribute for data. </p>
<p>This method is complicated by the need to sync the changed value with Metadata. That is further complicated by the need to support aliases for the keys used to defined npts in Metadata. That is handled by first setting the internal npts value (actually ns) and then going through a fixed list of valid alias keys for npts. Any that exist are changed. If none were previously defined the unique name (see documentation) is added to Metadata.</p>
<p>This attribute has an additional complication compared to other setter that are overrides from <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html" title="Base class for time series objects.">BasicTimeSeries</a>. That is, the number of points define the data buffer size to hold the sample data. To guarantee the buffer size and the internal remain consistent this method clears any existing content of the dmatrix u and initializes the 3xnpts matrix to 0s. Note this means if one is using this to assemble a data object in pieces you MUST call this method before loading any data or it will be cleared and you will mysteriously find the data are all zeros.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">npts</td><td>is the new number of points to set. </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a4101771f4d687d43f4ae79bfebef3f7c">mspass::seismic::BasicTimeSeries</a>.</p>
<div class="fragment"><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;{</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a4101771f4d687d43f4ae79bfebef3f7c">BasicTimeSeries::set_npts</a>(<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a347b349bb4e1f0e65978dfcd45ae3472">npts</a>);</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  <span class="comment">/* This is the unique name - we always set it.  The weird</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="comment">  cast is necessary to avoid type mismatch with unsigned.</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="comment">  We use the name defined in keywords.h which we can always assume</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="comment">  matches the schema for the unique name*/</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  this-&gt;put(<a class="code" href="namespacemspass_1_1seismic.html#ac848a79911ca1930abf265f01a6d635f">SEISMICMD_npts</a>,(<span class="keywordtype">long</span> <span class="keywordtype">int</span>)<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a347b349bb4e1f0e65978dfcd45ae3472">npts</a>);</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  <span class="comment">/* these are hard coded aliases for sample_interval */</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;  std::set&lt;string&gt; aliases;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  std::set&lt;string&gt;::iterator aptr;</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;  aliases.insert(<span class="stringliteral">&quot;nsamp&quot;</span>);</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  aliases.insert(<span class="stringliteral">&quot;wfdisc.nsamp&quot;</span>);</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  <span class="keywordflow">for</span>(aptr=aliases.begin();aptr!=aliases.end();++aptr)</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  {</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classmspass_1_1utility_1_1_metadata.html#a1e96e8682297fe8b21acf09b4d399cc6">is_defined</a>(*aptr))</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    {</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      this-&gt;put(*aptr,(<span class="keywordtype">long</span> <span class="keywordtype">int</span>)<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a347b349bb4e1f0e65978dfcd45ae3472">npts</a>);</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    }</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;  }</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  <span class="comment">/* this method has the further complication that npts sets the size of the</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="comment">  data matrix.   Here we resize the matrix and initialize it to 0s.*/</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a347b349bb4e1f0e65978dfcd45ae3472">npts</a>==0)</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  {</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a> = <a class="code" href="classmspass_1_1utility_1_1dmatrix.html">dmatrix</a>();</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  }</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  {</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>=<a class="code" href="classmspass_1_1utility_1_1dmatrix.html">dmatrix</a>(3,<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a347b349bb4e1f0e65978dfcd45ae3472">npts</a>);</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.<a class="code" href="classmspass_1_1utility_1_1dmatrix.html#ab9e34acc9b193854c5148e8c3d9650c2">zero</a>();</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  }</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1utility_1_1_metadata.html#a1e96e8682297fe8b21acf09b4d399cc6">mspass::utility::Metadata::is_defined()</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a347b349bb4e1f0e65978dfcd45ae3472">mspass::seismic::BasicTimeSeries::npts()</a>, <a class="el" href="namespacemspass_1_1seismic.html#ac848a79911ca1930abf265f01a6d635f">mspass::seismic::SEISMICMD_npts()</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a4101771f4d687d43f4ae79bfebef3f7c">mspass::seismic::BasicTimeSeries::set_npts()</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>, and <a class="el" href="classmspass_1_1utility_1_1dmatrix.html#ab9e34acc9b193854c5148e8c3d9650c2">mspass::utility::dmatrix::zero()</a>.</p>

</div>
</div>
<a id="a7724b7cfa40eebf0b15e0d2b39ae615e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7724b7cfa40eebf0b15e0d2b39ae615e">&#9670;&nbsp;</a></span>set_t0()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void mspass::seismic::CoreSeismogram::set_t0 </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t0in</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the data start time. </p>
<p>This method is complicated by the need to sync the changed value with Metadata. That is further complicated by the need to support aliases for the keys used to defined npts in Metadata. That is handled by first setting the internal t0 value and then going through a fixed list of valid alias keys for it. Any that exist are changed. If none were previously defined the unique name (see documentation) is added to Metadata.</p>
<p>This is a dangerous method to use on real data as it can mess up the time if not handled correctly. It should be used only when that sharp knife is needed such as in assembling data outside of constructors in a test program.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t0in</td><td>is the new data sample interval to be used. </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#abe29da17a295b2b439951d3ab6378caf">mspass::seismic::BasicTimeSeries</a>.</p>
<div class="fragment"><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;{</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#abe29da17a295b2b439951d3ab6378caf">BasicTimeSeries::set_t0</a>(t0in);</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;  <span class="comment">/* This is the unique name - we always set it.  Pulled from keywords.h</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment">  which should match the schema.  aliases are hard coded not defined as</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="comment">  keywords */</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  this-&gt;put(<a class="code" href="namespacemspass_1_1seismic.html#a1e5b45ce0ed02e9c1d154ea0434138c0">SEISMICMD_t0</a>,t0in);</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  <span class="comment">/* these are hard coded aliases for sample_interval */</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  std::set&lt;string&gt; aliases;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  std::set&lt;string&gt;::iterator aptr;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  aliases.insert(<span class="stringliteral">&quot;t0&quot;</span>);</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  aliases.insert(<span class="stringliteral">&quot;time&quot;</span>);</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;  <span class="keywordflow">for</span>(aptr=aliases.begin();aptr!=aliases.end();++aptr)</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  {</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classmspass_1_1utility_1_1_metadata.html#a1e96e8682297fe8b21acf09b4d399cc6">is_defined</a>(*aptr))</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    {</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;      this-&gt;put(*aptr,t0in);</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    }</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  }</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1utility_1_1_metadata.html#a1e96e8682297fe8b21acf09b4d399cc6">mspass::utility::Metadata::is_defined()</a>, <a class="el" href="namespacemspass_1_1seismic.html#a1e5b45ce0ed02e9c1d154ea0434138c0">mspass::seismic::SEISMICMD_t0()</a>, and <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#abe29da17a295b2b439951d3ab6378caf">mspass::seismic::BasicTimeSeries::set_t0()</a>.</p>

</div>
</div>
<a id="ad60b2dca7acfd76ff1f8d677ef609f8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad60b2dca7acfd76ff1f8d677ef609f8a">&#9670;&nbsp;</a></span>set_transformation_matrix() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool mspass::seismic::CoreSeismogram::set_transformation_matrix </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>a</em>[3][3]</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Define the transformaton matrix with a C style 3x3 matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>is a C style 3x3 matrix.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the given transformation matrix is an identity meaning components_are_cardinal gets set true. false if the test for an identity matrix fails. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">Will</td><td>throw a MsPASSError if the input matrix is not 3x3. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;{</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;3;++i)</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;3;++j) <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[i][j]=a[i][j];</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    py::list tmatrix_l;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;3;++i)</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;3;++j) tmatrix_l.append(a[i][j]);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    this-&gt;put_object(<a class="code" href="namespacemspass_1_1seismic.html#ab9de221412c0076cce8197b4f2e9df7a">SEISMICMD_tmatrix</a>, tmatrix_l);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a1dd1a9469bca89f7e07c6aa928dc4a09">cardinal</a>;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a1dd1a9469bca89f7e07c6aa928dc4a09">cardinal</a>=this-&gt;tmatrix_is_cardinal();</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a1dd1a9469bca89f7e07c6aa928dc4a09">cardinal</a>)</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    {</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7e983515950366013bde880ddb740b36">components_are_orthogonal</a>=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    }</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    {</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        <span class="comment">/* Not necessarily true, but small overhead cost*/</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7e983515950366013bde880ddb740b36">components_are_orthogonal</a>=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    }</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a1dd1a9469bca89f7e07c6aa928dc4a09">cardinal()</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7e983515950366013bde880ddb740b36">components_are_orthogonal</a>, <a class="el" href="namespacemspass_1_1seismic.html#ab9de221412c0076cce8197b4f2e9df7a">mspass::seismic::SEISMICMD_tmatrix()</a>, and <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>.</p>

</div>
</div>
<a id="a94e13495475bfb8c1e62f40006f13bdc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94e13495475bfb8c1e62f40006f13bdc">&#9670;&nbsp;</a></span>set_transformation_matrix() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool mspass::seismic::CoreSeismogram::set_transformation_matrix </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmspass_1_1utility_1_1dmatrix.html">mspass::utility::dmatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>A</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Define the transformaton matrix. </p>
<p>Occasionally we need to set the transformation matrix manually. The type example is input with a format where the component directions are embedded. We use a dmatrix as it is more easily wrapped for python than the raw C 2D array which really doesn't translate well between the languages.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>is the 3X3 matrix copied to the internal transformation matrix array.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the given transformation matrix is an identity meaning components_are_cardinal gets set true. false if the test for an identity matrix fails. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">Will</td><td>throw a MsPASSError if the input matrix is not 3x3. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;{</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;3;++i)</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;3;++j) <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[i][j]=A(i,j);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    py::list tmatrix_l;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;3;++i)</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;3;++j) tmatrix_l.append(A(i, j));</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    this-&gt;put_object(<a class="code" href="namespacemspass_1_1seismic.html#ab9de221412c0076cce8197b4f2e9df7a">SEISMICMD_tmatrix</a>, tmatrix_l);</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a1dd1a9469bca89f7e07c6aa928dc4a09">cardinal</a>;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a1dd1a9469bca89f7e07c6aa928dc4a09">cardinal</a>=this-&gt;tmatrix_is_cardinal();</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a1dd1a9469bca89f7e07c6aa928dc4a09">cardinal</a>)</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    {</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7e983515950366013bde880ddb740b36">components_are_orthogonal</a>=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    }</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        <span class="comment">/* Not necessarily true, but small overhead cost*/</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7e983515950366013bde880ddb740b36">components_are_orthogonal</a>=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    }</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a1dd1a9469bca89f7e07c6aa928dc4a09">cardinal()</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7e983515950366013bde880ddb740b36">components_are_orthogonal</a>, <a class="el" href="namespacemspass_1_1seismic.html#ab9de221412c0076cce8197b4f2e9df7a">mspass::seismic::SEISMICMD_tmatrix()</a>, and <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>.</p>

</div>
</div>
<a id="a686a13c4938df315e175cd249a52b74e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a686a13c4938df315e175cd249a52b74e">&#9670;&nbsp;</a></span>set_transformation_matrix() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool mspass::seismic::CoreSeismogram::set_transformation_matrix </td>
          <td>(</td>
          <td class="paramtype">pybind11::object&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Define the transformaton matrix with a python object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>is a python object of 9 elements with types of dmatrix, numpy array, or list.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the given transformation matrix is an identity meaning components_are_cardinal gets set true. false if the test for an identity matrix fails. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">Will</td><td>throw a MsPASSError if the input type or dimension is not recognized. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a629ae308ad656912abd32d086730f35d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a629ae308ad656912abd32d086730f35d">&#9670;&nbsp;</a></span>sync_npts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mspass::seismic::CoreSeismogram::sync_npts </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sync the number of samples attribute with actual data size. </p>
<p>This method syncs the npts attribute with the actual size of the dmatrix u. It also syncs aliases in the same way as the set_npts method. </p>
<div class="fragment"><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;{</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a> != this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.<a class="code" href="classmspass_1_1utility_1_1dmatrix.html#ac32006f0dff7ca1b59fa8f3889deb9e5">columns</a>()) {</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a4101771f4d687d43f4ae79bfebef3f7c">BasicTimeSeries::set_npts</a>(this-&gt;<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.<a class="code" href="classmspass_1_1utility_1_1dmatrix.html#ac32006f0dff7ca1b59fa8f3889deb9e5">columns</a>());</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <span class="comment">/* This is the unique name - we always set it.  The weird</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment">    cast is necessary to avoid type mismatch with unsigned.</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="comment">    As above converted to keywords.h const string to make</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="comment">    this easier to maintain*/</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    this-&gt;put(<a class="code" href="namespacemspass_1_1seismic.html#ac848a79911ca1930abf265f01a6d635f">SEISMICMD_npts</a>,(<span class="keywordtype">long</span> <span class="keywordtype">int</span>)<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>);</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <span class="comment">/* these are hard coded aliases for sample_interval */</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    std::set&lt;string&gt; aliases;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    std::set&lt;string&gt;::iterator aptr;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    aliases.insert(<span class="stringliteral">&quot;nsamp&quot;</span>);</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    aliases.insert(<span class="stringliteral">&quot;wfdisc.nsamp&quot;</span>);</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <span class="keywordflow">for</span>(aptr=aliases.begin();aptr!=aliases.end();++aptr)</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    {</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;        <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classmspass_1_1utility_1_1_metadata.html#a1e96e8682297fe8b21acf09b4d399cc6">is_defined</a>(*aptr))</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;        {</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;          this-&gt;put(*aptr,(<span class="keywordtype">long</span> <span class="keywordtype">int</span>)<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>);</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        }</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    }</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  }</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1utility_1_1dmatrix.html#ac32006f0dff7ca1b59fa8f3889deb9e5">mspass::utility::dmatrix::columns()</a>, <a class="el" href="classmspass_1_1utility_1_1_metadata.html#a1e96e8682297fe8b21acf09b4d399cc6">mspass::utility::Metadata::is_defined()</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">mspass::seismic::BasicTimeSeries::nsamp</a>, <a class="el" href="namespacemspass_1_1seismic.html#ac848a79911ca1930abf265f01a6d635f">mspass::seismic::SEISMICMD_npts()</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a4101771f4d687d43f4ae79bfebef3f7c">mspass::seismic::BasicTimeSeries::set_npts()</a>, and <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.</p>

</div>
</div>
<a id="ae9ea31f9e36577a51660c61e0749d4a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9ea31f9e36577a51660c61e0749d4a6">&#9670;&nbsp;</a></span>transform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mspass::seismic::CoreSeismogram::transform </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>a</em>[3][3]</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Applies an arbitrary transformation matrix to the data. i.e. after calling this method the data will have been multiplied by the matrix a and the transformation matrix will be updated. The later allows cascaded transformations to data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>is a C style 3x3 matrix. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;{</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keywordflow">if</span>( (<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.<a class="code" href="classmspass_1_1utility_1_1dmatrix.html#aa78dbbdf719f69c8422734612e9a56af">size</a>()[1]&lt;=0) || <a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#aa96e795f96b5050996d791f5b6f3867d">dead</a>()) <span class="keywordflow">return</span>; <span class="comment">// do nothing in these situations</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="comment">/* Older version had this - we need to trust ns is already u.columns().  */</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="comment">//size_t ns = u.size()[1];</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keywordtype">size_t</span> i,j,k;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordtype">double</span> *work[3];</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="keywordflow">for</span>(i=0; i&lt;3; ++i) work[i] = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>];</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordflow">for</span>(i=0; i&lt;3; ++i)</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    {</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        dcopy(<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>,<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.get_address(0,0),3,work[i],1);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        dscal(<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>,a[i][0],work[i],1);</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        daxpy(<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>,a[i][1],<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.get_address(1,0),3,work[i],1);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        daxpy(<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>,a[i][2],<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.get_address(2,0),3,work[i],1);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    }</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keywordflow">for</span>(i=0; i&lt;3; ++i) dcopy(<a class="code" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">nsamp</a>,work[i],1,<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.get_address(i,0),3);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="keywordflow">for</span>(i=0; i&lt;3; ++i) <span class="keyword">delete</span> [] work[i];</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="comment">/* Hand code this rather than use dmatrix or other library.</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">       Probably dumb, but this is just a 3x3 system.  This</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment">       is simply a multiply of a*tmatrix with result replacing</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">       the internal tmatrix */</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="keywordtype">double</span> tmnew[3][3];</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="keywordtype">double</span> prod;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="keywordflow">for</span>(i=0; i&lt;3; ++i)</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        <span class="keywordflow">for</span>(j=0; j&lt;3; ++j)</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        {</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;            <span class="keywordflow">for</span>(prod=0.0,k=0; k&lt;3; ++k)</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                prod+=a[i][k]*<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[k][j];</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            tmnew[i][j]=prod;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        }</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="keywordflow">for</span>(i=0; i&lt;3; ++i)</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        <span class="keywordflow">for</span>(j=0; j&lt;3; ++j)<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>[i][j]=tmnew[i][j];</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a> = this-&gt;tmatrix_is_cardinal();</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="comment">/* Assume this method does not yield cartesian coordinate directions.*/</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>) <a class="code" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7e983515950366013bde880ddb740b36">components_are_orthogonal</a>=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">components_are_cardinal</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a7e983515950366013bde880ddb740b36">components_are_orthogonal</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#aa96e795f96b5050996d791f5b6f3867d">mspass::seismic::BasicTimeSeries::dead()</a>, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">mspass::seismic::BasicTimeSeries::nsamp</a>, <a class="el" href="classmspass_1_1utility_1_1dmatrix.html#aa78dbbdf719f69c8422734612e9a56af">mspass::utility::dmatrix::size()</a>, <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">tmatrix</a>, and <a class="el" href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">u</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="af87b223c30872f55e8c5a5246da143ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af87b223c30872f55e8c5a5246da143ba">&#9670;&nbsp;</a></span>components_are_cardinal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool mspass::seismic::CoreSeismogram::components_are_cardinal</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Defines of the contents of the object are in Earth cardinal coordinates.</p>
<p>Cardinal means the cardinal directions at a point on the earth. That is, x1 is positive east, x2 is positive north, and x3 is positive up. Like the components_are_orthogonal variable the purpose of this variable is to simplify common tests for properties of a given data series. </p>

</div>
</div>
<a id="a7e983515950366013bde880ddb740b36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e983515950366013bde880ddb740b36">&#9670;&nbsp;</a></span>components_are_orthogonal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool mspass::seismic::CoreSeismogram::components_are_orthogonal</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Defines if the contents of this object are components of an orthogonal basis.</p>
<p>Most raw 3c seismic data use orthogonal components, but this is not universal. Furthermore, some transformations (e.g. the free surface transformation operator) define transformations to basis sets that are not orthogonal. Because detecting orthogonality from a transformation is a nontrivial thing (rounding error is the complication) this is made a part of the object to simplify a number of algorithms. </p>

</div>
</div>
<a id="a30316a5d8ed7794f0d51da0c96d97882"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30316a5d8ed7794f0d51da0c96d97882">&#9670;&nbsp;</a></span>tmatrix</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double mspass::seismic::CoreSeismogram::tmatrix[3][3]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Transformation matrix.</p>
<p>This is a 3x3 transformation that defines how the data in this object is produced from cardinal coordinates. That is, if u is the contents of this object the data in cardinal directions can be produced by tmatrix^-1 * u. </p>

</div>
</div>
<a id="a9ac5c7c060d582b1a399fb066d06779f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ac5c7c060d582b1a399fb066d06779f">&#9670;&nbsp;</a></span>u</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmspass_1_1utility_1_1dmatrix.html">mspass::utility::dmatrix</a> mspass::seismic::CoreSeismogram::u</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Holds the actual data.</p>
<p>Matrix is 3xns. Thus the rows are the component number and columns define time position. Note there is a redundancy in these definitions that must be watched if you manipulate the contents of this matrix. That is, <a class="el" href="classmspass_1_1seismic_1_1_basic_time_series.html" title="Base class for time series objects.">BasicTimeSeries</a> defines ns, but the u matrix has it's own internal size definitions. Currently no tests are done to validate this consistency. All constructors handle this, but again because u is public be very careful in altering u. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/runner/work/mspass/mspass/cxx/include/mspass/seismic/<a class="el" href="_core_seismogram_8h_source.html">CoreSeismogram.h</a></li>
<li>/home/runner/work/mspass/mspass/cxx/src/lib/seismic/CoreSeismogram.cc</li>
</ul>
</div><!-- contents -->
<div class="ttc" id="aclassmspass_1_1seismic_1_1_basic_time_series_html_a02072f2001d400e7f7ab5f9463e236c8"><div class="ttname"><a href="classmspass_1_1seismic_1_1_basic_time_series.html#a02072f2001d400e7f7ab5f9463e236c8">mspass::seismic::BasicTimeSeries::BasicTimeSeries</a></div><div class="ttdeci">BasicTimeSeries()</div><div class="ttdef"><b>Definition:</b> BasicTimeSeries.cc:42</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_basic_time_series_html_a7b2e9b878959d376790f09194edc51d9"><div class="ttname"><a href="classmspass_1_1seismic_1_1_basic_time_series.html#a7b2e9b878959d376790f09194edc51d9">mspass::seismic::BasicTimeSeries::mlive</a></div><div class="ttdeci">bool mlive</div><div class="ttdef"><b>Definition:</b> BasicTimeSeries.h:256</div></div>
<div class="ttc" id="aclassmspass_1_1utility_1_1_metadata_html_a1e96e8682297fe8b21acf09b4d399cc6"><div class="ttname"><a href="classmspass_1_1utility_1_1_metadata.html#a1e96e8682297fe8b21acf09b4d399cc6">mspass::utility::Metadata::is_defined</a></div><div class="ttdeci">bool is_defined(const std::string key) const noexcept</div><div class="ttdef"><b>Definition:</b> Metadata.cc:73</div></div>
<div class="ttc" id="anamespacemspass_1_1seismic_html_a0951fef82377e868ee7cfcd4841979cf"><div class="ttname"><a href="namespacemspass_1_1seismic.html#a0951fef82377e868ee7cfcd4841979cf">mspass::seismic::SEISMICMD_t0_shift</a></div><div class="ttdeci">const std::string SEISMICMD_t0_shift(&quot;starttime_shift&quot;)</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_basic_time_series_html_ac3f8c8200710fe0d3ef211c7c758e864"><div class="ttname"><a href="classmspass_1_1seismic_1_1_basic_time_series.html#ac3f8c8200710fe0d3ef211c7c758e864">mspass::seismic::BasicTimeSeries::set_tref</a></div><div class="ttdeci">void set_tref(const TimeReferenceType newtref)</div><div class="ttdoc">Force the time standard.</div><div class="ttdef"><b>Definition:</b> BasicTimeSeries.h:243</div></div>
<div class="ttc" id="anamespacemspass_1_1seismic_html_ab9de221412c0076cce8197b4f2e9df7a"><div class="ttname"><a href="namespacemspass_1_1seismic.html#ab9de221412c0076cce8197b4f2e9df7a">mspass::seismic::SEISMICMD_tmatrix</a></div><div class="ttdeci">const std::string SEISMICMD_tmatrix(&quot;tmatrix&quot;)</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_core_seismogram_html_a5e51c2c6d3a1aa02281ba242a1d15bf2"><div class="ttname"><a href="classmspass_1_1seismic_1_1_core_seismogram.html#a5e51c2c6d3a1aa02281ba242a1d15bf2">mspass::seismic::CoreSeismogram::set_dt</a></div><div class="ttdeci">void set_dt(const double sample_interval)</div><div class="ttdoc">Set the sample interval.</div><div class="ttdef"><b>Definition:</b> CoreSeismogram.cc:1024</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_core_seismogram_html_ae043fa67b9d889965ae473da583a1eb4"><div class="ttname"><a href="classmspass_1_1seismic_1_1_core_seismogram.html#ae043fa67b9d889965ae473da583a1eb4">mspass::seismic::CoreSeismogram::endtime</a></div><div class="ttdeci">double endtime() const noexcept</div><div class="ttdef"><b>Definition:</b> CoreSeismogram.h:486</div></div>
<div class="ttc" id="aclassmspass_1_1utility_1_1_metadata_html_a7ace0c05ebb00b3c383cb8cccd225504"><div class="ttname"><a href="classmspass_1_1utility_1_1_metadata.html#a7ace0c05ebb00b3c383cb8cccd225504">mspass::utility::Metadata::get_long</a></div><div class="ttdeci">long get_long(const std::string key) const</div><div class="ttdef"><b>Definition:</b> Metadata.h:184</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_core_seismogram_html_a30316a5d8ed7794f0d51da0c96d97882"><div class="ttname"><a href="classmspass_1_1seismic_1_1_core_seismogram.html#a30316a5d8ed7794f0d51da0c96d97882">mspass::seismic::CoreSeismogram::tmatrix</a></div><div class="ttdeci">double tmatrix[3][3]</div><div class="ttdef"><b>Definition:</b> CoreSeismogram.h:519</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_basic_time_series_html_aea80df11992ca2c7ff915aab5fcba6f5"><div class="ttname"><a href="classmspass_1_1seismic_1_1_basic_time_series.html#aea80df11992ca2c7ff915aab5fcba6f5">mspass::seismic::BasicTimeSeries::mdt</a></div><div class="ttdeci">double mdt</div><div class="ttdef"><b>Definition:</b> BasicTimeSeries.h:260</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_basic_time_series_html_a347b349bb4e1f0e65978dfcd45ae3472"><div class="ttname"><a href="classmspass_1_1seismic_1_1_basic_time_series.html#a347b349bb4e1f0e65978dfcd45ae3472">mspass::seismic::BasicTimeSeries::npts</a></div><div class="ttdeci">size_t npts() const</div><div class="ttdef"><b>Definition:</b> BasicTimeSeries.h:183</div></div>
<div class="ttc" id="aclassmspass_1_1utility_1_1dmatrix_html_aa78dbbdf719f69c8422734612e9a56af"><div class="ttname"><a href="classmspass_1_1utility_1_1dmatrix.html#aa78dbbdf719f69c8422734612e9a56af">mspass::utility::dmatrix::size</a></div><div class="ttdeci">std::vector&lt; size_t &gt; size() const</div><div class="ttdoc">Return a vector with 2 elements giving the size.</div><div class="ttdef"><b>Definition:</b> dmatrix.cc:219</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_basic_time_series_html_abe28ca2812a2ac21dd2196385ad106ab"><div class="ttname"><a href="classmspass_1_1seismic_1_1_basic_time_series.html#abe28ca2812a2ac21dd2196385ad106ab">mspass::seismic::BasicTimeSeries::sample_number</a></div><div class="ttdeci">int sample_number(double t) const</div><div class="ttdef"><b>Definition:</b> BasicTimeSeries.h:74</div></div>
<div class="ttc" id="astructmspass_1_1utility_1_1_spherical_coordinate_html_a8f9f987e89e175fecb85c9cbe5bdbc13"><div class="ttname"><a href="structmspass_1_1utility_1_1_spherical_coordinate.html#a8f9f987e89e175fecb85c9cbe5bdbc13">mspass::utility::SphericalCoordinate::radius</a></div><div class="ttdeci">double radius</div><div class="ttdef"><b>Definition:</b> SphericalCoordinate.h:18</div></div>
<div class="ttc" id="aclassmspass_1_1utility_1_1_metadata_html_a4a87cd6a6f8fc5cdbee65cb85958cb2c"><div class="ttname"><a href="classmspass_1_1utility_1_1_metadata.html#a4a87cd6a6f8fc5cdbee65cb85958cb2c">mspass::utility::Metadata::Metadata</a></div><div class="ttdeci">Metadata()</div><div class="ttdef"><b>Definition:</b> Metadata.h:80</div></div>
<div class="ttc" id="aclassmspass_1_1utility_1_1dmatrix_html_ac32006f0dff7ca1b59fa8f3889deb9e5"><div class="ttname"><a href="classmspass_1_1utility_1_1dmatrix.html#ac32006f0dff7ca1b59fa8f3889deb9e5">mspass::utility::dmatrix::columns</a></div><div class="ttdeci">size_t columns() const</div><div class="ttdef"><b>Definition:</b> dmatrix.cc:232</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_basic_time_series_html_aeb40f4223a8ee73e79f9af065372a757"><div class="ttname"><a href="classmspass_1_1seismic_1_1_basic_time_series.html#aeb40f4223a8ee73e79f9af065372a757">mspass::seismic::BasicTimeSeries::mt0</a></div><div class="ttdeci">double mt0</div><div class="ttdef"><b>Definition:</b> BasicTimeSeries.h:264</div></div>
<div class="ttc" id="aclassmspass_1_1utility_1_1_metadata_html"><div class="ttname"><a href="classmspass_1_1utility_1_1_metadata.html">mspass::utility::Metadata</a></div><div class="ttdef"><b>Definition:</b> Metadata.h:75</div></div>
<div class="ttc" id="aclassmspass_1_1utility_1_1_metadata_html_ad69a5786d997104df560775f4f688b02"><div class="ttname"><a href="classmspass_1_1utility_1_1_metadata.html#ad69a5786d997104df560775f4f688b02">mspass::utility::Metadata::get_double</a></div><div class="ttdeci">double get_double(const std::string key) const override</div><div class="ttdef"><b>Definition:</b> Metadata.h:135</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_core_seismogram_html_a756ee542caaa6001f9f40fed3607ff7e"><div class="ttname"><a href="classmspass_1_1seismic_1_1_core_seismogram.html#a756ee542caaa6001f9f40fed3607ff7e">mspass::seismic::CoreSeismogram::rotate_to_standard</a></div><div class="ttdeci">void rotate_to_standard()</div><div class="ttdef"><b>Definition:</b> CoreSeismogram.cc:400</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_core_seismogram_html_a94e13495475bfb8c1e62f40006f13bdc"><div class="ttname"><a href="classmspass_1_1seismic_1_1_core_seismogram.html#a94e13495475bfb8c1e62f40006f13bdc">mspass::seismic::CoreSeismogram::set_transformation_matrix</a></div><div class="ttdeci">bool set_transformation_matrix(const mspass::utility::dmatrix &amp;A)</div><div class="ttdoc">Define the transformaton matrix.</div><div class="ttdef"><b>Definition:</b> CoreSeismogram.cc:783</div></div>
<div class="ttc" id="aclassmspass_1_1utility_1_1_metadata_html_a991516933477580b6b59dd578819df06"><div class="ttname"><a href="classmspass_1_1utility_1_1_metadata.html#a991516933477580b6b59dd578819df06">mspass::utility::Metadata::get_any</a></div><div class="ttdeci">boost::any get_any(const std::string key) const</div><div class="ttdef"><b>Definition:</b> Metadata.h:283</div></div>
<div class="ttc" id="anamespacemspass_1_1seismic_html_ac848a79911ca1930abf265f01a6d635f"><div class="ttname"><a href="namespacemspass_1_1seismic.html#ac848a79911ca1930abf265f01a6d635f">mspass::seismic::SEISMICMD_npts</a></div><div class="ttdeci">const std::string SEISMICMD_npts(&quot;npts&quot;)</div></div>
<div class="ttc" id="astructmspass_1_1utility_1_1_spherical_coordinate_html_a2c970fd569ae883e5545f81e58458ef9"><div class="ttname"><a href="structmspass_1_1utility_1_1_spherical_coordinate.html#a2c970fd569ae883e5545f81e58458ef9">mspass::utility::SphericalCoordinate::phi</a></div><div class="ttdeci">double phi</div><div class="ttdef"><b>Definition:</b> SphericalCoordinate.h:26</div></div>
<div class="ttc" id="anamespacemspass_1_1seismic_html_a88a01d6c4e1838b7bac28931b9cc8c58"><div class="ttname"><a href="namespacemspass_1_1seismic.html#a88a01d6c4e1838b7bac28931b9cc8c58">mspass::seismic::SEISMICMD_time_standard</a></div><div class="ttdeci">const std::string SEISMICMD_time_standard(&quot;time_standard&quot;)</div></div>
<div class="ttc" id="anamespacemspass_1_1seismic_html_a1254f7fb8e1be5b198218604ac9b3c8a"><div class="ttname"><a href="namespacemspass_1_1seismic.html#a1254f7fb8e1be5b198218604ac9b3c8a">mspass::seismic::SEISMICMD_dfile</a></div><div class="ttdeci">const std::string SEISMICMD_dfile(&quot;dfile&quot;)</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_core_seismogram_html_a7e983515950366013bde880ddb740b36"><div class="ttname"><a href="classmspass_1_1seismic_1_1_core_seismogram.html#a7e983515950366013bde880ddb740b36">mspass::seismic::CoreSeismogram::components_are_orthogonal</a></div><div class="ttdeci">bool components_are_orthogonal</div><div class="ttdef"><b>Definition:</b> CoreSeismogram.h:489</div></div>
<div class="ttc" id="anamespacemspass_1_1seismic_html_a0b8373068c66c7453bd012fe5367dbd2a2ca9469819fb0fb61ff98e914a7ccca0"><div class="ttname"><a href="namespacemspass_1_1seismic.html#a0b8373068c66c7453bd012fe5367dbd2a2ca9469819fb0fb61ff98e914a7ccca0">mspass::seismic::TimeReferenceType::Relative</a></div><div class="ttdeci">@ Relative</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_core_seismogram_html_a1dd1a9469bca89f7e07c6aa928dc4a09"><div class="ttname"><a href="classmspass_1_1seismic_1_1_core_seismogram.html#a1dd1a9469bca89f7e07c6aa928dc4a09">mspass::seismic::CoreSeismogram::cardinal</a></div><div class="ttdeci">bool cardinal() const</div><div class="ttdef"><b>Definition:</b> CoreSeismogram.h:479</div></div>
<div class="ttc" id="anamespacemspass_1_1seismic_html_a0b8373068c66c7453bd012fe5367dbd2a9234324ddf6b4176b57d803a925b7961"><div class="ttname"><a href="namespacemspass_1_1seismic.html#a0b8373068c66c7453bd012fe5367dbd2a9234324ddf6b4176b57d803a925b7961">mspass::seismic::TimeReferenceType::UTC</a></div><div class="ttdeci">@ UTC</div></div>
<div class="ttc" id="anamespacemspass_1_1seismic_html_a3f7a9857fd532d0e6800f2a316b50772"><div class="ttname"><a href="namespacemspass_1_1seismic.html#a3f7a9857fd532d0e6800f2a316b50772">mspass::seismic::SEISMICMD_dt</a></div><div class="ttdeci">const std::string SEISMICMD_dt(&quot;delta&quot;)</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_core_seismogram_html_a7724b7cfa40eebf0b15e0d2b39ae615e"><div class="ttname"><a href="classmspass_1_1seismic_1_1_core_seismogram.html#a7724b7cfa40eebf0b15e0d2b39ae615e">mspass::seismic::CoreSeismogram::set_t0</a></div><div class="ttdeci">void set_t0(const double t0in)</div><div class="ttdoc">Set the data start time.</div><div class="ttdef"><b>Definition:</b> CoreSeismogram.cc:1043</div></div>
<div class="ttc" id="aclassmspass_1_1utility_1_1_ms_p_a_s_s_error_html"><div class="ttname"><a href="classmspass_1_1utility_1_1_ms_p_a_s_s_error.html">mspass::utility::MsPASSError</a></div><div class="ttdoc">Base class for error object thrown by MsPASS library routines.</div><div class="ttdef"><b>Definition:</b> MsPASSError.h:39</div></div>
<div class="ttc" id="aclassmspass_1_1utility_1_1dmatrix_html_ab9e34acc9b193854c5148e8c3d9650c2"><div class="ttname"><a href="classmspass_1_1utility_1_1dmatrix.html#ab9e34acc9b193854c5148e8c3d9650c2">mspass::utility::dmatrix::zero</a></div><div class="ttdeci">void zero()</div><div class="ttdef"><b>Definition:</b> dmatrix.cc:215</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_basic_time_series_html_abe29da17a295b2b439951d3ab6378caf"><div class="ttname"><a href="classmspass_1_1seismic_1_1_basic_time_series.html#abe29da17a295b2b439951d3ab6378caf">mspass::seismic::BasicTimeSeries::set_t0</a></div><div class="ttdeci">virtual void set_t0(const double t0in)</div><div class="ttdoc">Set the data start time.</div><div class="ttdef"><b>Definition:</b> BasicTimeSeries.h:228</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_core_seismogram_html_ae9ea31f9e36577a51660c61e0749d4a6"><div class="ttname"><a href="classmspass_1_1seismic_1_1_core_seismogram.html#ae9ea31f9e36577a51660c61e0749d4a6">mspass::seismic::CoreSeismogram::transform</a></div><div class="ttdeci">void transform(const double a[3][3])</div><div class="ttdef"><b>Definition:</b> CoreSeismogram.cc:669</div></div>
<div class="ttc" id="aclassmspass_1_1utility_1_1_metadata_html_aa56da98a52f03babd67bf9fb55c40f3a"><div class="ttname"><a href="classmspass_1_1utility_1_1_metadata.html#aa56da98a52f03babd67bf9fb55c40f3a">mspass::utility::Metadata::get_string</a></div><div class="ttdeci">std::string get_string(const std::string key) const override</div><div class="ttdef"><b>Definition:</b> Metadata.h:213</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_basic_time_series_html_a0cb0afe9272567b8fd3394f79f46628a"><div class="ttname"><a href="classmspass_1_1seismic_1_1_basic_time_series.html#a0cb0afe9272567b8fd3394f79f46628a">mspass::seismic::BasicTimeSeries::nsamp</a></div><div class="ttdeci">size_t nsamp</div><div class="ttdef"><b>Definition:</b> BasicTimeSeries.h:268</div></div>
<div class="ttc" id="anamespacemspass_1_1seismic_html_a17279751e3795fee46d6a3cdfe427c33"><div class="ttname"><a href="namespacemspass_1_1seismic.html#a17279751e3795fee46d6a3cdfe427c33">mspass::seismic::SEISMICMD_foff</a></div><div class="ttdeci">const std::string SEISMICMD_foff(&quot;foff&quot;)</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_basic_time_series_html_a4101771f4d687d43f4ae79bfebef3f7c"><div class="ttname"><a href="classmspass_1_1seismic_1_1_basic_time_series.html#a4101771f4d687d43f4ae79bfebef3f7c">mspass::seismic::BasicTimeSeries::set_npts</a></div><div class="ttdeci">virtual void set_npts(const size_t npts)</div><div class="ttdoc">Set the number of samples attribute for data.</div><div class="ttdef"><b>Definition:</b> BasicTimeSeries.h:213</div></div>
<div class="ttc" id="astructmspass_1_1utility_1_1_spherical_coordinate_html_ae06e9f7deab80ef715e5a3629fbab2f7"><div class="ttname"><a href="structmspass_1_1utility_1_1_spherical_coordinate.html#ae06e9f7deab80ef715e5a3629fbab2f7">mspass::utility::SphericalCoordinate::theta</a></div><div class="ttdeci">double theta</div><div class="ttdef"><b>Definition:</b> SphericalCoordinate.h:22</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_core_seismogram_html_ab52a292c7c7bc8fc5fef68db9eb847e0"><div class="ttname"><a href="classmspass_1_1seismic_1_1_core_seismogram.html#ab52a292c7c7bc8fc5fef68db9eb847e0">mspass::seismic::CoreSeismogram::rotate</a></div><div class="ttdeci">void rotate(mspass::utility::SphericalCoordinate &amp;sc)</div><div class="ttdef"><b>Definition:</b> CoreSeismogram.cc:544</div></div>
<div class="ttc" id="aclassmspass_1_1utility_1_1dmatrix_html"><div class="ttname"><a href="classmspass_1_1utility_1_1dmatrix.html">mspass::utility::dmatrix</a></div><div class="ttdoc">Lightweight, simple matrix object.</div><div class="ttdef"><b>Definition:</b> dmatrix.h:101</div></div>
<div class="ttc" id="astructmspass_1_1utility_1_1_spherical_coordinate_html"><div class="ttname"><a href="structmspass_1_1utility_1_1_spherical_coordinate.html">mspass::utility::SphericalCoordinate</a></div><div class="ttdoc">Encapsulates spherical coordinates in a data structure.</div><div class="ttdef"><b>Definition:</b> SphericalCoordinate.h:14</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_core_seismogram_html_a9ac5c7c060d582b1a399fb066d06779f"><div class="ttname"><a href="classmspass_1_1seismic_1_1_core_seismogram.html#a9ac5c7c060d582b1a399fb066d06779f">mspass::seismic::CoreSeismogram::u</a></div><div class="ttdeci">mspass::utility::dmatrix u</div><div class="ttdef"><b>Definition:</b> CoreSeismogram.h:53</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_basic_time_series_html_a1813dfea28479ff50528e8ed008e62e8"><div class="ttname"><a href="classmspass_1_1seismic_1_1_basic_time_series.html#a1813dfea28479ff50528e8ed008e62e8">mspass::seismic::BasicTimeSeries::set_dt</a></div><div class="ttdeci">virtual void set_dt(const double sample_interval)</div><div class="ttdoc">Set the sample interval.</div><div class="ttdef"><b>Definition:</b> BasicTimeSeries.h:198</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_core_seismogram_html_a9be7b3811cfcd0b0396b32214d7eab51"><div class="ttname"><a href="classmspass_1_1seismic_1_1_core_seismogram.html#a9be7b3811cfcd0b0396b32214d7eab51">mspass::seismic::CoreSeismogram::CoreSeismogram</a></div><div class="ttdeci">CoreSeismogram()</div><div class="ttdef"><b>Definition:</b> CoreSeismogram.cc:28</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_core_seismogram_html_ae94bac250fe5928ced41babc322c2c79"><div class="ttname"><a href="classmspass_1_1seismic_1_1_core_seismogram.html#ae94bac250fe5928ced41babc322c2c79">mspass::seismic::CoreSeismogram::set_npts</a></div><div class="ttdeci">void set_npts(const size_t npts)</div><div class="ttdoc">Set the number of samples attribute for data.</div><div class="ttdef"><b>Definition:</b> CoreSeismogram.cc:1063</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_basic_time_series_html_aaf05bc1fe471e194bec093906c1a607c"><div class="ttname"><a href="classmspass_1_1seismic_1_1_basic_time_series.html#aaf05bc1fe471e194bec093906c1a607c">mspass::seismic::BasicTimeSeries::operator=</a></div><div class="ttdeci">BasicTimeSeries &amp; operator=(const BasicTimeSeries &amp;parent)</div><div class="ttdef"><b>Definition:</b> BasicTimeSeries.cc:62</div></div>
<div class="ttc" id="anamespacemspass_1_1seismic_html_ab8ff84666cf6d1c391987306eaad2546"><div class="ttname"><a href="namespacemspass_1_1seismic.html#ab8ff84666cf6d1c391987306eaad2546">mspass::seismic::SEISMICMD_dir</a></div><div class="ttdeci">const std::string SEISMICMD_dir(&quot;dir&quot;)</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_core_seismogram_html_af87b223c30872f55e8c5a5246da143ba"><div class="ttname"><a href="classmspass_1_1seismic_1_1_core_seismogram.html#af87b223c30872f55e8c5a5246da143ba">mspass::seismic::CoreSeismogram::components_are_cardinal</a></div><div class="ttdeci">bool components_are_cardinal</div><div class="ttdef"><b>Definition:</b> CoreSeismogram.h:511</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_basic_time_series_html_aa96e795f96b5050996d791f5b6f3867d"><div class="ttname"><a href="classmspass_1_1seismic_1_1_basic_time_series.html#aa96e795f96b5050996d791f5b6f3867d">mspass::seismic::BasicTimeSeries::dead</a></div><div class="ttdeci">bool dead() const</div><div class="ttdef"><b>Definition:</b> BasicTimeSeries.h:149</div></div>
<div class="ttc" id="anamespacemspass_1_1seismic_html_a1e5b45ce0ed02e9c1d154ea0434138c0"><div class="ttname"><a href="namespacemspass_1_1seismic.html#a1e5b45ce0ed02e9c1d154ea0434138c0">mspass::seismic::SEISMICMD_t0</a></div><div class="ttdeci">const std::string SEISMICMD_t0(&quot;starttime&quot;)</div></div>
<div class="ttc" id="aclassmspass_1_1seismic_1_1_basic_time_series_html_ab87672dc6adffed90b0dc9c144219d44"><div class="ttname"><a href="classmspass_1_1seismic_1_1_basic_time_series.html#ab87672dc6adffed90b0dc9c144219d44">mspass::seismic::BasicTimeSeries::force_t0_shift</a></div><div class="ttdeci">void force_t0_shift(const double t)</div><div class="ttdoc">Force a t0 shift value on data.</div><div class="ttdef"><b>Definition:</b> BasicTimeSeries.h:115</div></div>
<div class="ttc" id="aclassmspass_1_1utility_1_1_metadata_html_aadbae283dfdb87a82832519a9955fdfa"><div class="ttname"><a href="classmspass_1_1utility_1_1_metadata.html#aadbae283dfdb87a82832519a9955fdfa">mspass::utility::Metadata::operator=</a></div><div class="ttdeci">Metadata &amp; operator=(const Metadata &amp;mdold)</div><div class="ttdef"><b>Definition:</b> Metadata.cc:108</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
